detection:
- and:
  - or:
    - ScriptBlockText|contains: Add-Exfiltration
    - ScriptBlockText|contains: Add-Persistence
    - ScriptBlockText|contains: Add-RegBackdoor
    - ScriptBlockText|contains: Add-RemoteRegBackdoor
    - ScriptBlockText|contains: Add-ScrnSaveBackdoor
    - ScriptBlockText|contains: ConvertTo-Rc4ByteStream
    - ScriptBlockText|contains: Decrypt-Hash
    - ScriptBlockText|contains: Disable-ADIDNSNode
    - ScriptBlockText|contains: Do-Exfiltration
    - ScriptBlockText|contains: Enable-ADIDNSNode
    - ScriptBlockText|contains: Enabled-DuplicateToken
    - ScriptBlockText|contains: Exploit-Jboss
    - ScriptBlockText|contains: Export-ADRCSV
    - ScriptBlockText|contains: Export-ADRExcel
    - ScriptBlockText|contains: Export-ADRHTML
    - ScriptBlockText|contains: Export-ADRJSON
    - ScriptBlockText|contains: Export-ADRXML
    - ScriptBlockText|contains: Find-Fruit
    - ScriptBlockText|contains: Find-GPOLocation
    - ScriptBlockText|contains: Find-TrustedDocuments
    - ScriptBlockText|contains: Get-ADIDNSNodeAttribute
    - ScriptBlockText|contains: Get-ADIDNSNodeOwner
    - ScriptBlockText|contains: Get-ADIDNSNodeTombstoned
    - ScriptBlockText|contains: Get-ADIDNSPermission
    - ScriptBlockText|contains: Get-ADIDNSZone
    - ScriptBlockText|contains: Get-ChromeDump
    - ScriptBlockText|contains: Get-ClipboardContents
    - ScriptBlockText|contains: Get-FoxDump
    - ScriptBlockText|contains: Get-GPPPassword
    - ScriptBlockText|contains: Get-IndexedItem
    - ScriptBlockText|contains: Get-KerberosAESKey
    - ScriptBlockText|contains: Get-Keystrokes
    - ScriptBlockText|contains: Get-LSASecret
    - ScriptBlockText|contains: Get-PassHashes
    - ScriptBlockText|contains: Get-RegAlwaysInstallElevated
    - ScriptBlockText|contains: Get-RegAutoLogon
    - ScriptBlockText|contains: Get-RemoteBootKey
    - ScriptBlockText|contains: Get-RemoteCachedCredential
    - ScriptBlockText|contains: Get-RemoteLocalAccountHash
    - ScriptBlockText|contains: Get-RemoteLSAKey
    - ScriptBlockText|contains: Get-RemoteMachineAccountHash
    - ScriptBlockText|contains: Get-RemoteNLKMKey
    - ScriptBlockText|contains: Get-RickAstley
    - ScriptBlockText|contains: Get-SecurityPackages
    - ScriptBlockText|contains: Get-ServiceFilePermission
    - ScriptBlockText|contains: Get-ServicePermission
    - ScriptBlockText|contains: Get-ServiceUnquoted
    - ScriptBlockText|contains: Get-SiteListPassword
    - ScriptBlockText|contains: Get-System
    - ScriptBlockText|contains: Get-TimedScreenshot
    - ScriptBlockText|contains: Get-UnattendedInstallFile
    - ScriptBlockText|contains: Get-Unconstrained
    - ScriptBlockText|contains: Get-USBKeystrokes
    - ScriptBlockText|contains: Get-VaultCredential
    - ScriptBlockText|contains: Get-VulnAutoRun
    - ScriptBlockText|contains: Get-VulnSchTask
    - ScriptBlockText|contains: Grant-ADIDNSPermission
    - ScriptBlockText|contains: Gupt-Backdoor
    - ScriptBlockText|contains: Invoke-ACLScanner
    - ScriptBlockText|contains: Invoke-ADRecon
    - ScriptBlockText|contains: Invoke-ADSBackdoor
    - ScriptBlockText|contains: Invoke-AgentSmith
    - ScriptBlockText|contains: Invoke-AllChecks
    - ScriptBlockText|contains: Invoke-ARPScan
    - ScriptBlockText|contains: Invoke-AzureHound
    - ScriptBlockText|contains: Invoke-BackdoorLNK
    - ScriptBlockText|contains: Invoke-BadPotato
    - ScriptBlockText|contains: Invoke-BetterSafetyKatz
    - ScriptBlockText|contains: Invoke-BypassUAC
    - ScriptBlockText|contains: Invoke-Carbuncle
    - ScriptBlockText|contains: Invoke-Certify
    - ScriptBlockText|contains: Invoke-ConPtyShell
    - ScriptBlockText|contains: Invoke-CredentialInjection
    - ScriptBlockText|contains: Invoke-DAFT
    - ScriptBlockText|contains: Invoke-DCSync
    - ScriptBlockText|contains: Invoke-DinvokeKatz
    - ScriptBlockText|contains: Invoke-DllInjection
    - ScriptBlockText|contains: Invoke-DNSUpdate
    - ScriptBlockText|contains: Invoke-DomainPasswordSpray
    - ScriptBlockText|contains: Invoke-DowngradeAccount
    - ScriptBlockText|contains: Invoke-EgressCheck
    - ScriptBlockText|contains: Invoke-Eyewitness
    - ScriptBlockText|contains: Invoke-FakeLogonScreen
    - ScriptBlockText|contains: Invoke-Farmer
    - ScriptBlockText|contains: Invoke-Get-RBCD-Threaded
    - ScriptBlockText|contains: Invoke-Gopher
    - ScriptBlockText|contains: Invoke-Grouper
    - ScriptBlockText|contains: Invoke-HandleKatz
    - ScriptBlockText|contains: Invoke-ImpersonatedProcess
    - ScriptBlockText|contains: Invoke-ImpersonateSystem
    - ScriptBlockText|contains: Invoke-InteractiveSystemPowerShell
    - ScriptBlockText|contains: Invoke-Internalmonologue
    - ScriptBlockText|contains: Invoke-Inveigh
    - ScriptBlockText|contains: Invoke-InveighRelay
    - ScriptBlockText|contains: Invoke-KrbRelay
    - ScriptBlockText|contains: Invoke-LdapSignCheck
    - ScriptBlockText|contains: Invoke-Lockless
    - ScriptBlockText|contains: Invoke-MalSCCM
    - ScriptBlockText|contains: Invoke-Mimikatz
    - ScriptBlockText|contains: Invoke-Mimikittenz
    - ScriptBlockText|contains: Invoke-MITM6
    - ScriptBlockText|contains: Invoke-NanoDump
    - ScriptBlockText|contains: Invoke-NetRipper
    - ScriptBlockText|contains: Invoke-Nightmare
    - ScriptBlockText|contains: Invoke-NinjaCopy
    - ScriptBlockText|contains: Invoke-OfficeScrape
    - ScriptBlockText|contains: Invoke-OxidResolver
    - ScriptBlockText|contains: Invoke-P0wnedshell
    - ScriptBlockText|contains: Invoke-Paranoia
    - ScriptBlockText|contains: Invoke-PortScan
    - ScriptBlockText|contains: Invoke-PoshRatHttp
    - ScriptBlockText|contains: Invoke-PostExfil
    - ScriptBlockText|contains: Invoke-PowerDump
    - ScriptBlockText|contains: Invoke-PowerShellTCP
    - ScriptBlockText|contains: Invoke-PowerShellWMI
    - ScriptBlockText|contains: Invoke-PPLDump
    - ScriptBlockText|contains: Invoke-PsExec
    - ScriptBlockText|contains: Invoke-PSInject
    - ScriptBlockText|contains: Invoke-PsUaCme
    - ScriptBlockText|contains: Invoke-ReflectivePEInjection
    - ScriptBlockText|contains: Invoke-ReverseDNSLookup
    - ScriptBlockText|contains: Invoke-Rubeus
    - ScriptBlockText|contains: Invoke-RunAs
    - ScriptBlockText|contains: Invoke-SafetyKatz
    - ScriptBlockText|contains: Invoke-SauronEye
    - ScriptBlockText|contains: Invoke-SCShell
    - ScriptBlockText|contains: Invoke-Seatbelt
    - ScriptBlockText|contains: Invoke-ServiceAbuse
    - ScriptBlockText|contains: Invoke-ShadowSpray
    - ScriptBlockText|contains: Invoke-Sharp
    - ScriptBlockText|contains: Invoke-Shellcode
    - ScriptBlockText|contains: Invoke-SMBScanner
    - ScriptBlockText|contains: Invoke-Snaffler
    - ScriptBlockText|contains: Invoke-Spoolsample
    - ScriptBlockText|contains: Invoke-SpraySinglePassword
    - ScriptBlockText|contains: Invoke-SSHCommand
    - ScriptBlockText|contains: Invoke-StandIn
    - ScriptBlockText|contains: Invoke-StickyNotesExtract
    - ScriptBlockText|contains: Invoke-SystemCommand
    - ScriptBlockText|contains: Invoke-Tasksbackdoor
    - ScriptBlockText|contains: Invoke-Tater
    - ScriptBlockText|contains: Invoke-Thunderfox
    - ScriptBlockText|contains: Invoke-ThunderStruck
    - ScriptBlockText|contains: Invoke-TokenManipulation
    - ScriptBlockText|contains: Invoke-Tokenvator
    - ScriptBlockText|contains: Invoke-TotalExec
    - ScriptBlockText|contains: Invoke-UrbanBishop
    - ScriptBlockText|contains: Invoke-UserHunter
    - ScriptBlockText|contains: Invoke-VoiceTroll
    - ScriptBlockText|contains: Invoke-Whisker
    - ScriptBlockText|contains: Invoke-WinEnum
    - ScriptBlockText|contains: Invoke-winPEAS
    - ScriptBlockText|contains: Invoke-WireTap
    - ScriptBlockText|contains: Invoke-WmiCommand
    - ScriptBlockText|contains: Invoke-WMIExec
    - ScriptBlockText|contains: Invoke-WScriptBypassUAC
    - ScriptBlockText|contains: Invoke-Zerologon
    - ScriptBlockText|contains: MailRaider
    - ScriptBlockText|contains: New-ADIDNSNode
    - ScriptBlockText|contains: New-HoneyHash
    - ScriptBlockText|contains: New-InMemoryModule
    - ScriptBlockText|contains: New-SOASerialNumberArray
    - ScriptBlockText|contains: Out-Minidump
    - ScriptBlockText|contains: PowerBreach
    - ScriptBlockText|contains: 'powercat '
    - ScriptBlockText|contains: PowerUp
    - ScriptBlockText|contains: PowerView
    - ScriptBlockText|contains: Remove-ADIDNSNode
    - ScriptBlockText|contains: Remove-Update
    - ScriptBlockText|contains: Rename-ADIDNSNode
    - ScriptBlockText|contains: Revoke-ADIDNSPermission
    - ScriptBlockText|contains: Set-ADIDNSNode
    - ScriptBlockText|contains: Show-TargetScreen
    - ScriptBlockText|contains: Start-CaptureServer
    - ScriptBlockText|contains: Start-Dnscat2
    - ScriptBlockText|contains: Start-WebcamRecorder
    - ScriptBlockText|contains: VolumeShadowCopyTools
  - ScriptBlockText|not contains: Get-SystemDriveInfo
  - ScriptBlockText|not contains: C:\ProgramData\Amazon\EC2-Windows\Launch\Module\
id: 89819aa4-bbd6-46bc-88ec-c7f7fe30efa6
