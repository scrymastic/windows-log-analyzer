detection:
- selection_combined_1:
  - and:
    - or:
      - Image|endswith: \powershell.exe
      - Image|endswith: \pwsh.exe
    - or:
      - CommandLine|contains: ' | iex;'
      - CommandLine|contains: ' | iex '
      - CommandLine|contains: ' | iex}'
      - CommandLine|contains: ' | IEX ;'
      - CommandLine|contains: ' | IEX -Error'
      - CommandLine|contains: ' | IEX (new'
      - CommandLine|contains: ');IEX '
- selection_combined_2:
  - and:
    - or:
      - CommandLine|contains: ::FromBase64String
      - CommandLine|contains: '.GetString([System.Convert]::'
- selection_standalone:
  - and:
    - or:
      - CommandLine|contains: )|iex;$
      - CommandLine|contains: );iex($
      - CommandLine|contains: );iex $
      - CommandLine|contains: ' | IEX | '
      - CommandLine|contains: ' | iex\"'
- condition: all of selection_combined_* or selection_standalone
id: 09576804-7a05-458e-a817-eb718ca91f54
logsource:
  category: process_creation
  product: windows
