detection:
- selection_cmdlet:
  - and:
    - ScriptBlockText|contains: Set-ExecutionPolicy
- selection_option:
  - and:
    - or:
      - ScriptBlockText|contains: Unrestricted
      - ScriptBlockText|contains: bypass
- filter_optional_chocolatey:
  - and:
    - or:
      - ScriptBlockText|contains: (New-Object System.Net.WebClient).DownloadString('https://community.chocolatey.org/install.ps1')
      - ScriptBlockText|contains: (New-Object System.Net.WebClient).DownloadString('https://chocolatey.org/install.ps1')
- condition: all of selection_* and not 1 of filter_optional_*
id: 61d0475c-173f-4844-86f7-f3eebae1c66b
logsource:
  category: ps_script
  definition: 'Requirements: Script Block Logging must be enabled'
  product: windows
