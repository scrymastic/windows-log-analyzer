detection:
- and:
  - or:
    - or:
      - OriginalFileName|==: PowerShell.EXE
      - OriginalFileName|==: pwsh.dll
    - or:
      - Image|endswith: \powershell.exe
      - Image|endswith: \pwsh.exe
  - CommandLine|contains: ' Net.Sockets.TCPClient'
  - CommandLine|contains: .GetStream(
  - CommandLine|contains: .Write(
id: edc2f8ae-2412-4dfd-b9d5-0c57727e70be
logsource:
  category: process_creation
  product: windows
