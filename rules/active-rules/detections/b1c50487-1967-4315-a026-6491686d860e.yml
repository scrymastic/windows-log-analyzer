detection:
- and:
  - or:
    - or:
      - Image|endswith: \cscript.exe
      - Image|endswith: \mshta.exe
      - Image|endswith: \regsvr32.exe
      - Image|endswith: \rundll32.exe
      - Image|endswith: \wscript.exe
    - or:
      - ParentImage|endswith: \cscript.exe
      - ParentImage|endswith: \mshta.exe
      - ParentImage|endswith: \regsvr32.exe
      - ParentImage|endswith: \rundll32.exe
      - ParentImage|endswith: \wscript.exe
  - or:
    - TargetFilename|endswith: .docm
    - TargetFilename|endswith: .dotm
    - TargetFilename|endswith: .xlsm
    - TargetFilename|endswith: .xltm
    - TargetFilename|endswith: .potm
    - TargetFilename|endswith: .pptm
id: b1c50487-1967-4315-a026-6491686d860e
logsource:
  category: file_event
  definition: 'Requirements: The "ParentImage" field is not available by default on
    EID 11 of Sysmon logs. To be able to use this rule to the full extent you need
    to enriche the log with additional ParentImage data'
  product: windows
