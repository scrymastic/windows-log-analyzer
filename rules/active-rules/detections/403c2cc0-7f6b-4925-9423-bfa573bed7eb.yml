detection:
- webclient:
  - and:
    - ScriptBlockText|contains: System.Net.WebClient
- download:
  - and:
    - or:
      - ScriptBlockText|contains: .DownloadFile(
      - ScriptBlockText|contains: .DownloadFileAsync(
      - ScriptBlockText|contains: .DownloadString(
      - ScriptBlockText|contains: .DownloadStringAsync(
- condition: webclient and download
id: 403c2cc0-7f6b-4925-9423-bfa573bed7eb
logsource:
  category: ps_script
  definition: 'Requirements: Script Block Logging must be enabled'
  product: windows
