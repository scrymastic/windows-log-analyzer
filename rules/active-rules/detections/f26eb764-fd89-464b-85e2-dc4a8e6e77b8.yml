detection:
- selection_parent:
  - and:
    - or:
      - ParentImage|endswith: \chrome.exe
      - ParentImage|endswith: \discord.exe
      - ParentImage|endswith: \GitHubDesktop.exe
      - ParentImage|endswith: \keybase.exe
      - ParentImage|endswith: \msedge.exe
      - ParentImage|endswith: \msedgewebview2.exe
      - ParentImage|endswith: \msteams.exe
      - ParentImage|endswith: \slack.exe
      - ParentImage|endswith: \Teams.exe
- selection_child_image:
  - and:
    - or:
      - Image|endswith: \cmd.exe
      - Image|endswith: \cscript.exe
      - Image|endswith: \mshta.exe
      - Image|endswith: \powershell.exe
      - Image|endswith: \pwsh.exe
      - Image|endswith: \regsvr32.exe
      - Image|endswith: \wscript.exe
- selection_child_paths:
  - and:
    - or:
      - Image|contains: \AppData\Local\Temp\
      - Image|contains: \Users\Public\
      - Image|contains: \Windows\Temp\
      - Image|contains: :\Temp\
- filter_main_chrome:
  - and:
    - ParentImage|endswith: \chrome.exe
    - Image|endswith: \chrome.exe
- filter_main_discord:
  - and:
    - ParentImage|endswith: \discord.exe
    - Image|endswith: \discord.exe
- filter_main_githubdesktop:
  - and:
    - ParentImage|endswith: \GitHubDesktop.exe
    - Image|endswith: \GitHubDesktop.exe
- filter_main_keybase:
  - and:
    - ParentImage|endswith: \keybase.exe
    - Image|endswith: \keybase.exe
- filter_main_msedge:
  - and:
    - ParentImage|endswith: \msedge.exe
    - Image|endswith: \msedge.exe
- filter_main_msedgewebview:
  - and:
    - ParentImage|endswith: \msedgewebview2.exe
    - Image|endswith: \msedgewebview2.exe
- filter_main_msteams:
  - and:
    - ParentImage|endswith: \msteams.exe
    - Image|endswith: \msteams.exe
- filter_main_slack:
  - and:
    - ParentImage|endswith: \slack.exe
    - Image|endswith: \slack.exe
- filter_main_teams:
  - and:
    - ParentImage|endswith: \teams.exe
    - Image|endswith: \teams.exe
- filter_main_werfault:
  - and:
    - or:
      - Image|==: C:\Windows\SysWOW64\WerFault.exe
      - Image|==: C:\Windows\System32\WerFault.exe
- filter_optional_discord:
  - and:
    - ParentImage|endswith: \Discord.exe
    - CommandLine|contains: \NVSMI\nvidia-smi.exe
- condition: selection_parent and 1 of selection_child_* and not 1 of filter_main_*
    and not 1 of filter_optional_*
id: f26eb764-fd89-464b-85e2-dc4a8e6e77b8
logsource:
  category: process_creation
  product: windows
