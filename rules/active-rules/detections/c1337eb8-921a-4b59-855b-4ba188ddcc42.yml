detection:
- selection_get:
  - and:
    - or:
      - ScriptBlockText|contains: Get-WmiObject
      - ScriptBlockText|contains: gwmi
      - ScriptBlockText|contains: Get-CimInstance
      - ScriptBlockText|contains: gcim
- selection_shadowcopy:
  - and:
    - ScriptBlockText|contains: Win32_Shadowcopy
- selection_delete:
  - and:
    - or:
      - ScriptBlockText|contains: .Delete()
      - ScriptBlockText|contains: Remove-WmiObject
      - ScriptBlockText|contains: rwmi
      - ScriptBlockText|contains: Remove-CimInstance
      - ScriptBlockText|contains: rcim
- condition: all of selection*
id: c1337eb8-921a-4b59-855b-4ba188ddcc42
logsource:
  category: ps_script
  product: windows
