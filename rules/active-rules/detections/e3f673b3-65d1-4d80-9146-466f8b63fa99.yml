detection:
- selection:
  - and:
    - or:
      - SourceFilename|endswith: .doc
      - SourceFilename|endswith: .docx
      - SourceFilename|endswith: .jpeg
      - SourceFilename|endswith: .jpg
      - SourceFilename|endswith: .lnk
      - SourceFilename|endswith: .pdf
      - SourceFilename|endswith: .png
      - SourceFilename|endswith: .pst
      - SourceFilename|endswith: .rtf
      - SourceFilename|endswith: .xls
      - SourceFilename|endswith: .xlsx
    - or:
      - TargetFilename|contains: .doc.
      - TargetFilename|contains: .docx.
      - TargetFilename|contains: .jpeg.
      - TargetFilename|contains: .jpg.
      - TargetFilename|contains: .lnk.
      - TargetFilename|contains: .pdf.
      - TargetFilename|contains: .png.
      - TargetFilename|contains: .pst.
      - TargetFilename|contains: .rtf.
      - TargetFilename|contains: .xls.
      - TargetFilename|contains: .xlsx.
- filter_main_generic:
  - and:
    - or:
      - TargetFilename|endswith: .backup
      - TargetFilename|endswith: .bak
      - TargetFilename|endswith: .old
      - TargetFilename|endswith: .orig
      - TargetFilename|endswith: .temp
      - TargetFilename|endswith: .tmp
- filter_optional_anaconda:
  - and:
    - TargetFilename|contains: :\ProgramData\Anaconda3\
    - TargetFilename|endswith: .c~
- condition: selection and not 1 of filter_main_* and not 1 of filter_optional_*
id: e3f673b3-65d1-4d80-9146-466f8b63fa99
logsource:
  category: file_rename
  definition: 'Requirements: Microsoft-Windows-Kernel-File Provider with at least
    the KERNEL_FILE_KEYWORD_RENAME_SETLINK_PATH keyword'
  product: windows
