detection:
- selection:
  - and:
    - or:
      - CommandLine|contains: Add-Exfiltration
      - CommandLine|contains: Add-Persistence
      - CommandLine|contains: Add-RegBackdoor
      - CommandLine|contains: Add-RemoteRegBackdoor
      - CommandLine|contains: Add-ScrnSaveBackdoor
      - CommandLine|contains: Check-VM
      - CommandLine|contains: ConvertTo-Rc4ByteStream
      - CommandLine|contains: Decrypt-Hash
      - CommandLine|contains: Disable-ADIDNSNode
      - CommandLine|contains: Disable-MachineAccount
      - CommandLine|contains: Do-Exfiltration
      - CommandLine|contains: Enable-ADIDNSNode
      - CommandLine|contains: Enable-MachineAccount
      - CommandLine|contains: Enabled-DuplicateToken
      - CommandLine|contains: Exploit-Jboss
      - CommandLine|contains: Export-ADR
      - CommandLine|contains: Export-ADRCSV
      - CommandLine|contains: Export-ADRExcel
      - CommandLine|contains: Export-ADRHTML
      - CommandLine|contains: Export-ADRJSON
      - CommandLine|contains: Export-ADRXML
      - CommandLine|contains: Find-Fruit
      - CommandLine|contains: Find-GPOLocation
      - CommandLine|contains: Find-TrustedDocuments
      - CommandLine|contains: Get-ADIDNS
      - CommandLine|contains: Get-ApplicationHost
      - CommandLine|contains: Get-ChromeDump
      - CommandLine|contains: Get-ClipboardContents
      - CommandLine|contains: Get-FoxDump
      - CommandLine|contains: Get-GPPPassword
      - CommandLine|contains: Get-IndexedItem
      - CommandLine|contains: Get-KerberosAESKey
      - CommandLine|contains: Get-Keystrokes
      - CommandLine|contains: Get-LSASecret
      - CommandLine|contains: Get-MachineAccountAttribute
      - CommandLine|contains: Get-MachineAccountCreator
      - CommandLine|contains: Get-PassHashes
      - CommandLine|contains: Get-RegAlwaysInstallElevated
      - CommandLine|contains: Get-RegAutoLogon
      - CommandLine|contains: Get-RemoteBootKey
      - CommandLine|contains: Get-RemoteCachedCredential
      - CommandLine|contains: Get-RemoteLocalAccountHash
      - CommandLine|contains: Get-RemoteLSAKey
      - CommandLine|contains: Get-RemoteMachineAccountHash
      - CommandLine|contains: Get-RemoteNLKMKey
      - CommandLine|contains: Get-RickAstley
      - CommandLine|contains: Get-Screenshot
      - CommandLine|contains: Get-SecurityPackages
      - CommandLine|contains: Get-ServiceFilePermission
      - CommandLine|contains: Get-ServicePermission
      - CommandLine|contains: Get-ServiceUnquoted
      - CommandLine|contains: Get-SiteListPassword
      - CommandLine|contains: Get-System
      - CommandLine|contains: Get-TimedScreenshot
      - CommandLine|contains: Get-UnattendedInstallFile
      - CommandLine|contains: Get-Unconstrained
      - CommandLine|contains: Get-USBKeystrokes
      - CommandLine|contains: Get-VaultCredential
      - CommandLine|contains: Get-VulnAutoRun
      - CommandLine|contains: Get-VulnSchTask
      - CommandLine|contains: Grant-ADIDNSPermission
      - CommandLine|contains: Gupt-Backdoor
      - CommandLine|contains: HTTP-Login
      - CommandLine|contains: Install-ServiceBinary
      - CommandLine|contains: Install-SSP
      - CommandLine|contains: Invoke-ACLScanner
      - CommandLine|contains: Invoke-ADRecon
      - CommandLine|contains: Invoke-ADSBackdoor
      - CommandLine|contains: Invoke-AgentSmith
      - CommandLine|contains: Invoke-AllChecks
      - CommandLine|contains: Invoke-ARPScan
      - CommandLine|contains: Invoke-AzureHound
      - CommandLine|contains: Invoke-BackdoorLNK
      - CommandLine|contains: Invoke-BadPotato
      - CommandLine|contains: Invoke-BetterSafetyKatz
      - CommandLine|contains: Invoke-BypassUAC
      - CommandLine|contains: Invoke-Carbuncle
      - CommandLine|contains: Invoke-Certify
      - CommandLine|contains: Invoke-ConPtyShell
      - CommandLine|contains: Invoke-CredentialInjection
      - CommandLine|contains: Invoke-DAFT
      - CommandLine|contains: Invoke-DCSync
      - CommandLine|contains: Invoke-DinvokeKatz
      - CommandLine|contains: Invoke-DllInjection
      - CommandLine|contains: Invoke-DNSUpdate
      - CommandLine|contains: Invoke-DomainPasswordSpray
      - CommandLine|contains: Invoke-DowngradeAccount
      - CommandLine|contains: Invoke-EgressCheck
      - CommandLine|contains: Invoke-Eyewitness
      - CommandLine|contains: Invoke-FakeLogonScreen
      - CommandLine|contains: Invoke-Farmer
      - CommandLine|contains: Invoke-Get-RBCD-Threaded
      - CommandLine|contains: Invoke-Gopher
      - CommandLine|contains: Invoke-Grouper
      - CommandLine|contains: Invoke-HandleKatz
      - CommandLine|contains: Invoke-ImpersonatedProcess
      - CommandLine|contains: Invoke-ImpersonateSystem
      - CommandLine|contains: Invoke-InteractiveSystemPowerShell
      - CommandLine|contains: Invoke-Internalmonologue
      - CommandLine|contains: Invoke-Inveigh
      - CommandLine|contains: Invoke-InveighRelay
      - CommandLine|contains: Invoke-KrbRelay
      - CommandLine|contains: Invoke-LdapSignCheck
      - CommandLine|contains: Invoke-Lockless
      - CommandLine|contains: Invoke-MalSCCM
      - CommandLine|contains: Invoke-Mimikatz
      - CommandLine|contains: Invoke-Mimikittenz
      - CommandLine|contains: Invoke-MITM6
      - CommandLine|contains: Invoke-NanoDump
      - CommandLine|contains: Invoke-NetRipper
      - CommandLine|contains: Invoke-Nightmare
      - CommandLine|contains: Invoke-NinjaCopy
      - CommandLine|contains: Invoke-OfficeScrape
      - CommandLine|contains: Invoke-OxidResolver
      - CommandLine|contains: Invoke-P0wnedshell
      - CommandLine|contains: Invoke-Paranoia
      - CommandLine|contains: Invoke-PortScan
      - CommandLine|contains: Invoke-PoshRatHttp
      - CommandLine|contains: Invoke-PostExfil
      - CommandLine|contains: Invoke-PowerDump
      - CommandLine|contains: Invoke-PowerShellTCP
      - CommandLine|contains: Invoke-PowerShellWMI
      - CommandLine|contains: Invoke-PPLDump
      - CommandLine|contains: Invoke-PsExec
      - CommandLine|contains: Invoke-PSInject
      - CommandLine|contains: Invoke-PsUaCme
      - CommandLine|contains: Invoke-ReflectivePEInjection
      - CommandLine|contains: Invoke-ReverseDNSLookup
      - CommandLine|contains: Invoke-Rubeus
      - CommandLine|contains: Invoke-RunAs
      - CommandLine|contains: Invoke-SafetyKatz
      - CommandLine|contains: Invoke-SauronEye
      - CommandLine|contains: Invoke-SCShell
      - CommandLine|contains: Invoke-Seatbelt
      - CommandLine|contains: Invoke-ServiceAbuse
      - CommandLine|contains: Invoke-ShadowSpray
      - CommandLine|contains: Invoke-Sharp
      - CommandLine|contains: Invoke-Shellcode
      - CommandLine|contains: Invoke-SMBScanner
      - CommandLine|contains: Invoke-Snaffler
      - CommandLine|contains: Invoke-Spoolsample
      - CommandLine|contains: Invoke-SpraySinglePassword
      - CommandLine|contains: Invoke-SSHCommand
      - CommandLine|contains: Invoke-StandIn
      - CommandLine|contains: Invoke-StickyNotesExtract
      - CommandLine|contains: Invoke-SystemCommand
      - CommandLine|contains: Invoke-Tasksbackdoor
      - CommandLine|contains: Invoke-Tater
      - CommandLine|contains: Invoke-Thunderfox
      - CommandLine|contains: Invoke-ThunderStruck
      - CommandLine|contains: Invoke-TokenManipulation
      - CommandLine|contains: Invoke-Tokenvator
      - CommandLine|contains: Invoke-TotalExec
      - CommandLine|contains: Invoke-UrbanBishop
      - CommandLine|contains: Invoke-UserHunter
      - CommandLine|contains: Invoke-VoiceTroll
      - CommandLine|contains: Invoke-Whisker
      - CommandLine|contains: Invoke-WinEnum
      - CommandLine|contains: Invoke-winPEAS
      - CommandLine|contains: Invoke-WireTap
      - CommandLine|contains: Invoke-WmiCommand
      - CommandLine|contains: Invoke-WMIExec
      - CommandLine|contains: Invoke-WScriptBypassUAC
      - CommandLine|contains: Invoke-Zerologon
      - CommandLine|contains: MailRaider
      - CommandLine|contains: New-ADIDNSNode
      - CommandLine|contains: New-DNSRecordArray
      - CommandLine|contains: New-HoneyHash
      - CommandLine|contains: New-InMemoryModule
      - CommandLine|contains: New-MachineAccount
      - CommandLine|contains: New-SOASerialNumberArray
      - CommandLine|contains: Out-Minidump
      - CommandLine|contains: Port-Scan
      - CommandLine|contains: PowerBreach
      - CommandLine|contains: 'powercat '
      - CommandLine|contains: PowerUp
      - CommandLine|contains: PowerView
      - CommandLine|contains: Remove-ADIDNSNode
      - CommandLine|contains: Remove-MachineAccount
      - CommandLine|contains: Remove-Update
      - CommandLine|contains: Rename-ADIDNSNode
      - CommandLine|contains: Revoke-ADIDNSPermission
      - CommandLine|contains: Set-ADIDNSNode
      - CommandLine|contains: Set-MacAttribute
      - CommandLine|contains: Set-MachineAccountAttribute
      - CommandLine|contains: Set-Wallpaper
      - CommandLine|contains: Show-TargetScreen
      - CommandLine|contains: Start-CaptureServer
      - CommandLine|contains: Start-Dnscat2
      - CommandLine|contains: Start-WebcamRecorder
      - CommandLine|contains: VolumeShadowCopyTools
- condition: selection
id: 02030f2f-6199-49ec-b258-ea71b07e03dc
logsource:
  category: process_creation
  product: windows
