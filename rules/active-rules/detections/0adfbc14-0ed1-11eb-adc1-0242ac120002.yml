detection:
- selection_4104:
  - and:
    - ScriptBlockText|matches: .*cmd.{0,5}(?:/c|/r)(?:\s|)"set\s[a-zA-Z]{3,6}.*(?:\{\d\}){1,}\\"\s+?-f(?:.*\)){1,}.*"
- condition: selection_4104
id: 0adfbc14-0ed1-11eb-adc1-0242ac120002
logsource:
  category: ps_script
  definition: 'Requirements: Script Block Logging must be enabled'
  product: windows
