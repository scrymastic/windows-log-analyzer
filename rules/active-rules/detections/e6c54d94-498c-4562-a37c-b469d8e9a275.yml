detection:
- selection:
  - and:
    - or:
      - CommandLine|contains: IEX ((New-Object Net.WebClient).DownloadString
      - CommandLine|contains: IEX (New-Object Net.WebClient).DownloadString
      - CommandLine|contains: IEX((New-Object Net.WebClient).DownloadString
      - CommandLine|contains: IEX(New-Object Net.WebClient).DownloadString
      - CommandLine|contains: ' -command (New-Object System.Net.WebClient).DownloadFile('
      - CommandLine|contains: ' -c (New-Object System.Net.WebClient).DownloadFile('
- condition: selection
id: e6c54d94-498c-4562-a37c-b469d8e9a275
logsource:
  category: process_creation
  product: windows
