detection:
- and:
  - ParentImage|endswith: \onenote.exe
  - or:
    - or:
      - OriginalFileName|==: bitsadmin.exe
      - OriginalFileName|==: CertOC.exe
      - OriginalFileName|==: CertUtil.exe
      - OriginalFileName|==: Cmd.Exe
      - OriginalFileName|==: CMSTP.EXE
      - OriginalFileName|==: cscript.exe
      - OriginalFileName|==: curl.exe
      - OriginalFileName|==: HH.exe
      - OriginalFileName|==: IEExec.exe
      - OriginalFileName|==: InstallUtil.exe
      - OriginalFileName|==: javaw.exe
      - OriginalFileName|==: Microsoft.Workflow.Compiler.exe
      - OriginalFileName|==: msdt.exe
      - OriginalFileName|==: MSHTA.EXE
      - OriginalFileName|==: msiexec.exe
      - OriginalFileName|==: Msxsl.exe
      - OriginalFileName|==: odbcconf.exe
      - OriginalFileName|==: pcalua.exe
      - OriginalFileName|==: PowerShell.EXE
      - OriginalFileName|==: RegAsm.exe
      - OriginalFileName|==: RegSvcs.exe
      - OriginalFileName|==: REGSVR32.exe
      - OriginalFileName|==: RUNDLL32.exe
      - OriginalFileName|==: schtasks.exe
      - OriginalFileName|==: ScriptRunner.exe
      - OriginalFileName|==: wmic.exe
      - OriginalFileName|==: WorkFolders.exe
      - OriginalFileName|==: wscript.exe
    - or:
      - Image|endswith: \AppVLP.exe
      - Image|endswith: \bash.exe
      - Image|endswith: \bitsadmin.exe
      - Image|endswith: \certoc.exe
      - Image|endswith: \certutil.exe
      - Image|endswith: \cmd.exe
      - Image|endswith: \cmstp.exe
      - Image|endswith: \control.exe
      - Image|endswith: \cscript.exe
      - Image|endswith: \curl.exe
      - Image|endswith: \forfiles.exe
      - Image|endswith: \hh.exe
      - Image|endswith: \ieexec.exe
      - Image|endswith: \installutil.exe
      - Image|endswith: \javaw.exe
      - Image|endswith: \mftrace.exe
      - Image|endswith: \Microsoft.Workflow.Compiler.exe
      - Image|endswith: \msbuild.exe
      - Image|endswith: \msdt.exe
      - Image|endswith: \mshta.exe
      - Image|endswith: \msidb.exe
      - Image|endswith: \msiexec.exe
      - Image|endswith: \msxsl.exe
      - Image|endswith: \odbcconf.exe
      - Image|endswith: \pcalua.exe
      - Image|endswith: \powershell.exe
      - Image|endswith: \pwsh.exe
      - Image|endswith: \regasm.exe
      - Image|endswith: \regsvcs.exe
      - Image|endswith: \regsvr32.exe
      - Image|endswith: \rundll32.exe
      - Image|endswith: \schtasks.exe
      - Image|endswith: \scrcons.exe
      - Image|endswith: \scriptrunner.exe
      - Image|endswith: \sh.exe
      - Image|endswith: \svchost.exe
      - Image|endswith: \verclsid.exe
      - Image|endswith: \wmic.exe
      - Image|endswith: \workfolders.exe
      - Image|endswith: \wscript.exe
  - Image|endswith: \explorer.exe
  - or:
    - CommandLine|contains: .hta
    - CommandLine|contains: .vb
    - CommandLine|contains: .wsh
    - CommandLine|contains: .js
    - CommandLine|contains: .ps
    - CommandLine|contains: .scr
    - CommandLine|contains: .pif
    - CommandLine|contains: .bat
    - CommandLine|contains: .cmd
  - or:
    - Image|contains: \AppData\
    - Image|contains: \Users\Public\
    - Image|contains: \ProgramData\
    - Image|contains: \Windows\Tasks\
    - Image|contains: \Windows\Temp\
    - Image|contains: \Windows\System32\Tasks\
  - or:
    - Image|not endswith: \AppData\Local\Microsoft\Teams\current\Teams.exe
    - CommandLine|not endswith: -Embedding
  - or:
    - Image|not contains: \AppData\Local\Microsoft\OneDrive\
    - Image|not endswith: \FileCoAuth.exe
    - CommandLine|not endswith: -Embedding
id: c27515df-97a9-4162-8a60-dc0eeb51b775
