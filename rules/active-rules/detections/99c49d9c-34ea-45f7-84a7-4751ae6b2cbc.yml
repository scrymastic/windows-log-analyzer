detection:
- selection_kiddie:
  - and:
    - or:
      - ScriptBlockText|contains: Get-PasswordVaultCredentials
      - ScriptBlockText|contains: Get-CredManCreds
- selection_rename_Password:
  - and:
    - ScriptBlockText|contains: New-Object
    - ScriptBlockText|contains: Windows.Security.Credentials.PasswordVault
- selection_rename_credman:
  - and:
    - ScriptBlockText|contains: New-Object
    - ScriptBlockText|contains: Microsoft.CSharp.CSharpCodeProvider
    - ScriptBlockText|contains: '[System.Runtime.InteropServices.RuntimeEnvironment]::GetRuntimeDirectory())'
    - ScriptBlockText|contains: Collections.ArrayList
    - ScriptBlockText|contains: System.CodeDom.Compiler.CompilerParameters
- condition: 1 of selection_*
id: 99c49d9c-34ea-45f7-84a7-4751ae6b2cbc
logsource:
  category: ps_script
  definition: 'Requirements: Script Block Logging must be enabled'
  product: windows
