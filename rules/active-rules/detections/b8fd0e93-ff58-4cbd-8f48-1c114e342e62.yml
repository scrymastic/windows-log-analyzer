detection:
- selection_generic:
  - and:
    - or:
      - Image|endswith: \smss.exe
      - Image|endswith: \RuntimeBroker.exe
      - Image|endswith: \sihost.exe
      - Image|endswith: \lsass.exe
      - Image|endswith: \csrss.exe
      - Image|endswith: \winlogon.exe
      - Image|endswith: \wininit.exe
    - or:
      - TargetFilename|endswith: .bat
      - TargetFilename|endswith: .vbe
      - TargetFilename|endswith: .txt
      - TargetFilename|endswith: .vbs
      - TargetFilename|endswith: .exe
      - TargetFilename|endswith: .ps1
      - TargetFilename|endswith: .hta
      - TargetFilename|endswith: .iso
      - TargetFilename|endswith: .dll
- selection_special:
  - and:
    - or:
      - Image|endswith: \rundll32.exe
      - Image|endswith: \svchost.exe
      - Image|endswith: \dllhost.exe
    - or:
      - TargetFilename|endswith: .bat
      - TargetFilename|endswith: .vbe
      - TargetFilename|endswith: .vbs
      - TargetFilename|endswith: .ps1
      - TargetFilename|endswith: .hta
      - TargetFilename|endswith: .iso
- filter_main_AppLockerPolicyTest:
  - and:
    - Image|==: C:\Windows\System32\dllhost.exe
    - TargetFilename|contains: :\Users\
    - TargetFilename|contains: \AppData\Local\Temp\__PSScriptPolicyTest_
    - TargetFilename|endswith: .ps1
- condition: 1 of selection_* and not 1 of filter_main_*
id: b8fd0e93-ff58-4cbd-8f48-1c114e342e62
logsource:
  category: file_event
  product: windows
