detection:
- selection_curl:
  - and:
    - or:
      - Image|endswith: \curl.exe
      - Product|==: The curl executable
- selection_susp_locations:
  - and:
    - or:
      - CommandLine|contains: '%AppData%'
      - CommandLine|contains: '%Public%'
      - CommandLine|contains: '%Temp%'
      - CommandLine|contains: '%tmp%'
      - CommandLine|contains: \AppData\
      - CommandLine|contains: \Desktop\
      - CommandLine|contains: \Temp\
      - CommandLine|contains: \Users\Public\
      - CommandLine|contains: C:\PerfLogs\
      - CommandLine|contains: C:\ProgramData\
      - CommandLine|contains: C:\Windows\Temp\
- selection_susp_extensions:
  - and:
    - or:
      - CommandLine|endswith: .dll
      - CommandLine|endswith: .gif
      - CommandLine|endswith: .jpeg
      - CommandLine|endswith: .jpg
      - CommandLine|endswith: .png
      - CommandLine|endswith: .temp
      - CommandLine|endswith: .tmp
      - CommandLine|endswith: .txt
      - CommandLine|endswith: .vbe
      - CommandLine|endswith: .vbs
- filter_optional_git_windows:
  - and:
    - ParentImage|==: C:\Program Files\Git\usr\bin\sh.exe
    - Image|==: C:\Program Files\Git\mingw64\bin\curl.exe
    - CommandLine|contains: '--silent --show-error --output '
    - CommandLine|contains: gfw-httpget-
    - CommandLine|contains: AppData
- condition: selection_curl and 1 of selection_susp_* and not 1 of filter_optional_*
id: e218595b-bbe7-4ee5-8a96-f32a24ad3468
logsource:
  category: process_creation
  product: windows
