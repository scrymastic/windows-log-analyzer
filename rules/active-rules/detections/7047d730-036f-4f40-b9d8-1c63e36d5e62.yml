detection:
- selection:
  - and:
    - or:
      - Image|endswith: \powershell.exe
      - Image|endswith: \pwsh.exe
    - or:
      - TargetFilename|endswith: .bat
      - TargetFilename|endswith: .chm
      - TargetFilename|endswith: .cmd
      - TargetFilename|endswith: .com
      - TargetFilename|endswith: .dll
      - TargetFilename|endswith: .exe
      - TargetFilename|endswith: .hta
      - TargetFilename|endswith: .jar
      - TargetFilename|endswith: .js
      - TargetFilename|endswith: .ocx
      - TargetFilename|endswith: .scr
      - TargetFilename|endswith: .sys
      - TargetFilename|endswith: .vbe
      - TargetFilename|endswith: .vbs
      - TargetFilename|endswith: .wsf
- filter_main_user_temp:
  - and:
    - TargetFilename|startswith: C:\Users\
    - TargetFilename|contains: \AppData\Local\Temp\
    - or:
      - TargetFilename|endswith: .dll
      - TargetFilename|endswith: .exe
- filter_main_admin_temp:
  - and:
    - TargetFilename|startswith: C:\Windows\Temp\
    - or:
      - TargetFilename|endswith: .dll
      - TargetFilename|endswith: .exe
- condition: selection and not 1 of filter_main_*
id: 7047d730-036f-4f40-b9d8-1c63e36d5e62
logsource:
  category: file_event
  product: windows
