detection:
- selection_generic:
  - and:
    - or:
      - ContextInfo|contains: Add-ConstrainedDelegationBackdoor.ps1
      - ContextInfo|contains: Add-Exfiltration.ps1
      - ContextInfo|contains: Add-Persistence.ps1
      - ContextInfo|contains: Add-RegBackdoor.ps1
      - ContextInfo|contains: Add-RemoteRegBackdoor.ps1
      - ContextInfo|contains: Add-ScrnSaveBackdoor.ps1
      - ContextInfo|contains: Check-VM.ps1
      - ContextInfo|contains: ConvertTo-ROT13.ps1
      - ContextInfo|contains: Copy-VSS.ps1
      - ContextInfo|contains: Create-MultipleSessions.ps1
      - ContextInfo|contains: DNS_TXT_Pwnage.ps1
      - ContextInfo|contains: dnscat2.ps1
      - ContextInfo|contains: Do-Exfiltration.ps1
      - ContextInfo|contains: DomainPasswordSpray.ps1
      - ContextInfo|contains: Download_Execute.ps1
      - ContextInfo|contains: Download-Execute-PS.ps1
      - ContextInfo|contains: Enabled-DuplicateToken.ps1
      - ContextInfo|contains: Enable-DuplicateToken.ps1
      - ContextInfo|contains: Execute-Command-MSSQL.ps1
      - ContextInfo|contains: Execute-DNSTXT-Code.ps1
      - ContextInfo|contains: Execute-OnTime.ps1
      - ContextInfo|contains: ExetoText.ps1
      - ContextInfo|contains: Exploit-Jboss.ps1
      - ContextInfo|contains: Find-AVSignature.ps1
      - ContextInfo|contains: Find-Fruit.ps1
      - ContextInfo|contains: Find-GPOLocation.ps1
      - ContextInfo|contains: Find-TrustedDocuments.ps1
      - ContextInfo|contains: FireBuster.ps1
      - ContextInfo|contains: FireListener.ps1
      - ContextInfo|contains: Get-ApplicationHost.ps1
      - ContextInfo|contains: Get-ChromeDump.ps1
      - ContextInfo|contains: Get-ClipboardContents.ps1
      - ContextInfo|contains: Get-ComputerDetail.ps1
      - ContextInfo|contains: Get-FoxDump.ps1
      - ContextInfo|contains: Get-GPPAutologon.ps1
      - ContextInfo|contains: Get-GPPPassword.ps1
      - ContextInfo|contains: Get-IndexedItem.ps1
      - ContextInfo|contains: Get-Keystrokes.ps1
      - ContextInfo|contains: Get-LSASecret.ps1
      - ContextInfo|contains: Get-MicrophoneAudio.ps1
      - ContextInfo|contains: Get-PassHashes.ps1
      - ContextInfo|contains: Get-PassHints.ps1
      - ContextInfo|contains: Get-RegAlwaysInstallElevated.ps1
      - ContextInfo|contains: Get-RegAutoLogon.ps1
      - ContextInfo|contains: Get-RickAstley.ps1
      - ContextInfo|contains: Get-Screenshot.ps1
      - ContextInfo|contains: Get-SecurityPackages.ps1
      - ContextInfo|contains: Get-ServiceFilePermission.ps1
      - ContextInfo|contains: Get-ServicePermission.ps1
      - ContextInfo|contains: Get-ServiceUnquoted.ps1
      - ContextInfo|contains: Get-SiteListPassword.ps1
      - ContextInfo|contains: Get-System.ps1
      - ContextInfo|contains: Get-TimedScreenshot.ps1
      - ContextInfo|contains: Get-UnattendedInstallFile.ps1
      - ContextInfo|contains: Get-Unconstrained.ps1
      - ContextInfo|contains: Get-USBKeystrokes.ps1
      - ContextInfo|contains: Get-VaultCredential.ps1
      - ContextInfo|contains: Get-VulnAutoRun.ps1
      - ContextInfo|contains: Get-VulnSchTask.ps1
      - ContextInfo|contains: Get-WebConfig.ps1
      - ContextInfo|contains: Get-WebCredentials.ps1
      - ContextInfo|contains: Get-WLAN-Keys.ps1
      - ContextInfo|contains: Gupt-Backdoor.ps1
      - ContextInfo|contains: HTTP-Backdoor.ps1
      - ContextInfo|contains: HTTP-Login.ps1
      - ContextInfo|contains: Install-ServiceBinary.ps1
      - ContextInfo|contains: Install-SSP.ps1
      - ContextInfo|contains: Invoke-ACLScanner.ps1
      - ContextInfo|contains: Invoke-ADSBackdoor.ps1
      - ContextInfo|contains: Invoke-AmsiBypass.ps1
      - ContextInfo|contains: Invoke-ARPScan.ps1
      - ContextInfo|contains: Invoke-BackdoorLNK.ps1
      - ContextInfo|contains: Invoke-BadPotato.ps1
      - ContextInfo|contains: Invoke-BetterSafetyKatz.ps1
      - ContextInfo|contains: Invoke-BruteForce.ps1
      - ContextInfo|contains: Invoke-BypassUAC.ps1
      - ContextInfo|contains: Invoke-Carbuncle.ps1
      - ContextInfo|contains: Invoke-Certify.ps1
      - ContextInfo|contains: Invoke-ConPtyShell.ps1
      - ContextInfo|contains: Invoke-CredentialInjection.ps1
      - ContextInfo|contains: Invoke-CredentialsPhish.ps1
      - ContextInfo|contains: Invoke-DAFT.ps1
      - ContextInfo|contains: Invoke-DCSync.ps1
      - ContextInfo|contains: Invoke-Decode.ps1
      - ContextInfo|contains: Invoke-DinvokeKatz.ps1
      - ContextInfo|contains: Invoke-DllInjection.ps1
      - ContextInfo|contains: Invoke-DowngradeAccount.ps1
      - ContextInfo|contains: Invoke-EgressCheck.ps1
      - ContextInfo|contains: Invoke-Encode.ps1
      - ContextInfo|contains: Invoke-EventViewer.ps1
      - ContextInfo|contains: Invoke-Eyewitness.ps1
      - ContextInfo|contains: Invoke-FakeLogonScreen.ps1
      - ContextInfo|contains: Invoke-Farmer.ps1
      - ContextInfo|contains: Invoke-Get-RBCD-Threaded.ps1
      - ContextInfo|contains: Invoke-Gopher.ps1
      - ContextInfo|contains: Invoke-Grouper2.ps1
      - ContextInfo|contains: Invoke-Grouper3.ps1
      - ContextInfo|contains: Invoke-HandleKatz.ps1
      - ContextInfo|contains: Invoke-Interceptor.ps1
      - ContextInfo|contains: Invoke-Internalmonologue.ps1
      - ContextInfo|contains: Invoke-Inveigh.ps1
      - ContextInfo|contains: Invoke-InveighRelay.ps1
      - ContextInfo|contains: Invoke-JSRatRegsvr.ps1
      - ContextInfo|contains: Invoke-JSRatRundll.ps1
      - ContextInfo|contains: Invoke-KrbRelay.ps1
      - ContextInfo|contains: Invoke-KrbRelayUp.ps1
      - ContextInfo|contains: Invoke-LdapSignCheck.ps1
      - ContextInfo|contains: Invoke-Lockless.ps1
      - ContextInfo|contains: Invoke-MalSCCM.ps1
      - ContextInfo|contains: Invoke-Mimikatz.ps1
      - ContextInfo|contains: Invoke-MimikatzWDigestDowngrade.ps1
      - ContextInfo|contains: Invoke-Mimikittenz.ps1
      - ContextInfo|contains: Invoke-MITM6.ps1
      - ContextInfo|contains: Invoke-NanoDump.ps1
      - ContextInfo|contains: Invoke-NetRipper.ps1
      - ContextInfo|contains: Invoke-NetworkRelay.ps1
      - ContextInfo|contains: Invoke-NinjaCopy.ps1
      - ContextInfo|contains: Invoke-OxidResolver.ps1
      - ContextInfo|contains: Invoke-P0wnedshell.ps1
      - ContextInfo|contains: Invoke-P0wnedshellx86.ps1
      - ContextInfo|contains: Invoke-Paranoia.ps1
      - ContextInfo|contains: Invoke-PortScan.ps1
      - ContextInfo|contains: Invoke-PoshRatHttp.ps1
      - ContextInfo|contains: Invoke-PoshRatHttps.ps1
      - ContextInfo|contains: Invoke-PostExfil.ps1
      - ContextInfo|contains: Invoke-PowerDump.ps1
      - ContextInfo|contains: Invoke-PowerShellIcmp.ps1
      - ContextInfo|contains: Invoke-PowerShellTCP.ps1
      - ContextInfo|contains: Invoke-PowerShellTcpOneLine.ps1
      - ContextInfo|contains: Invoke-PowerShellTcpOneLineBind.ps1
      - ContextInfo|contains: Invoke-PowerShellUdp.ps1
      - ContextInfo|contains: Invoke-PowerShellUdpOneLine.ps1
      - ContextInfo|contains: Invoke-PowerShellWMI.ps1
      - ContextInfo|contains: Invoke-PowerThIEf.ps1
      - ContextInfo|contains: Invoke-PPLDump.ps1
      - ContextInfo|contains: Invoke-Prasadhak.ps1
      - ContextInfo|contains: Invoke-PsExec.ps1
      - ContextInfo|contains: Invoke-PsGcat.ps1
      - ContextInfo|contains: Invoke-PsGcatAgent.ps1
      - ContextInfo|contains: Invoke-PSInject.ps1
      - ContextInfo|contains: Invoke-PsUaCme.ps1
      - ContextInfo|contains: Invoke-ReflectivePEInjection.ps1
      - ContextInfo|contains: Invoke-ReverseDNSLookup.ps1
      - ContextInfo|contains: Invoke-Rubeus.ps1
      - ContextInfo|contains: Invoke-RunAs.ps1
      - ContextInfo|contains: Invoke-SafetyKatz.ps1
      - ContextInfo|contains: Invoke-SauronEye.ps1
      - ContextInfo|contains: Invoke-SCShell.ps1
      - ContextInfo|contains: Invoke-Seatbelt.ps1
      - ContextInfo|contains: Invoke-ServiceAbuse.ps1
      - ContextInfo|contains: Invoke-SessionGopher.ps1
      - ContextInfo|contains: Invoke-ShellCode.ps1
      - ContextInfo|contains: Invoke-SMBScanner.ps1
      - ContextInfo|contains: Invoke-Snaffler.ps1
      - ContextInfo|contains: Invoke-Spoolsample.ps1
      - ContextInfo|contains: Invoke-SSHCommand.ps1
      - ContextInfo|contains: Invoke-SSIDExfil.ps1
      - ContextInfo|contains: Invoke-StandIn.ps1
      - ContextInfo|contains: Invoke-StickyNotesExtract.ps1
      - ContextInfo|contains: Invoke-Tater.ps1
      - ContextInfo|contains: Invoke-Thunderfox.ps1
      - ContextInfo|contains: Invoke-ThunderStruck.ps1
      - ContextInfo|contains: Invoke-TokenManipulation.ps1
      - ContextInfo|contains: Invoke-Tokenvator.ps1
      - ContextInfo|contains: Invoke-TotalExec.ps1
      - ContextInfo|contains: Invoke-UrbanBishop.ps1
      - ContextInfo|contains: Invoke-UserHunter.ps1
      - ContextInfo|contains: Invoke-VoiceTroll.ps1
      - ContextInfo|contains: Invoke-Whisker.ps1
      - ContextInfo|contains: Invoke-WinEnum.ps1
      - ContextInfo|contains: Invoke-winPEAS.ps1
      - ContextInfo|contains: Invoke-WireTap.ps1
      - ContextInfo|contains: Invoke-WmiCommand.ps1
      - ContextInfo|contains: Invoke-WScriptBypassUAC.ps1
      - ContextInfo|contains: Invoke-Zerologon.ps1
      - ContextInfo|contains: Keylogger.ps1
      - ContextInfo|contains: MailRaider.ps1
      - ContextInfo|contains: New-HoneyHash.ps1
      - ContextInfo|contains: OfficeMemScraper.ps1
      - ContextInfo|contains: Offline_Winpwn.ps1
      - ContextInfo|contains: Out-CHM.ps1
      - ContextInfo|contains: Out-DnsTxt.ps1
      - ContextInfo|contains: Out-Excel.ps1
      - ContextInfo|contains: Out-HTA.ps1
      - ContextInfo|contains: Out-Java.ps1
      - ContextInfo|contains: Out-JS.ps1
      - ContextInfo|contains: Out-Minidump.ps1
      - ContextInfo|contains: Out-RundllCommand.ps1
      - ContextInfo|contains: Out-SCF.ps1
      - ContextInfo|contains: Out-SCT.ps1
      - ContextInfo|contains: Out-Shortcut.ps1
      - ContextInfo|contains: Out-WebQuery.ps1
      - ContextInfo|contains: Out-Word.ps1
      - ContextInfo|contains: Parse_Keys.ps1
      - ContextInfo|contains: Port-Scan.ps1
      - ContextInfo|contains: PowerBreach.ps1
      - ContextInfo|contains: powercat.ps1
      - ContextInfo|contains: PowerRunAsSystem.psm1
      - ContextInfo|contains: PowerSharpPack.ps1
      - ContextInfo|contains: PowerUp.ps1
      - ContextInfo|contains: PowerUpSQL.ps1
      - ContextInfo|contains: PowerView.ps1
      - ContextInfo|contains: PSAsyncShell.ps1
      - ContextInfo|contains: RemoteHashRetrieval.ps1
      - ContextInfo|contains: Remove-Persistence.ps1
      - ContextInfo|contains: Remove-PoshRat.ps1
      - ContextInfo|contains: Remove-Update.ps1
      - ContextInfo|contains: Run-EXEonRemote.ps1
      - ContextInfo|contains: Schtasks-Backdoor.ps1
      - ContextInfo|contains: Set-DCShadowPermissions.ps1
      - ContextInfo|contains: Set-MacAttribute.ps1
      - ContextInfo|contains: Set-RemotePSRemoting.ps1
      - ContextInfo|contains: Set-RemoteWMI.ps1
      - ContextInfo|contains: Set-Wallpaper.ps1
      - ContextInfo|contains: Show-TargetScreen.ps1
      - ContextInfo|contains: Speak.ps1
      - ContextInfo|contains: Start-CaptureServer.ps1
      - ContextInfo|contains: Start-WebcamRecorder.ps1
      - ContextInfo|contains: StringToBase64.ps1
      - ContextInfo|contains: TexttoExe.ps1
      - ContextInfo|contains: VolumeShadowCopyTools.ps1
      - ContextInfo|contains: WinPwn.ps1
      - ContextInfo|contains: WSUSpendu.ps1
- selection_invoke_sharp:
  - and:
    - ContextInfo|contains: Invoke-Sharp
    - ContextInfo|contains: .ps1
- condition: 1 of selection_*
id: 41025fd7-0466-4650-a813-574aaacbe7f4
logsource:
  category: ps_module
  definition: 0ad03ef1-f21b-4a79-8ce8-e6900c54b65b
  product: windows
