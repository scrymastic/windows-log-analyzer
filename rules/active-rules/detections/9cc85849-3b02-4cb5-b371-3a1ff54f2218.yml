detection:
- selection_img:
  - and:
    - or:
      - Image|endswith: \curl.exe
      - OriginalFileName|==: curl.exe
- selection_ip:
  - and:
    - CommandLine|matches: ://[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}
- selection_http:
  - and:
    - CommandLine|contains: http
- selection_flag:
  - and:
    - or:
      - CommandLine|contains: ' -O'
      - CommandLine|contains: --remote-name
      - CommandLine|contains: --output
- filter_main_ext:
  - and:
    - or:
      - CommandLine|endswith: .bat
      - CommandLine|endswith: .bat"
      - CommandLine|endswith: .dat
      - CommandLine|endswith: .dat"
      - CommandLine|endswith: .dll
      - CommandLine|endswith: .dll"
      - CommandLine|endswith: .exe
      - CommandLine|endswith: .exe"
      - CommandLine|endswith: .gif
      - CommandLine|endswith: .gif"
      - CommandLine|endswith: .hta
      - CommandLine|endswith: .hta"
      - CommandLine|endswith: .jpeg
      - CommandLine|endswith: .jpeg"
      - CommandLine|endswith: .log
      - CommandLine|endswith: .log"
      - CommandLine|endswith: .msi
      - CommandLine|endswith: .msi"
      - CommandLine|endswith: .png
      - CommandLine|endswith: .png"
      - CommandLine|endswith: .ps1
      - CommandLine|endswith: .ps1"
      - CommandLine|endswith: .psm1
      - CommandLine|endswith: .psm1"
      - CommandLine|endswith: .vbe
      - CommandLine|endswith: .vbe"
      - CommandLine|endswith: .vbs
      - CommandLine|endswith: .vbs"
      - CommandLine|endswith: .bat'
      - CommandLine|endswith: .dat'
      - CommandLine|endswith: .dll'
      - CommandLine|endswith: .exe'
      - CommandLine|endswith: .gif'
      - CommandLine|endswith: .hta'
      - CommandLine|endswith: .jpeg'
      - CommandLine|endswith: .log'
      - CommandLine|endswith: .msi'
      - CommandLine|endswith: .png'
      - CommandLine|endswith: .ps1'
      - CommandLine|endswith: .psm1'
      - CommandLine|endswith: .vbe'
      - CommandLine|endswith: .vbs'
- condition: all of selection_* and not 1 of filter_main_*
id: 9cc85849-3b02-4cb5-b371-3a1ff54f2218
logsource:
  category: process_creation
  product: windows
