detection:
- selection:
  - and:
    - EventType|==: DeleteKey
    - TargetObject|endswith: \shell\open\command
- filter_svchost:
  - and:
    - Image|==: C:\Windows\system32\svchost.exe
- filter_office:
  - and:
    - or:
      - Image|startswith: C:\Program Files\Common Files\Microsoft Shared\ClickToRun\
      - Image|startswith: C:\Program Files\Common Files\Microsoft Shared\ClickToRun\Updates\
    - Image|endswith: \OfficeClickToRun.exe
- filter_integrator:
  - and:
    - Image|==: C:\Program Files (x86)\Microsoft Office\root\integration\integrator.exe
- filter_dropbox:
  - and:
    - Image|endswith: \Dropbox.exe
    - TargetObject|contains: \Dropbox.
- filter_wireshark:
  - and:
    - Image|endswith: \AppData\Local\Temp\Wireshark_uninstaller.exe
    - TargetObject|contains: \wireshark-capture-file\
- filter_opera:
  - and:
    - or:
      - Image|startswith: C:\Program Files\Opera\
      - Image|startswith: C:\Program Files (x86)\Opera\
    - Image|endswith: \installer.exe
- filter_peazip:
  - and:
    - Image|contains: peazip
    - TargetObject|contains: \PeaZip.
- filter_everything:
  - and:
    - Image|endswith: \Everything.exe
    - TargetObject|contains: \Everything.
- filter_uninstallers:
  - and:
    - Image|startswith: C:\Windows\Installer\MSI
- filter_java:
  - and:
    - Image|startswith: C:\Program Files (x86)\Java\
    - Image|endswith: \installer.exe
    - TargetObject|contains: \Classes\WOW6432Node\CLSID\{4299124F-F2C3-41b4-9C73-9236B2AD0E8F}
- condition: selection and not 1 of filter_*
id: 96f697b0-b499-4e5d-9908-a67bec11cdb6
logsource:
  category: registry_delete
  product: windows
