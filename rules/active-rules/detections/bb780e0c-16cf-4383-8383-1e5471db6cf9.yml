detection:
- and:
  - or:
    - or:
      - Image|endswith: \powershell.exe
      - Image|endswith: \pwsh.exe
    - or:
      - OriginalFileName|==: PowerShell.EXE
      - OriginalFileName|==: pwsh.dll
    - Description|==: Windows PowerShell
    - Product|==: PowerShell Core 6
  - CommandLine|contains: bxor
  - or:
    - CommandLine|contains: ForEach
    - CommandLine|contains: for(
    - CommandLine|contains: 'for '
    - CommandLine|contains: '-join '
    - CommandLine|contains: -join'
    - CommandLine|contains: -join"
    - CommandLine|contains: -join`
    - CommandLine|contains: ::Join
    - CommandLine|contains: '[char]'
id: bb780e0c-16cf-4383-8383-1e5471db6cf9
