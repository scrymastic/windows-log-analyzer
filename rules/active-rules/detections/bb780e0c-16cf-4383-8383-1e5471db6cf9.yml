detection:
- selection_img:
  - and:
    - or:
      - or:
        - Image|endswith: \powershell.exe
        - Image|endswith: \pwsh.exe
      - or:
        - OriginalFileName|==: PowerShell.EXE
        - OriginalFileName|==: pwsh.dll
      - Description|==: Windows PowerShell
      - Product|==: PowerShell Core 6
- selection_cli_xor:
  - and:
    - CommandLine|contains: bxor
- selection_cli_other:
  - and:
    - or:
      - CommandLine|contains: ForEach
      - CommandLine|contains: for(
      - CommandLine|contains: 'for '
      - CommandLine|contains: '-join '
      - CommandLine|contains: -join'
      - CommandLine|contains: -join"
      - CommandLine|contains: -join`
      - CommandLine|contains: ::Join
      - CommandLine|contains: '[char]'
- condition: all of selection_*
id: bb780e0c-16cf-4383-8383-1e5471db6cf9
logsource:
  category: process_creation
  product: windows
