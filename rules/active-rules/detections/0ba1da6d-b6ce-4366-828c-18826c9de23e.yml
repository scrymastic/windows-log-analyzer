detection:
- selection:
  - and:
    - or:
      - Description|==: Execute processes remotely
      - Product|==: Sysinternals PsExec
      - or:
        - Description|startswith: Windows PowerShell
        - Description|startswith: pwsh
      - or:
        - OriginalFileName|==: certutil.exe
        - OriginalFileName|==: cmstp.exe
        - OriginalFileName|==: cscript.exe
        - OriginalFileName|==: mshta.exe
        - OriginalFileName|==: msiexec.exe
        - OriginalFileName|==: powershell_ise.exe
        - OriginalFileName|==: powershell.exe
        - OriginalFileName|==: psexec.c
        - OriginalFileName|==: psexec.exe
        - OriginalFileName|==: psexesvc.exe
        - OriginalFileName|==: pwsh.dll
        - OriginalFileName|==: reg.exe
        - OriginalFileName|==: regsvr32.exe
        - OriginalFileName|==: rundll32.exe
        - OriginalFileName|==: WerMgr
        - OriginalFileName|==: wmic.exe
        - OriginalFileName|==: wscript.exe
- filter:
  - and:
    - or:
      - Image|endswith: \certutil.exe
      - Image|endswith: \cmstp.exe
      - Image|endswith: \cscript.exe
      - Image|endswith: \mshta.exe
      - Image|endswith: \msiexec.exe
      - Image|endswith: \powershell_ise.exe
      - Image|endswith: \powershell.exe
      - Image|endswith: \psexec.exe
      - Image|endswith: \psexec64.exe
      - Image|endswith: \PSEXESVC.exe
      - Image|endswith: \pwsh.exe
      - Image|endswith: \reg.exe
      - Image|endswith: \regsvr32.exe
      - Image|endswith: \rundll32.exe
      - Image|endswith: \wermgr.exe
      - Image|endswith: \wmic.exe
      - Image|endswith: \wscript.exe
- condition: selection and not filter
id: 0ba1da6d-b6ce-4366-828c-18826c9de23e
logsource:
  category: process_creation
  product: windows
