author: Nasreddine Bencherchali (Nextron Systems)
date: 2023/04/17
description: 'Detects usage of winget to add a new insecure (http) download source.

  Winget will not allow the addition of insecure sources, hence this could indicate
  potential suspicious activity (or typos)

  '
falsepositives:
- False positives might occur if the users are unaware of such control checks
filename: proc_creation_win_winget_add_insecure_custom_source.yml
level: high
logsource:
  category: process_creation
  product: windows
modified: ''
references:
- https://learn.microsoft.com/en-us/windows/package-manager/winget/source
- https://github.com/nasbench/Misc-Research/tree/b9596e8109dcdb16ec353f316678927e507a5b8d/LOLBINs/Winget
related:
- id: 05ebafc8-7aa2-4bcd-a269-2aec93f9e842
  type: similar
- id: c15a46a0-07d4-4c87-b4b6-89207835a83b
  type: similar
status: test
tags:
- attack.defense_evasion
- attack.execution
- attack.t1059
