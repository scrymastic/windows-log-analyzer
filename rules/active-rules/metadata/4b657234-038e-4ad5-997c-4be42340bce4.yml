author: Kamran Saifullah
date: 2023/11/20
description: 'Detects network connections to Visual Studio Code tunnel domains initiated
  by a process on a system. Attackers can abuse that feature to establish a reverse
  shell or persistence on a machine.

  '
falsepositives:
- Legitimate use of Visual Studio Code tunnel will also trigger this.
filename: net_connection_win_vscode_tunnel_connection.yml
level: medium
modified: ''
references:
- https://ipfyx.fr/post/visual-studio-code-tunnel/
- https://badoption.eu/blog/2023/01/31/code_c2.html
- https://cydefops.com/vscode-data-exfiltration
related:
- id: 9501f8e6-8e3d-48fc-a8a6-1089dd5d7ef4
  type: similar
- id: b3e6418f-7c7a-4fad-993a-93b65027a9f1
  type: similar
- id: 1cb0c6ce-3d00-44fc-ab9c-6d6d577bf20b
  type: similar
status: experimental
tags:
- attack.exfiltration
- attack.t1567.001
