author: citron_ninja
date: 2023/10/25
description: 'Detects DNS query requests to Visual Studio Code tunnel domains. Attackers
  can abuse that feature to establish a reverse shell or persistence on a machine.

  '
falsepositives:
- Legitimate use of Visual Studio Code tunnel will also trigger this.
filename: dns_query_win_vscode_tunnel_communication.yml
level: medium
logsource:
  category: dns_query
  product: windows
modified: 2023/11/20
references:
- https://ipfyx.fr/post/visual-studio-code-tunnel/
- https://badoption.eu/blog/2023/01/31/code_c2.html
- https://cydefops.com/vscode-data-exfiltration
related:
- id: 9501f8e6-8e3d-48fc-a8a6-1089dd5d7ef4
  type: similar
- id: 4b657234-038e-4ad5-997c-4be42340bce4
  type: similar
- id: 1cb0c6ce-3d00-44fc-ab9c-6d6d577bf20b
  type: similar
status: experimental
tags:
- attack.command_and_control
- attack.t1071.001
