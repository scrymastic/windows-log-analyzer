author: Florian Roth (Nextron Systems), Nasreddine Bencherchali (Nextron Systems)
date: 2018/08/30
description: Detects executables located in potentially suspicious directories initiating
  network connections towards file sharing domains.
falsepositives:
- Some installers located in the temp directory might communicate with the Github
  domains in order to download additional software. Baseline these cases or move the
  github domain to a lower level hunting rule.
filename: net_connection_win_susp_file_sharing_domains_susp_folders.yml
level: high
logsource:
  category: network_connection
  product: windows
modified: 2024/02/09
references:
- https://twitter.com/M_haggis/status/900741347035889665
- https://twitter.com/M_haggis/status/1032799638213066752
- https://symantec-enterprise-blogs.security.com/blogs/threat-intelligence/ransomware-hive-conti-avoslocker
- https://www.cisa.gov/uscert/ncas/alerts/aa22-321a
- https://github.com/EmpireProject/Empire/blob/e37fb2eef8ff8f5a0a689f1589f424906fe13055/data/module_source/exfil/Invoke-ExfilDataToGitHub.ps1
related:
- id: 635dbb88-67b3-4b41-9ea5-a3af2dd88153
  type: obsoletes
status: test
tags:
- attack.command_and_control
- attack.t1105
