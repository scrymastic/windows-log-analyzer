author: Austin Songer
date: 2021/07/22
description: 'Detects when a user enables DNS-over-HTTPS.

  This can be used to hide internet activity or be used to hide the process of exfiltrating
  data.

  With this enabled organization will lose visibility into data such as query type,
  response and originating IP that are used to determine bad actors.

  '
falsepositives:
- Unlikely
filename: registry_set_dns_over_https_enabled.yml
level: medium
logsource:
  category: registry_set
  product: windows
modified: 2023/08/17
references:
- https://www.tenforums.com/tutorials/151318-how-enable-disable-dns-over-https-doh-microsoft-edge.html
- https://github.com/elastic/detection-rules/issues/1371
- https://chromeenterprise.google/policies/?policy=DnsOverHttpsMode
- https://admx.help/HKLM/Software/Policies/Mozilla/Firefox/DNSOverHTTPS
related: []
status: test
tags:
- attack.defense_evasion
- attack.t1140
- attack.t1112
