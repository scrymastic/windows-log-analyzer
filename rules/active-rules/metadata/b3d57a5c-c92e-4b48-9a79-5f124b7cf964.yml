author: Nasreddine Bencherchali (Nextron Systems)
date: 2022/07/13
description: Detects when the a stored procedure is set or cleared for automatic execution
  in MSSQL. A stored procedure that is set to automatic execution runs every time
  an instance of SQL Server is started
falsepositives:
- Legitimate use of the feature by administrators (rare)
level: high
references:
- https://www.netspi.com/blog/technical/network-penetration-testing/sql-server-persistence-part-1-startup-stored-procedures/
- https://docs.microsoft.com/en-us/sql/relational-databases/system-stored-procedures/sp-procoption-transact-sql?view=sql-server-ver16
status: test
tags:
- attack.persistence
title: MSSQL SPProcoption Set
