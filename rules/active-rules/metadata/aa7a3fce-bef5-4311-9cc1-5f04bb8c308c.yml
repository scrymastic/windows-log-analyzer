author: Florian Roth (Nextron Systems)
date: 2021/04/23
description: Detects calls to cmdlets inside of PowerShell scripts that are used to
  export certificates from the local certificate store. Threat actors were seen abusing
  this to steal private keys from compromised machines.
falsepositives:
- Legitimate certificate exports by administrators. Additional filters might be required.
filename: posh_ps_export_certificate.yml
level: medium
modified: 2023/05/18
references:
- https://us-cert.cisa.gov/ncas/analysis-reports/ar21-112a
- https://docs.microsoft.com/en-us/powershell/module/pki/export-pfxcertificate
- https://www.splunk.com/en_us/blog/security/breaking-the-chain-defending-against-certificate-services-abuse.html
related:
- id: 9e716b33-63b2-46da-86a4-bd3c3b9b5dfb
  type: similar
status: test
tags:
- attack.credential_access
- attack.t1552.004
