author: Nasreddine Bencherchali (Nextron Systems)
date: 2022/07/12
description: 'Detects execution of the "mofcomp" utility as a child of a suspicious
  shell or script running utility or by having a suspicious path in the commandline.

  The "mofcomp" utility parses a file containing MOF statements and adds the classes
  and class instances defined in the file to the WMI repository.

  Attackers abuse this utility to install malicious MOF scripts

  '
falsepositives:
- Unknown
filename: proc_creation_win_mofcomp_execution.yml
level: high
logsource:
  category: process_creation
  product: windows
modified: 2023/04/11
references:
- https://thedfirreport.com/2022/07/11/select-xmrig-from-sqlserver/
- https://github.com/The-DFIR-Report/Sigma-Rules/blob/75260568a7ffe61b2458ca05f6f25914efb44337/win_mofcomp_execution.yml
- https://docs.microsoft.com/en-us/windows/win32/wmisdk/mofcomp
related: []
status: test
tags:
- attack.defense_evasion
- attack.t1218
