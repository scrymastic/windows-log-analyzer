author: Nasreddine Bencherchali (Nextron Systems)
date: 2022/10/17
description: 'Detects file access requests to the the Windows Data Protection API
  Master keys by an uncommon application.

  This can be a sign of credential stealing. Example case would be usage of mimikatz
  "dpapi::masterkey" function

  '
falsepositives:
- Unknown
filename: file_access_win_dpapi_master_key_access.yml
level: medium
logsource:
  category: file_access
  definition: 'Requirements: Microsoft-Windows-Kernel-File ETW provider'
  product: windows
modified: 2023/12/18
references:
- http://blog.harmj0y.net/redteaming/operational-guidance-for-offensive-user-dpapi-abuse/
- https://book.hacktricks.xyz/windows-hardening/windows-local-privilege-escalation/dpapi-extracting-passwords
related: []
status: experimental
tags:
- attack.credential_access
- attack.t1555.004
