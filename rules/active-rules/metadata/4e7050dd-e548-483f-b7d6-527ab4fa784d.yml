author: Florian Roth (Nextron Systems)
date: 2022/03/11
description: Detects creation of a file named "ntds.dit" (Active Directory Database)
  by an uncommon parent process or directory
falsepositives:
- Unknown
filename: file_event_win_ntds_dit_uncommon_parent_process.yml
level: high
logsource:
  category: file_event
  definition: 'Requirements: The "ParentImage" field is not available by default on
    EID 11 of Sysmon logs. To be able to use this rule to the full extent you need
    to enrich the log with additional ParentImage data'
  product: windows
modified: 2023/01/05
references:
- https://www.ired.team/offensive-security/credential-access-and-credential-dumping/ntds.dit-enumeration
- https://www.n00py.io/2022/03/manipulating-user-passwords-without-mimikatz/
- https://pentestlab.blog/tag/ntds-dit/
- https://github.com/samratashok/nishang/blob/414ee1104526d7057f9adaeee196d91ae447283e/Gather/Copy-VSS.ps1
related:
- id: 11b1ed55-154d-4e82-8ad7-83739298f720
  type: similar
status: test
tags:
- attack.credential_access
- attack.t1003.003
