author: Hai Vaknin @LuxNoBulIshit, Avihay eldad  @aloneliassaf, Austin Songer @austinsonger
date: 2021/09/30
description: Detects when a possible suspicious driver is being installed via pnputil.exe
  lolbin
falsepositives:
- Pnputil.exe being used may be performed by a system administrator.
- Verify whether the user identity, user agent, and/or hostname should be making changes
  in your environment.
- Pnputil.exe being executed from unfamiliar users should be investigated. If known
  behavior is causing false positives, it can be exempted from the rule.
filename: proc_creation_win_lolbin_susp_driver_installed_by_pnputil.yml
level: medium
modified: 2022/10/09
references:
- https://docs.microsoft.com/en-us/windows-hardware/drivers/devtest/pnputil-command-syntax
- https://strontic.github.io/xcyclopedia/library/pnputil.exe-60EDC5E6BDBAEE441F2E3AEACD0340D2.html
related: []
status: test
tags:
- attack.persistence
- attack.t1547
