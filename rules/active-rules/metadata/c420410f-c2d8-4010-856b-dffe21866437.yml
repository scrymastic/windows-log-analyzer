author: Nasreddine Bencherchali (Nextron Systems)
date: 2023/12/15
description: 'Detects changes to the "NoLMHash" registry value in order to allow Windows
  to store LM Hashes.

  By setting this registry value to "0" (DWORD), Windows will be allowed to store
  a LAN manager hash of your password in Active Directory and local SAM databases.

  '
falsepositives:
- Unknown
filename: registry_set_system_lsa_nolmhash.yml
level: high
logsource:
  category: registry_set
  product: windows
modified: ''
references:
- https://www.cisa.gov/news-events/cybersecurity-advisories/aa23-347a
- https://learn.microsoft.com/en-us/troubleshoot/windows-server/windows-security/prevent-windows-store-lm-hash-password
- https://www.sans.org/blog/protecting-privileged-domain-accounts-lm-hashes-the-good-the-bad-and-the-ugly/
related:
- id: 98dedfdd-8333-49d4-9f23-d7018cccae53
  type: similar
status: experimental
tags:
- attack.defense_evasion
- attack.t1112
