author: bartblaze
date: 2020/07/13
description: 'Detects dllhost initiating a network connection to a non-local IP address.

  Aside from Microsoft own IP range that needs to be excluded. Network communication
  from Dllhost will depend entirely on the hosted DLL.

  An initial baseline is recommended before deployment.

  '
falsepositives:
- Communication to other corporate systems that use IP addresses from public address
  spaces
filename: net_connection_win_dllhost_non_local_ip.yml
level: medium
logsource:
  category: network_connection
  product: windows
modified: 2024/03/12
references:
- https://redcanary.com/blog/child-processes/
- https://nasbench.medium.com/what-is-the-dllhost-exe-process-actually-running-ef9fe4c19c08
related: []
status: test
tags:
- attack.defense_evasion
- attack.t1218
- attack.execution
- attack.t1559.001
