title: Suspicious File Created In PerfLogs
id: bbb7e38c-0b41-4a11-b306-d2a457b7ac2b
status: test
description: Detects suspicious file based on their extension being created in "C:\PerfLogs\".
  Note that this directory mostly contains ".etl" files
references:
- Internal Research
- https://labs.withsecure.com/publications/fin7-target-veeam-servers
author: Nasreddine Bencherchali (Nextron Systems)
date: 2023/05/05
tags:
- attack.execution
- attack.t1059
logsource:
  category: file_event
  product: windows
detection:
- selection:
  - and:
    - TargetFilename|startswith: C:\PerfLogs\
    - or:
      - TargetFilename|endswith: .7z
      - TargetFilename|endswith: .bat
      - TargetFilename|endswith: .bin
      - TargetFilename|endswith: .chm
      - TargetFilename|endswith: .dll
      - TargetFilename|endswith: .exe
      - TargetFilename|endswith: .hta
      - TargetFilename|endswith: .lnk
      - TargetFilename|endswith: .ps1
      - TargetFilename|endswith: .psm1
      - TargetFilename|endswith: .py
      - TargetFilename|endswith: .scr
      - TargetFilename|endswith: .sys
      - TargetFilename|endswith: .vbe
      - TargetFilename|endswith: .vbs
      - TargetFilename|endswith: .zip
- condition: selection
falsepositives:
- Unlikely
level: medium
