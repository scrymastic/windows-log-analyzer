title: Access To Potentially Sensitive Sysvol Files By Uncommon Application
id: d51694fe-484a-46ac-92d6-969e76d60d10
related:
- id: 8344c19f-a023-45ff-ad63-a01c5396aea0
  type: derived
status: experimental
description: Detects file access requests to potentially sensitive files hosted on
  the Windows Sysvol share.
references:
- https://github.com/vletoux/pingcastle
author: frack113
date: 2023/12/21
tags:
- attack.credential_access
- attack.t1552.006
logsource:
  category: file_access
  product: windows
  definition: 'Requirements: Microsoft-Windows-Kernel-File ETW provider'
detection:
- selection:
  - and:
    - FileName|startswith: \\
    - FileName|contains: \sysvol\
    - FileName|contains: \Policies\
    - or:
      - FileName|endswith: audit.csv
      - FileName|endswith: Files.xml
      - FileName|endswith: GptTmpl.inf
      - FileName|endswith: groups.xml
      - FileName|endswith: Registry.pol
      - FileName|endswith: Registry.xml
      - FileName|endswith: scheduledtasks.xml
      - FileName|endswith: scripts.ini
      - FileName|endswith: services.xml
- filter_main_generic:
  - and:
    - or:
      - Image|startswith: :\Program Files (x86)\
      - Image|startswith: :\Program Files\
      - Image|startswith: :\Windows\explorer.exe
      - Image|startswith: :\Windows\system32\
      - Image|startswith: :\Windows\SysWOW64\
- condition: selection and not 1 of filter_main_*
falsepositives:
- Unknown
level: medium
