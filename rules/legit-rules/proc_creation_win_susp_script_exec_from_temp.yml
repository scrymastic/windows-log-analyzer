title: Suspicious Script Execution From Temp Folder
id: a6a39bdb-935c-4f0a-ab77-35f4bbf44d33
status: test
description: Detects a suspicious script executions from temporary folder
references:
- https://www.microsoft.com/security/blog/2021/07/13/microsoft-discovers-threat-actor-targeting-solarwinds-serv-u-software-with-0-day-exploit/
author: Florian Roth (Nextron Systems), Max Altgelt (Nextron Systems), Tim Shelton
date: 2021/07/14
modified: 2022/10/05
tags:
- attack.execution
- attack.t1059
logsource:
  category: process_creation
  product: windows
detection:
- and:
  - or:
    - Image|endswith: \powershell.exe
    - Image|endswith: \pwsh.exe
    - Image|endswith: \mshta.exe
    - Image|endswith: \wscript.exe
    - Image|endswith: \cscript.exe
  - or:
    - CommandLine|contains: \Windows\Temp
    - CommandLine|contains: \Temporary Internet
    - CommandLine|contains: \AppData\Local\Temp
    - CommandLine|contains: \AppData\Roaming\Temp
    - CommandLine|contains: '%TEMP%'
    - CommandLine|contains: '%TMP%'
    - CommandLine|contains: '%LocalAppData%\Temp'
falsepositives:
- Administrative scripts
level: high
