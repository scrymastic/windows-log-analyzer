title: AADInternals PowerShell Cmdlets Execution - ProccessCreation
id: c86500e9-a645-4680-98d7-f882c70c1ea3
related:
- id: 91e69562-2426-42ce-a647-711b8152ced6
  type: similar
status: test
description: Detects ADDInternals Cmdlet execution. A tool for administering Azure
  AD and Office 365. Which can be abused by threat actors to attack Azure AD or Office
  365.
references:
- https://o365blog.com/aadinternals/
- https://github.com/Gerenios/AADInternals
author: Austin Songer (@austinsonger), Nasreddine Bencherchali (Nextron Systems)
date: 2022/12/23
tags:
- attack.execution
- attack.reconnaissance
- attack.discovery
- attack.credential_access
- attack.impact
logsource:
  product: windows
  category: process_creation
detection:
- selection_img:
  - and:
    - or:
      - or:
        - Image|endswith: \powershell.exe
        - Image|endswith: \pwsh.exe
      - or:
        - OriginalFileName|==: PowerShell.Exe
        - OriginalFileName|==: pwsh.dll
- selection_cli:
  - and:
    - or:
      - CommandLine|contains: Add-AADInt
      - CommandLine|contains: ConvertTo-AADInt
      - CommandLine|contains: Disable-AADInt
      - CommandLine|contains: Enable-AADInt
      - CommandLine|contains: Export-AADInt
      - CommandLine|contains: Get-AADInt
      - CommandLine|contains: Grant-AADInt
      - CommandLine|contains: Install-AADInt
      - CommandLine|contains: Invoke-AADInt
      - CommandLine|contains: Join-AADInt
      - CommandLine|contains: New-AADInt
      - CommandLine|contains: Open-AADInt
      - CommandLine|contains: Read-AADInt
      - CommandLine|contains: Register-AADInt
      - CommandLine|contains: Remove-AADInt
      - CommandLine|contains: Restore-AADInt
      - CommandLine|contains: Search-AADInt
      - CommandLine|contains: Send-AADInt
      - CommandLine|contains: Set-AADInt
      - CommandLine|contains: Start-AADInt
      - CommandLine|contains: Update-AADInt
- condition: all of selection_*
falsepositives:
- Legitimate use of the library for administrative activity
level: high
