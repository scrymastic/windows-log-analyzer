title: Potential Suspicious Winget Package Installation
id: a3f5c081-e75b-43a0-9f5b-51f26fe5dba2
status: test
description: Detects potential suspicious winget package installation from a suspicious
  source.
references:
- https://github.com/nasbench/Misc-Research/tree/b9596e8109dcdb16ec353f316678927e507a5b8d/LOLBINs/Winget
author: Nasreddine Bencherchali (Nextron Systems)
date: 2023/04/18
tags:
- attack.defense_evasion
- attack.persistence
logsource:
  product: windows
  category: create_stream_hash
detection:
- and:
  - Contents|startswith: '[ZoneTransfer]  ZoneId=3'
  - or:
    - Contents|contains: ://1
    - Contents|contains: ://2
    - Contents|contains: ://3
    - Contents|contains: ://4
    - Contents|contains: ://5
    - Contents|contains: ://6
    - Contents|contains: ://7
    - Contents|contains: ://8
    - Contents|contains: ://9
  - TargetFilename|endswith: :Zone.Identifier
  - TargetFilename|contains: \AppData\Local\Temp\WinGet\
falsepositives:
- Unknown
level: high
