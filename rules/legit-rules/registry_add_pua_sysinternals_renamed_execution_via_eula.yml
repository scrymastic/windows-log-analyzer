title: Suspicious Execution Of Renamed Sysinternals Tools - Registry
id: f50f3c09-557d-492d-81db-9064a8d4e211
related:
- id: 25ffa65d-76d8-4da5-a832-3f2b0136e133
  type: derived
- id: 8023f872-3f1d-4301-a384-801889917ab4
  type: similar
status: test
description: Detects the creation of the "accepteula" key related to the Sysinternals
  tools being created from executables with the wrong name (e.g. a renamed Sysinternals
  tool)
references:
- Internal Research
author: Nasreddine Bencherchali (Nextron Systems)
date: 2022/08/24
modified: 2023/02/07
tags:
- attack.resource_development
- attack.t1588.002
logsource:
  product: windows
  category: registry_add
detection:
- selection:
  - and:
    - EventType|==: CreateKey
    - or:
      - TargetObject|contains: \Active Directory Explorer
      - TargetObject|contains: \Handle
      - TargetObject|contains: \LiveKd
      - TargetObject|contains: \ProcDump
      - TargetObject|contains: \Process Explorer
      - TargetObject|contains: \PsExec
      - TargetObject|contains: \PsLoggedon
      - TargetObject|contains: \PsLoglist
      - TargetObject|contains: \PsPasswd
      - TargetObject|contains: \PsPing
      - TargetObject|contains: \PsService
      - TargetObject|contains: \SDelete
    - TargetObject|endswith: \EulaAccepted
- filter:
  - and:
    - or:
      - Image|endswith: \ADExplorer.exe
      - Image|endswith: \ADExplorer64.exe
      - Image|endswith: \handle.exe
      - Image|endswith: \handle64.exe
      - Image|endswith: \livekd.exe
      - Image|endswith: \livekd64.exe
      - Image|endswith: \procdump.exe
      - Image|endswith: \procdump64.exe
      - Image|endswith: \procexp.exe
      - Image|endswith: \procexp64.exe
      - Image|endswith: \PsExec.exe
      - Image|endswith: \PsExec64.exe
      - Image|endswith: \PsLoggedon.exe
      - Image|endswith: \PsLoggedon64.exe
      - Image|endswith: \psloglist.exe
      - Image|endswith: \psloglist64.exe
      - Image|endswith: \pspasswd.exe
      - Image|endswith: \pspasswd64.exe
      - Image|endswith: \PsPing.exe
      - Image|endswith: \PsPing64.exe
      - Image|endswith: \PsService.exe
      - Image|endswith: \PsService64.exe
      - Image|endswith: \sdelete.exe
- condition: selection and not filter
falsepositives:
- Unlikely
level: high
