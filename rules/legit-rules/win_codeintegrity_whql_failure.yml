title: CodeIntegrity - Unmet WHQL Requirements For Loaded Kernel Module
id: 2f8cd7a0-9d5a-4f62-9f8b-2c951aa0dd1f
status: experimental
description: Detects loaded kernel modules that did not meet the WHQL signing requirements.
references:
- https://learn.microsoft.com/en-us/windows/security/threat-protection/windows-defender-application-control/event-id-explanations
- https://learn.microsoft.com/en-us/windows/security/threat-protection/windows-defender-application-control/event-tag-explanations
- Internal Research
author: Nasreddine Bencherchali (Nextron Systems)
date: 2023/06/06
modified: 2023/06/14
tags:
- attack.privilege_escalation
logsource:
  product: windows
  service: codeintegrity-operational
detection:
- and:
  - or:
    - EventID|==: 3082
    - EventID|==: 3083
  - FileNameBuffer|!==: system32\drivers\vsock.sys
  - FileNameBuffer|!==: System32\drivers\vmci.sys
falsepositives:
- Unlikely
level: high
