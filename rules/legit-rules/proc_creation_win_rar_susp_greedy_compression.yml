title: Suspicious Greedy Compression Using Rar.EXE
id: afe52666-401e-4a02-b4ff-5d128990b8cb
status: experimental
description: Detects RAR usage that creates an archive from a suspicious folder, either
  a system folder or one of the folders often used by attackers for staging purposes
references:
- https://decoded.avast.io/martinchlumecky/png-steganography
author: X__Junior (Nextron Systems), Florian Roth (Nextron Systems)
date: 2022/12/15
modified: 2024/01/02
tags:
- attack.execution
- attack.t1059
logsource:
  product: windows
  category: process_creation
detection:
- and:
  - or:
    - or:
      - Image|endswith: \rar.exe
      - Description|==: Command line RAR
  - or:
    - or:
      - CommandLine|contains: '.exe a '
      - CommandLine|contains: ' a -m'
  - or:
    - CommandLine|contains: ' -hp'
    - CommandLine|contains: ' -r '
  - or:
    - or:
      - CommandLine|contains: ' ?:\\\*.'
      - CommandLine|contains: ' ?:\\\\\*.'
      - CommandLine|contains: ' ?:\$Recycle.bin\'
      - CommandLine|contains: ' ?:\PerfLogs\'
      - CommandLine|contains: ' ?:\Temp'
      - CommandLine|contains: ' ?:\Users\Public\'
      - CommandLine|contains: ' ?:\Windows\'
      - CommandLine|contains: ' %public%'
falsepositives:
- Unknown
level: high
