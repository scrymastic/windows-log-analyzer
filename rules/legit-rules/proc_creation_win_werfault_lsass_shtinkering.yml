title: Potential Credential Dumping Via WER
id: 9a4ccd1a-3526-4d99-b980-9f9c5d3a6ff3
status: test
description: Detects potential credential dumping via Windows Error Reporting LSASS
  Shtinkering technique which uses the Windows Error Reporting to dump lsass
references:
- https://github.com/deepinstinct/Lsass-Shtinkering
- https://media.defcon.org/DEF%20CON%2030/DEF%20CON%2030%20presentations/Asaf%20Gilboa%20-%20LSASS%20Shtinkering%20Abusing%20Windows%20Error%20Reporting%20to%20Dump%20LSASS.pdf
author: '@pbssubhash , Nasreddine Bencherchali'
date: 2022/12/08
modified: 2022/12/09
tags:
- attack.credential_access
- attack.t1003.001
logsource:
  product: windows
  category: process_creation
detection:
- and:
  - or:
    - Image|endswith: \Werfault.exe
    - OriginalFileName|==: WerFault.exe
  - or:
    - ParentUser|contains: AUTHORI
    - ParentUser|contains: AUTORI
  - or:
    - User|contains: AUTHORI
    - User|contains: AUTORI
  - CommandLine|contains: ' -u -p '
  - CommandLine|contains: ' -ip '
  - CommandLine|contains: ' -s '
falsepositives:
- Windows Error Reporting might produce similar behavior. In that case, check the
  PID associated with the "-p" parameter in the CommandLine.
level: high
