title: Potential Dosfuscation Activity
id: a77c1610-fc73-4019-8e29-0f51efc04a51
status: test
description: Detects possible payload obfuscation via the commandline
references:
- https://www.fireeye.com/content/dam/fireeye-www/blog/pdfs/dosfuscation-report.pdf
- https://github.com/danielbohannon/Invoke-DOSfuscation
author: frack113, Nasreddine Bencherchali (Nextron Systems)
date: 2022/02/15
modified: 2023/03/06
tags:
- attack.execution
- attack.t1059
logsource:
  category: process_creation
  product: windows
detection:
- and:
  - or:
    - CommandLine|contains: ^^
    - CommandLine|contains: ^|^
    - CommandLine|contains: ',;,'
    - CommandLine|contains: ;;;;
    - CommandLine|contains: ;; ;;
    - CommandLine|contains: (,(,
    - CommandLine|contains: '%COMSPEC:~'
    - CommandLine|contains: ' c^m^d'
    - CommandLine|contains: ^c^m^d
    - CommandLine|contains: ' c^md'
    - CommandLine|contains: ' cm^d'
    - CommandLine|contains: ^cm^d
    - CommandLine|contains: ' s^et '
    - CommandLine|contains: ' s^e^t '
    - CommandLine|contains: ' se^t '
falsepositives:
- Unknown
level: medium
