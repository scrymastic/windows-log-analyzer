title: Load Of RstrtMgr.DLL By An Uncommon Process
id: 3669afd2-9891-4534-a626-e5cf03810a61
related:
- id: b48492dc-c5ef-4572-8dff-32bc241c15c8
  type: derived
status: experimental
description: 'Detects the load of RstrtMgr DLL (Restart Manager) by an uncommon process.

  This library has been used during ransomware campaigns to kill processes that would
  prevent file encryption by locking them (e.g. Conti ransomware, Cactus ransomware).
  It has also recently been seen used by the BiBi wiper for Windows.

  It could also be used for anti-analysis purposes by shut downing specific processes.

  '
references:
- https://www.crowdstrike.com/blog/windows-restart-manager-part-1/
- https://www.crowdstrike.com/blog/windows-restart-manager-part-2/
- https://www.swascan.com/cactus-ransomware-malware-analysis/
- https://taiwan.postsen.com/business/88601/Hamas-hackers-use-data-destruction-software-BiBi-which-consumes-a-lot-of-processor-resources-to-wipe-Windows-computer-data--iThome.html
author: "Luc G\xE9naux"
date: 2023/11/28
tags:
- attack.impact
- attack.defense_evasion
- attack.t1486
- attack.t1562.001
logsource:
  category: image_load
  product: windows
detection:
- and:
  - or:
    - ImageLoaded|endswith: \RstrtMgr.dll
    - OriginalFileName|==: RstrtMgr.dll
  - Image|not contains: :\$WINDOWS.~BT\
  - Image|not contains: :\$WinREAgent\
  - Image|not contains: :\Program Files (x86)\
  - Image|not contains: :\Program Files\
  - Image|not contains: :\ProgramData\
  - Image|not contains: :\Windows\explorer.exe
  - Image|not contains: :\Windows\SoftwareDistribution\
  - Image|not contains: :\Windows\SysNative\
  - Image|not contains: :\Windows\System32\
  - Image|not contains: :\Windows\SysWOW64\
  - Image|not contains: :\Windows\WinSxS\
  - Image|not contains: :\WUDownloadCache\
  - or:
    - Image|not contains: :\Users\
    - Image|not contains: \AppData\Local\Temp\is-
    - Image|not contains: .tmp\
    - Image|not endswith: .tmp
  - or:
    - Image|not contains: :\Windows\Temp\
falsepositives:
- Other legitimate Windows processes not currently listed
- Processes related to software installation
level: low
