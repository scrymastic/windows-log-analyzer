title: Suspicious Serv-U Process Pattern
id: 58f4ea09-0fc2-4520-ba18-b85c540b0eaf
status: test
description: Detects a suspicious process pattern which could be a sign of an exploited
  Serv-U service
references:
- https://www.microsoft.com/security/blog/2021/07/13/microsoft-discovers-threat-actor-targeting-solarwinds-serv-u-software-with-0-day-exploit/
author: Florian Roth (Nextron Systems)
date: 2021/07/14
modified: 2022/07/14
tags:
- attack.credential_access
- attack.t1555
- cve.2021.35211
logsource:
  category: process_creation
  product: windows
detection:
- selection:
  - and:
    - ParentImage|endswith: \Serv-U.exe
    - or:
      - Image|endswith: \cmd.exe
      - Image|endswith: \powershell.exe
      - Image|endswith: \pwsh.exe
      - Image|endswith: \wscript.exe
      - Image|endswith: \cscript.exe
      - Image|endswith: \sh.exe
      - Image|endswith: \bash.exe
      - Image|endswith: \schtasks.exe
      - Image|endswith: \regsvr32.exe
      - Image|endswith: \wmic.exe
      - Image|endswith: \mshta.exe
      - Image|endswith: \rundll32.exe
      - Image|endswith: \msiexec.exe
      - Image|endswith: \forfiles.exe
      - Image|endswith: \scriptrunner.exe
- condition: selection
falsepositives:
- Legitimate uses in which users or programs use the SSH service of Serv-U for remote
  command execution
level: high
