title: New ODBC Driver Registered
id: 3390fbef-c98d-4bdd-a863-d65ed7c610dd
status: experimental
description: Detects the registration of a new ODBC driver.
references:
- https://www.hexacorn.com/blog/2020/08/23/odbcconf-lolbin-trifecta/
author: Nasreddine Bencherchali (Nextron Systems)
date: 2023/05/23
modified: 2023/08/17
tags:
- attack.persistence
logsource:
  category: registry_set
  product: windows
detection:
- and:
  - TargetObject|contains: \SOFTWARE\ODBC\ODBCINST.INI\
  - TargetObject|endswith: \Driver
  - or:
    - TargetObject|not contains: \SQL Server\
    - Details|!==: '%WINDIR%\System32\SQLSRV32.dll'
  - or:
    - TargetObject|not contains: '\Microsoft Access '
    - Details|not startswith: C:\Progra
    - Details|not endswith: \ACEODBC.DLL
  - or:
    - TargetObject|not contains: \Microsoft Excel Driver
    - Details|not startswith: C:\Progra
    - Details|not endswith: \ACEODBC.DLL
falsepositives:
- Likely
level: low
