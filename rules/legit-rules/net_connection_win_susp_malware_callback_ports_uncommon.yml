title: Communication To Uncommon Destination Ports
id: 6d8c3d20-a5e1-494f-8412-4571d716cf5c
related:
- id: 4b89abaa-99fe-4232-afdd-8f9aa4d20382
  type: similar
status: test
description: Detects programs that connect to uncommon destination ports
references:
- https://docs.google.com/spreadsheets/d/17pSTDNpa0sf6pHeRhusvWG6rThciE8CsXTSlDUAZDyo
author: Florian Roth (Nextron Systems)
date: 2017/03/19
modified: 2024/03/12
tags:
- attack.persistence
- attack.command_and_control
- attack.t1571
logsource:
  category: network_connection
  product: windows
detection:
- selection:
  - and:
    - Initiated|==: 'true'
    - or:
      - DestinationPort|==: 8080
      - DestinationPort|==: 8888
- filter_main_local_ranges:
  - and:
    - or:
      - DestinationIp|cidr: 127.0.0.0/8
      - DestinationIp|cidr: 10.0.0.0/8
      - DestinationIp|cidr: 172.16.0.0/12
      - DestinationIp|cidr: 192.168.0.0/16
      - DestinationIp|cidr: 169.254.0.0/16
      - DestinationIp|cidr: ::1/128
      - DestinationIp|cidr: fe80::/10
      - DestinationIp|cidr: fc00::/7
- filter_optional_sys_directories:
  - and:
    - or:
      - Image|startswith: C:\Program Files\
      - Image|startswith: C:\Program Files (x86)\
- condition: selection and not 1 of filter_main_* and not 1 of filter_optional_*
falsepositives:
- Unknown
level: medium
