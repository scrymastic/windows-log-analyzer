title: Suspicious Electron Application Child Processes
id: f26eb764-fd89-464b-85e2-dc4a8e6e77b8
related:
- id: 378a05d8-963c-46c9-bcce-13c7657eac99
  type: similar
status: experimental
description: 'Detects suspicious child processes of electron apps (teams, discord,
  slack, etc.). This could be a potential sign of ".asar" file tampering (See reference
  section for more information) or binary execution proxy through specific CLI arguments
  (see related rule)

  '
references:
- https://taggart-tech.com/quasar-electron/
- https://github.com/mttaggart/quasar
- https://positive.security/blog/ms-officecmd-rce
- https://lolbas-project.github.io/lolbas/Binaries/Msedge/
- https://lolbas-project.github.io/lolbas/Binaries/Teams/
- https://lolbas-project.github.io/lolbas/Binaries/msedgewebview2/
- https://medium.com/@MalFuzzer/one-electron-to-rule-them-all-dc2e9b263daf
author: Nasreddine Bencherchali (Nextron Systems)
date: 2022/10/21
modified: 2023/09/05
tags:
- attack.execution
logsource:
  category: process_creation
  product: windows
detection:
- and:
  - or:
    - ParentImage|endswith: \chrome.exe
    - ParentImage|endswith: \discord.exe
    - ParentImage|endswith: \GitHubDesktop.exe
    - ParentImage|endswith: \keybase.exe
    - ParentImage|endswith: \msedge.exe
    - ParentImage|endswith: \msedgewebview2.exe
    - ParentImage|endswith: \msteams.exe
    - ParentImage|endswith: \slack.exe
    - ParentImage|endswith: \Teams.exe
  - or:
    - Image|endswith: \cmd.exe
    - Image|endswith: \cscript.exe
    - Image|endswith: \mshta.exe
    - Image|endswith: \powershell.exe
    - Image|endswith: \pwsh.exe
    - Image|endswith: \regsvr32.exe
    - Image|endswith: \wscript.exe
  - or:
    - Image|contains: \AppData\Local\Temp\
    - Image|contains: \Users\Public\
    - Image|contains: \Windows\Temp\
    - Image|contains: :\Temp\
  - or:
    - ParentImage|not endswith: \chrome.exe
    - Image|not endswith: \chrome.exe
  - or:
    - ParentImage|not endswith: \discord.exe
    - Image|not endswith: \discord.exe
  - or:
    - ParentImage|not endswith: \GitHubDesktop.exe
    - Image|not endswith: \GitHubDesktop.exe
  - or:
    - ParentImage|not endswith: \keybase.exe
    - Image|not endswith: \keybase.exe
  - or:
    - ParentImage|not endswith: \msedge.exe
    - Image|not endswith: \msedge.exe
  - or:
    - ParentImage|not endswith: \msedgewebview2.exe
    - Image|not endswith: \msedgewebview2.exe
  - or:
    - ParentImage|not endswith: \msteams.exe
    - Image|not endswith: \msteams.exe
  - or:
    - ParentImage|not endswith: \slack.exe
    - Image|not endswith: \slack.exe
  - or:
    - ParentImage|not endswith: \teams.exe
    - Image|not endswith: \teams.exe
  - Image|!==: C:\Windows\SysWOW64\WerFault.exe
  - Image|!==: C:\Windows\System32\WerFault.exe
  - or:
    - ParentImage|not endswith: \Discord.exe
    - CommandLine|not contains: \NVSMI\nvidia-smi.exe
falsepositives:
- Legitimate child processes can occur in cases of debugging
level: medium
