title: Suspicious Processes Spawned by Java.EXE
id: 0d34ed8b-1c12-4ff2-828c-16fc860b766d
related:
- id: dff1e1cc-d3fd-47c8-bfc2-aeb878a754c0
  type: similar
status: experimental
description: Detects suspicious processes spawned from a Java host process which could
  indicate a sign of exploitation (e.g. log4j)
references:
- https://www.lunasec.io/docs/blog/log4j-zero-day/
author: Andreas Hunkeler (@Karneades), Florian Roth
date: 2021/12/17
modified: 2024/01/18
tags:
- attack.initial_access
- attack.persistence
- attack.privilege_escalation
logsource:
  category: process_creation
  product: windows
detection:
- selection:
  - and:
    - ParentImage|endswith: \java.exe
    - or:
      - Image|endswith: \AppVLP.exe
      - Image|endswith: \bitsadmin.exe
      - Image|endswith: \certutil.exe
      - Image|endswith: \cscript.exe
      - Image|endswith: \curl.exe
      - Image|endswith: \forfiles.exe
      - Image|endswith: \hh.exe
      - Image|endswith: \mftrace.exe
      - Image|endswith: \mshta.exe
      - Image|endswith: \net.exe
      - Image|endswith: \net1.exe
      - Image|endswith: \query.exe
      - Image|endswith: \reg.exe
      - Image|endswith: \regsvr32.exe
      - Image|endswith: \rundll32.exe
      - Image|endswith: \schtasks.exe
      - Image|endswith: \scrcons.exe
      - Image|endswith: \scriptrunner.exe
      - Image|endswith: \sh.exe
      - Image|endswith: \systeminfo.exe
      - Image|endswith: \whoami.exe
      - Image|endswith: \wmic.exe
      - Image|endswith: \wscript.exe
- condition: selection
falsepositives:
- Legitimate calls to system binaries
- Company specific internal usage
level: high
