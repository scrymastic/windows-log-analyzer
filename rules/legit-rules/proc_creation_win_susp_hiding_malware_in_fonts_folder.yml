title: Writing Of Malicious Files To The Fonts Folder
id: ae9b0bd7-8888-4606-b444-0ed7410cb728
status: test
description: Monitors for the hiding possible malicious files in the C:\Windows\Fonts\
  location. This folder doesn't require admin privillege to be written and executed
  from.
references:
- https://thedfirreport.com/2020/04/20/sqlserver-or-the-miner-in-the-basement/
author: Sreeman
date: 2020/04/21
modified: 2022/03/08
tags:
- attack.t1211
- attack.t1059
- attack.defense_evasion
- attack.persistence
logsource:
  product: windows
  category: process_creation
detection:
- selection_1:
  - and:
    - or:
      - CommandLine|contains: echo
      - CommandLine|contains: copy
      - CommandLine|contains: type
      - CommandLine|contains: file createnew
      - CommandLine|contains: cacls
- selection_2:
  - and:
    - CommandLine|contains: C:\Windows\Fonts\
- selection_3:
  - and:
    - or:
      - CommandLine|contains: .sh
      - CommandLine|contains: .exe
      - CommandLine|contains: .dll
      - CommandLine|contains: .bin
      - CommandLine|contains: .bat
      - CommandLine|contains: .cmd
      - CommandLine|contains: .js
      - CommandLine|contains: .msh
      - CommandLine|contains: .reg
      - CommandLine|contains: .scr
      - CommandLine|contains: .ps
      - CommandLine|contains: .vb
      - CommandLine|contains: .jar
      - CommandLine|contains: .pl
      - CommandLine|contains: '.inf'
      - CommandLine|contains: .cpl
      - CommandLine|contains: .hta
      - CommandLine|contains: .msi
      - CommandLine|contains: .vbs
- condition: all of selection_*
falsepositives:
- Unknown
level: medium
