title: Potentially Suspicious File Download From ZIP TLD
id: 0bb4bbeb-fe52-4044-b40c-430a04577ebe
status: test
description: Detects the download of a file with a potentially suspicious extension
  from a .zip top level domain.
references:
- https://twitter.com/cyb3rops/status/1659175181695287297
- https://fabian-voith.de/2020/06/25/sysmon-v11-1-reads-alternate-data-streams/
author: Florian Roth (Nextron Systems)
date: 2023/05/18
tags:
- attack.defense_evasion
logsource:
  product: windows
  category: create_stream_hash
detection:
- and:
  - Contents|contains: .zip/
  - or:
    - TargetFilename|contains: .bat:Zone
    - TargetFilename|contains: .dat:Zone
    - TargetFilename|contains: .dll:Zone
    - TargetFilename|contains: .doc:Zone
    - TargetFilename|contains: .docm:Zone
    - TargetFilename|contains: .exe:Zone
    - TargetFilename|contains: .hta:Zone
    - TargetFilename|contains: .pptm:Zone
    - TargetFilename|contains: .ps1:Zone
    - TargetFilename|contains: .rar:Zone
    - TargetFilename|contains: .rtf:Zone
    - TargetFilename|contains: .sct:Zone
    - TargetFilename|contains: .vbe:Zone
    - TargetFilename|contains: .vbs:Zone
    - TargetFilename|contains: .ws:Zone
    - TargetFilename|contains: .wsf:Zone
    - TargetFilename|contains: .xll:Zone
    - TargetFilename|contains: .xls:Zone
    - TargetFilename|contains: .xlsm:Zone
    - TargetFilename|contains: .zip:Zone
falsepositives:
- Legitimate file downloads from a websites and web services that uses the ".zip"
  top level domain.
level: high
