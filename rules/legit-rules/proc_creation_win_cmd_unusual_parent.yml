title: Unusual Parent Process For Cmd.EXE
id: 4b991083-3d0e-44ce-8fc4-b254025d8d4b
status: experimental
description: Detects suspicious parent process for cmd.exe
references:
- https://www.elastic.co/guide/en/security/current/unusual-parent-process-for-cmd.exe.html
author: Tim Rauch, Elastic (idea)
date: 2022/09/21
modified: 2023/12/05
tags:
- attack.execution
- attack.t1059
logsource:
  category: process_creation
  product: windows
detection:
- selection:
  - and:
    - Image|endswith: \cmd.exe
    - or:
      - ParentImage|endswith: \csrss.exe
      - ParentImage|endswith: \ctfmon.exe
      - ParentImage|endswith: \dllhost.exe
      - ParentImage|endswith: \epad.exe
      - ParentImage|endswith: \FlashPlayerUpdateService.exe
      - ParentImage|endswith: \GoogleUpdate.exe
      - ParentImage|endswith: \jucheck.exe
      - ParentImage|endswith: \jusched.exe
      - ParentImage|endswith: \LogonUI.exe
      - ParentImage|endswith: \lsass.exe
      - ParentImage|endswith: \regsvr32.exe
      - ParentImage|endswith: \SearchIndexer.exe
      - ParentImage|endswith: \SearchProtocolHost.exe
      - ParentImage|endswith: \SIHClient.exe
      - ParentImage|endswith: \sihost.exe
      - ParentImage|endswith: \slui.exe
      - ParentImage|endswith: \spoolsv.exe
      - ParentImage|endswith: \sppsvc.exe
      - ParentImage|endswith: \taskhostw.exe
      - ParentImage|endswith: \unsecapp.exe
      - ParentImage|endswith: \WerFault.exe
      - ParentImage|endswith: \wermgr.exe
      - ParentImage|endswith: \wlanext.exe
      - ParentImage|endswith: \WUDFHost.exe
- condition: selection
falsepositives:
- Unknown
level: medium
