title: LSASS Access From Potentially White-Listed Processes
id: 4be8b654-0c01-4c9d-a10c-6b28467fc651
status: test
description: 'Detects a possible process memory dump that uses a white-listed filename
  like TrolleyExpress.exe as a way to dump the LSASS process memory without Microsoft
  Defender interference

  '
references:
- https://twitter.com/_xpn_/status/1491557187168178176
- https://www.ired.team/offensive-security/credential-access-and-credential-dumping/dump-credentials-from-lsass-process-without-mimikatz
- https://twitter.com/mrd0x/status/1460597833917251595
author: Florian Roth (Nextron Systems)
date: 2022/02/10
modified: 2023/11/29
tags:
- attack.credential_access
- attack.t1003.001
- attack.s0002
logsource:
  category: process_access
  product: windows
detection:
- and:
  - TargetImage|endswith: \lsass.exe
  - or:
    - SourceImage|endswith: \TrolleyExpress.exe
    - SourceImage|endswith: \ProcessDump.exe
    - SourceImage|endswith: \dump64.exe
  - or:
    - GrantedAccess|endswith: '10'
    - GrantedAccess|endswith: '30'
    - GrantedAccess|endswith: '50'
    - GrantedAccess|endswith: '70'
    - GrantedAccess|endswith: '90'
    - GrantedAccess|endswith: B0
    - GrantedAccess|endswith: D0
    - GrantedAccess|endswith: F0
    - GrantedAccess|endswith: '18'
    - GrantedAccess|endswith: '38'
    - GrantedAccess|endswith: '58'
    - GrantedAccess|endswith: '78'
    - GrantedAccess|endswith: '98'
    - GrantedAccess|endswith: B8
    - GrantedAccess|endswith: D8
    - GrantedAccess|endswith: F8
    - GrantedAccess|endswith: 1A
    - GrantedAccess|endswith: 3A
    - GrantedAccess|endswith: 5A
    - GrantedAccess|endswith: 7A
    - GrantedAccess|endswith: 9A
    - GrantedAccess|endswith: BA
    - GrantedAccess|endswith: DA
    - GrantedAccess|endswith: FA
    - GrantedAccess|endswith: '0x14C2'
    - GrantedAccess|endswith: FF
falsepositives:
- Unknown
level: high
