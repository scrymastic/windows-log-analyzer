title: DNS Query To Remote Access Software Domain From Non-Browser App
id: 4d07b1f4-cb00-4470-b9f8-b0191d48ff52
related:
- id: 71ba22cb-8a01-42e2-a6dd-5bf9b547498f
  type: obsoletes
- id: 7c4cf8e0-1362-48b2-a512-b606d2065d7d
  type: obsoletes
- id: ed785237-70fa-46f3-83b6-d264d1dc6eb4
  type: obsoletes
status: experimental
description: 'An adversary may use legitimate desktop support and remote access software,
  such as Team Viewer, Go2Assist, LogMein, AmmyyAdmin, etc, to establish an interactive
  command and control channel to target systems within networks.

  These services are commonly used as legitimate technical support software, and may
  be allowed by application control within a target environment.

  Remote access tools like VNC, Ammyy, and Teamviewer are used frequently when compared
  with other legitimate software commonly used by adversaries. (Citation: Symantec
  Living off the Land)

  '
references:
- https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1219/T1219.md#atomic-test-4---gotoassist-files-detected-test-on-windows
- https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1219/T1219.md#atomic-test-3---logmein-files-detected-test-on-windows
- https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1219/T1219.md#atomic-test-6---ammyy-admin-software-execution
- https://redcanary.com/blog/misbehaving-rats/
- https://techcommunity.microsoft.com/t5/microsoft-sentinel-blog/hunting-for-omi-vulnerability-exploitation-with-azure-sentinel/ba-p/2764093
author: frack113, Connor Martin
date: 2022/07/11
modified: 2023/09/12
tags:
- attack.command_and_control
- attack.t1219
logsource:
  product: windows
  category: dns_query
detection:
- selection_generic:
  - and:
    - or:
      - QueryName|endswith: agent.jumpcloud.com
      - QueryName|endswith: agentreporting.atera.com
      - QueryName|endswith: ammyy.com
      - QueryName|endswith: api.parsec.app
      - QueryName|endswith: api.playanext.com
      - QueryName|endswith: api.splashtop.com
      - QueryName|endswith: app.atera.com
      - QueryName|endswith: assist.zoho.com
      - QueryName|endswith: authentication.logmeininc.com
      - QueryName|endswith: beyondtrustcloud.com
      - QueryName|endswith: cdn.kaseya.net
      - QueryName|endswith: client.teamviewer.com
      - QueryName|endswith: comserver.corporate.beanywhere.com
      - QueryName|endswith: control.connectwise.com
      - QueryName|endswith: downloads.zohocdn.com
      - QueryName|endswith: dwservice.net
      - QueryName|endswith: express.gotoassist.com
      - QueryName|endswith: getgo.com
      - QueryName|endswith: integratedchat.teamviewer.com
      - QueryName|endswith: join.zoho.com
      - QueryName|endswith: kickstart.jumpcloud.com
      - QueryName|endswith: license.bomgar.com
      - QueryName|endswith: logmein-gateway.com
      - QueryName|endswith: logmein.com
      - QueryName|endswith: logmeincdn.http.internapcdn.net
      - QueryName|endswith: n-able.com
      - QueryName|endswith: net.anydesk.com
      - QueryName|endswith: netsupportsoftware.com
      - QueryName|endswith: parsecusercontent.com
      - QueryName|endswith: pubsub.atera.com
      - QueryName|endswith: relay.kaseya.net
      - QueryName|endswith: relay.screenconnect.com
      - QueryName|endswith: relay.splashtop.com
      - QueryName|endswith: remotedesktop-pa.googleapis.com
      - QueryName|endswith: remoteutilities.com
      - QueryName|endswith: secure.logmeinrescue.com
      - QueryName|endswith: services.vnc.com
      - QueryName|endswith: static.remotepc.com
      - QueryName|endswith: swi-rc.com
      - QueryName|endswith: swi-tc.com
      - QueryName|endswith: telemetry.servers.qetqo.com
      - QueryName|endswith: tmate.io
      - QueryName|endswith: zohoassist.com
- selection_rustdesk:
  - and:
    - QueryName|endswith: .rustdesk.com
    - QueryName|startswith: rs-
- filter_optional_chrome:
  - and:
    - or:
      - Image|==: C:\Program Files\Google\Chrome\Application\chrome.exe
      - Image|==: C:\Program Files (x86)\Google\Chrome\Application\chrome.exe
- filter_optional_firefox:
  - and:
    - or:
      - Image|==: C:\Program Files\Mozilla Firefox\firefox.exe
      - Image|==: C:\Program Files (x86)\Mozilla Firefox\firefox.exe
- filter_optional_ie:
  - and:
    - or:
      - Image|==: C:\Program Files (x86)\Internet Explorer\iexplore.exe
      - Image|==: C:\Program Files\Internet Explorer\iexplore.exe
- filter_optional_edge_1:
  - and:
    - or:
      - Image|startswith: C:\Program Files (x86)\Microsoft\EdgeWebView\Application\
      - Image|endswith: \WindowsApps\MicrosoftEdge.exe
      - or:
        - Image|==: C:\Program Files (x86)\Microsoft\Edge\Application\msedge.exe
        - Image|==: C:\Program Files\Microsoft\Edge\Application\msedge.exe
- filter_optional_edge_2:
  - and:
    - or:
      - Image|startswith: C:\Program Files (x86)\Microsoft\EdgeCore\
      - Image|startswith: C:\Program Files\Microsoft\EdgeCore\
    - or:
      - Image|endswith: \msedge.exe
      - Image|endswith: \msedgewebview2.exe
- filter_optional_safari:
  - and:
    - Image|endswith: \safari.exe
- filter_optional_defender:
  - and:
    - or:
      - Image|endswith: \MsMpEng.exe
      - Image|endswith: \MsSense.exe
- filter_optional_brave:
  - and:
    - Image|endswith: \brave.exe
    - Image|startswith: C:\Program Files\BraveSoftware\
- filter_optional_maxthon:
  - and:
    - Image|contains: \AppData\Local\Maxthon\
    - Image|endswith: \maxthon.exe
- filter_optional_opera:
  - and:
    - Image|contains: \AppData\Local\Programs\Opera\
    - Image|endswith: \opera.exe
- filter_optional_seamonkey:
  - and:
    - or:
      - Image|startswith: C:\Program Files\SeaMonkey\
      - Image|startswith: C:\Program Files (x86)\SeaMonkey\
    - Image|endswith: \seamonkey.exe
- filter_optional_vivaldi:
  - and:
    - Image|contains: \AppData\Local\Vivaldi\
    - Image|endswith: \vivaldi.exe
- filter_optional_whale:
  - and:
    - or:
      - Image|startswith: C:\Program Files\Naver\Naver Whale\
      - Image|startswith: C:\Program Files (x86)\Naver\Naver Whale\
    - Image|endswith: \whale.exe
- filter_optional_tor:
  - and:
    - Image|contains: \Tor Browser\
- filter_optional_whaterfox:
  - and:
    - or:
      - Image|startswith: C:\Program Files\Waterfox\
      - Image|startswith: C:\Program Files (x86)\Waterfox\
    - Image|endswith: \Waterfox.exe
- filter_optional_midori:
  - and:
    - Image|contains: \AppData\Local\Programs\midori-ng\
    - Image|endswith: \Midori Next Generation.exe
- filter_optional_slimbrowser:
  - and:
    - or:
      - Image|startswith: C:\Program Files\SlimBrowser\
      - Image|startswith: C:\Program Files (x86)\SlimBrowser\
    - Image|endswith: \slimbrowser.exe
- filter_optional_flock:
  - and:
    - Image|contains: \AppData\Local\Flock\
    - Image|endswith: \Flock.exe
- filter_optional_phoebe:
  - and:
    - Image|contains: \AppData\Local\Phoebe\
    - Image|endswith: \Phoebe.exe
- filter_optional_falkon:
  - and:
    - or:
      - Image|startswith: C:\Program Files\Falkon\
      - Image|startswith: C:\Program Files (x86)\Falkon\
    - Image|endswith: \falkon.exe
- filter_optional_avant:
  - and:
    - or:
      - Image|startswith: C:\Program Files (x86)\Avant Browser\
      - Image|startswith: C:\Program Files\Avant Browser\
    - Image|endswith: \avant.exe
- condition: 1 of selection_* and not 1 of filter_optional_*
falsepositives:
- Likely with other browser software. Apply additional filters for any other browsers
  you might use.
level: medium
