title: Suspicious PowerShell Parameter Substring
id: 36210e0d-5b19-485d-a087-c096088885f0
status: test
description: Detects suspicious PowerShell invocation with a parameter substring
references:
- http://www.danielbohannon.com/blog-1/2017/3/12/powershell-execution-argument-obfuscation-how-it-can-make-detection-easier
author: Florian Roth (Nextron Systems), Daniel Bohannon (idea), Roberto Rodriguez
  (Fix)
date: 2019/01/16
modified: 2022/07/14
tags:
- attack.execution
- attack.t1059.001
logsource:
  category: process_creation
  product: windows
detection:
- and:
  - or:
    - Image|endswith: \powershell.exe
    - Image|endswith: \pwsh.exe
  - or:
    - CommandLine|contains: ' -windowstyle h '
    - CommandLine|contains: ' -windowstyl h'
    - CommandLine|contains: ' -windowsty h'
    - CommandLine|contains: ' -windowst h'
    - CommandLine|contains: ' -windows h'
    - CommandLine|contains: ' -windo h'
    - CommandLine|contains: ' -wind h'
    - CommandLine|contains: ' -win h'
    - CommandLine|contains: ' -wi h'
    - CommandLine|contains: ' -win h '
    - CommandLine|contains: ' -win hi '
    - CommandLine|contains: ' -win hid '
    - CommandLine|contains: ' -win hidd '
    - CommandLine|contains: ' -win hidde '
    - CommandLine|contains: ' -NoPr '
    - CommandLine|contains: ' -NoPro '
    - CommandLine|contains: ' -NoProf '
    - CommandLine|contains: ' -NoProfi '
    - CommandLine|contains: ' -NoProfil '
    - CommandLine|contains: ' -nonin '
    - CommandLine|contains: ' -nonint '
    - CommandLine|contains: ' -noninte '
    - CommandLine|contains: ' -noninter '
    - CommandLine|contains: ' -nonintera '
    - CommandLine|contains: ' -noninterac '
    - CommandLine|contains: ' -noninteract '
    - CommandLine|contains: ' -noninteracti '
    - CommandLine|contains: ' -noninteractiv '
    - CommandLine|contains: ' -ec '
    - CommandLine|contains: ' -encodedComman '
    - CommandLine|contains: ' -encodedComma '
    - CommandLine|contains: ' -encodedComm '
    - CommandLine|contains: ' -encodedCom '
    - CommandLine|contains: ' -encodedCo '
    - CommandLine|contains: ' -encodedC '
    - CommandLine|contains: ' -encoded '
    - CommandLine|contains: ' -encode '
    - CommandLine|contains: ' -encod '
    - CommandLine|contains: ' -enco '
    - CommandLine|contains: ' -en '
    - CommandLine|contains: ' -executionpolic '
    - CommandLine|contains: ' -executionpoli '
    - CommandLine|contains: ' -executionpol '
    - CommandLine|contains: ' -executionpo '
    - CommandLine|contains: ' -executionp '
    - CommandLine|contains: ' -execution bypass'
    - CommandLine|contains: ' -executio bypass'
    - CommandLine|contains: ' -executi bypass'
    - CommandLine|contains: ' -execut bypass'
    - CommandLine|contains: ' -execu bypass'
    - CommandLine|contains: ' -exec bypass'
    - CommandLine|contains: ' -exe bypass'
    - CommandLine|contains: ' -ex bypass'
    - CommandLine|contains: ' -ep bypass'
    - CommandLine|contains: ' /windowstyle h '
    - CommandLine|contains: ' /windowstyl h'
    - CommandLine|contains: ' /windowsty h'
    - CommandLine|contains: ' /windowst h'
    - CommandLine|contains: ' /windows h'
    - CommandLine|contains: ' /windo h'
    - CommandLine|contains: ' /wind h'
    - CommandLine|contains: ' /win h'
    - CommandLine|contains: ' /wi h'
    - CommandLine|contains: ' /win h '
    - CommandLine|contains: ' /win hi '
    - CommandLine|contains: ' /win hid '
    - CommandLine|contains: ' /win hidd '
    - CommandLine|contains: ' /win hidde '
    - CommandLine|contains: ' /NoPr '
    - CommandLine|contains: ' /NoPro '
    - CommandLine|contains: ' /NoProf '
    - CommandLine|contains: ' /NoProfi '
    - CommandLine|contains: ' /NoProfil '
    - CommandLine|contains: ' /nonin '
    - CommandLine|contains: ' /nonint '
    - CommandLine|contains: ' /noninte '
    - CommandLine|contains: ' /noninter '
    - CommandLine|contains: ' /nonintera '
    - CommandLine|contains: ' /noninterac '
    - CommandLine|contains: ' /noninteract '
    - CommandLine|contains: ' /noninteracti '
    - CommandLine|contains: ' /noninteractiv '
    - CommandLine|contains: ' /ec '
    - CommandLine|contains: ' /encodedComman '
    - CommandLine|contains: ' /encodedComma '
    - CommandLine|contains: ' /encodedComm '
    - CommandLine|contains: ' /encodedCom '
    - CommandLine|contains: ' /encodedCo '
    - CommandLine|contains: ' /encodedC '
    - CommandLine|contains: ' /encoded '
    - CommandLine|contains: ' /encode '
    - CommandLine|contains: ' /encod '
    - CommandLine|contains: ' /enco '
    - CommandLine|contains: ' /en '
    - CommandLine|contains: ' /executionpolic '
    - CommandLine|contains: ' /executionpoli '
    - CommandLine|contains: ' /executionpol '
    - CommandLine|contains: ' /executionpo '
    - CommandLine|contains: ' /executionp '
    - CommandLine|contains: ' /execution bypass'
    - CommandLine|contains: ' /executio bypass'
    - CommandLine|contains: ' /executi bypass'
    - CommandLine|contains: ' /execut bypass'
    - CommandLine|contains: ' /execu bypass'
    - CommandLine|contains: ' /exec bypass'
    - CommandLine|contains: ' /exe bypass'
    - CommandLine|contains: ' /ex bypass'
    - CommandLine|contains: ' /ep bypass'
falsepositives:
- Unknown
level: high
