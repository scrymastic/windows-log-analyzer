title: Suspicious Appended Extension
id: e3f673b3-65d1-4d80-9146-466f8b63fa99
status: test
description: Detects file renames where the target filename uses an uncommon double
  extension. Could indicate potential ransomware activity renaming files and adding
  a custom extension to the encrypted files, such as ".jpg.crypted", ".docx.locky",
  etc.
references:
- https://app.any.run/tasks/d66ead5a-faf4-4437-93aa-65785afaf9e5/
- https://blog.cyble.com/2022/08/10/onyx-ransomware-renames-its-leak-site-to-vsop/
author: frack113
date: 2022/07/16
modified: 2023/11/11
tags:
- attack.impact
- attack.t1486
logsource:
  product: windows
  category: file_rename
  definition: 'Requirements: Microsoft-Windows-Kernel-File Provider with at least
    the KERNEL_FILE_KEYWORD_RENAME_SETLINK_PATH keyword'
detection:
- and:
  - or:
    - SourceFilename|endswith: .doc
    - SourceFilename|endswith: .docx
    - SourceFilename|endswith: .jpeg
    - SourceFilename|endswith: .jpg
    - SourceFilename|endswith: .lnk
    - SourceFilename|endswith: .pdf
    - SourceFilename|endswith: .png
    - SourceFilename|endswith: .pst
    - SourceFilename|endswith: .rtf
    - SourceFilename|endswith: .xls
    - SourceFilename|endswith: .xlsx
  - or:
    - TargetFilename|contains: .doc.
    - TargetFilename|contains: .docx.
    - TargetFilename|contains: .jpeg.
    - TargetFilename|contains: .jpg.
    - TargetFilename|contains: .lnk.
    - TargetFilename|contains: .pdf.
    - TargetFilename|contains: .png.
    - TargetFilename|contains: .pst.
    - TargetFilename|contains: .rtf.
    - TargetFilename|contains: .xls.
    - TargetFilename|contains: .xlsx.
  - TargetFilename|not endswith: .backup
  - TargetFilename|not endswith: .bak
  - TargetFilename|not endswith: .old
  - TargetFilename|not endswith: .orig
  - TargetFilename|not endswith: .temp
  - TargetFilename|not endswith: .tmp
  - or:
    - TargetFilename|not contains: :\ProgramData\Anaconda3\
    - TargetFilename|not endswith: .c~
falsepositives:
- Backup software
level: medium
