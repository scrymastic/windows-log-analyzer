title: Potential CommandLine Path Traversal Via Cmd.EXE
id: 087790e3-3287-436c-bccf-cbd0184a7db1
status: test
description: Detects potential path traversal attempt via cmd.exe. Could indicate
  possible command/argument confusion/hijacking
references:
- https://hackingiscool.pl/cmdhijack-command-argument-confusion-with-path-traversal-in-cmd-exe/
- https://twitter.com/Oddvarmoe/status/1270633613449723905
author: xknow @xknow_infosec, Tim Shelton
date: 2020/06/11
modified: 2023/03/06
tags:
- attack.execution
- attack.t1059.003
logsource:
  category: process_creation
  product: windows
detection:
- and:
  - or:
    - ParentImage|endswith: \cmd.exe
    - Image|endswith: \cmd.exe
    - OriginalFileName|==: cmd.exe
  - or:
    - or:
      - ParentCommandLine|contains: /c
      - ParentCommandLine|contains: /k
      - ParentCommandLine|contains: /r
    - or:
      - CommandLine|contains: /c
      - CommandLine|contains: /k
      - CommandLine|contains: /r
  - or:
    - ParentCommandLine|==: /../../
    - CommandLine|contains: /../../
falsepositives:
- Java tools are known to produce false-positive when loading libraries
level: high
