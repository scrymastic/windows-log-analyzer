title: Microsoft Binary Suspicious Communication Endpoint
id: e0f8ab85-0ac9-423b-a73a-81b3c7b1aa97
related:
- id: 635dbb88-67b3-4b41-9ea5-a3af2dd88153
  type: obsoletes
status: test
description: Detects executables located in potentially suspicious directories initiating
  network connections towards file sharing domains.
references:
- https://twitter.com/M_haggis/status/900741347035889665
- https://twitter.com/M_haggis/status/1032799638213066752
- https://symantec-enterprise-blogs.security.com/blogs/threat-intelligence/ransomware-hive-conti-avoslocker
- https://www.cisa.gov/uscert/ncas/alerts/aa22-321a
- https://github.com/EmpireProject/Empire/blob/e37fb2eef8ff8f5a0a689f1589f424906fe13055/data/module_source/exfil/Invoke-ExfilDataToGitHub.ps1
author: Florian Roth (Nextron Systems), Nasreddine Bencherchali (Nextron Systems)
date: 2018/08/30
modified: 2024/02/09
tags:
- attack.command_and_control
- attack.t1105
logsource:
  category: network_connection
  product: windows
detection:
- selection_paths:
  - and:
    - or:
      - Image|contains: :\PerfLogs\
      - Image|contains: :\Temp\
      - Image|contains: :\Users\Public\
      - Image|contains: :\Windows\System32\Tasks\
      - Image|contains: :\Windows\Tasks\
      - Image|contains: :\Windows\Temp\
      - Image|contains: \AppData\Temp\
- selection_domains:
  - and:
    - Initiated|==: 'true'
    - or:
      - DestinationHostname|endswith: .githubusercontent.com
      - DestinationHostname|endswith: anonfiles.com
      - DestinationHostname|endswith: cdn.discordapp.com
      - DestinationHostname|endswith: cdn.discordapp.com/attachments/
      - DestinationHostname|endswith: ddns.net
      - DestinationHostname|endswith: dl.dropboxusercontent.com
      - DestinationHostname|endswith: ghostbin.co
      - DestinationHostname|endswith: glitch.me
      - DestinationHostname|endswith: gofile.io
      - DestinationHostname|endswith: hastebin.com
      - DestinationHostname|endswith: mediafire.com
      - DestinationHostname|endswith: mega.co.nz
      - DestinationHostname|endswith: mega.nz
      - DestinationHostname|endswith: onrender.com
      - DestinationHostname|endswith: paste.ee
      - DestinationHostname|endswith: pastebin.com
      - DestinationHostname|endswith: pastebin.pl
      - DestinationHostname|endswith: pastetext.net
      - DestinationHostname|endswith: privatlab.com
      - DestinationHostname|endswith: privatlab.net
      - DestinationHostname|endswith: send.exploit.in
      - DestinationHostname|endswith: sendspace.com
      - DestinationHostname|endswith: storage.googleapis.com
      - DestinationHostname|endswith: storjshare.io
      - DestinationHostname|endswith: supabase.co
      - DestinationHostname|endswith: temp.sh
      - DestinationHostname|endswith: transfer.sh
      - DestinationHostname|endswith: ufile.io
- condition: all of selection_*
falsepositives:
- Some installers located in the temp directory might communicate with the Github
  domains in order to download additional software. Baseline these cases or move the
  github domain to a lower level hunting rule.
level: high
