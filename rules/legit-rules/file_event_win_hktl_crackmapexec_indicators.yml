title: CrackMapExec File Indicators
id: 736ffa74-5f6f-44ca-94ef-1c0df4f51d2a
related:
- id: 9433ff9c-5d3f-4269-99f8-95fc826ea489
  type: obsoletes
status: experimental
description: Detects file creation events with filename patterns used by CrackMapExec.
references:
- https://github.com/byt3bl33d3r/CrackMapExec/
author: Nasreddine Bencherchali (Nextron Systems)
date: 2024/03/11
tags:
- attack.credential_access
- attack.t1003.001
logsource:
  product: windows
  category: file_event
detection:
- and:
  - TargetFilename|startswith: C:\Windows\Temp\
  - or:
    - TargetFilename|endswith: \temp.ps1
    - TargetFilename|endswith: \msol.ps1
  - or:
    - TargetFilename|matches: \\[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}\.txt$
    - TargetFilename|matches: \\[a-zA-Z]{8}\.tmp$
falsepositives:
- Unknown
level: high
