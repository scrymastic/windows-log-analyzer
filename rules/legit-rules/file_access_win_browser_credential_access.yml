title: Access To Browser Credential Files By Uncommon Application
id: 91cb43db-302a-47e3-b3c8-7ede481e27bf
status: experimental
description: 'Detects file access requests to browser credential stores by uncommon
  processes.

  Could indicate potential attempt of credential stealing.

  Requires heavy baselining before usage

  '
references:
- https://www.zscaler.com/blogs/security-research/ffdroider-stealer-targeting-social-media-platform-users
- https://github.com/lclevy/firepwd
author: frack113
date: 2022/04/09
modified: 2023/12/18
tags:
- attack.t1003
- attack.credential_access
logsource:
  category: file_access
  product: windows
  definition: 'Requirements: Microsoft-Windows-Kernel-File ETW provider'
detection:
- and:
  - or:
    - FileName|endswith: \Appdata\Local\Microsoft\Windows\WebCache\WebCacheV01.dat
  - or:
    - or:
      - FileName|endswith: \cookies.sqlite
      - FileName|endswith: release\key3.db
      - FileName|endswith: release\key4.db
      - FileName|endswith: release\logins.json
  - or:
    - or:
      - FileName|contains: \Appdata\Local\Chrome\User Data\Default\Login Data
      - FileName|contains: \AppData\Local\Google\Chrome\User Data\Default\Network\Cookies
      - FileName|contains: \AppData\Local\Google\Chrome\User Data\Local State
  - Image|==: System
  - or:
    - Image|contains: :\Program Files\
    - Image|contains: :\Program Files (x86)\
    - Image|contains: :\WINDOWS\system32\
    - Image|contains: :\WINDOWS\SysWOW64\
  - Image|contains: :\ProgramData\Microsoft\Windows Defender\
  - or:
    - Image|endswith: \MpCopyAccelerator.exe
    - Image|endswith: \MsMpEng.exe
  - or:
    - Image|endswith: \thor64.exe
    - Image|endswith: \thor.exe
falsepositives:
- Antivirus, Anti-Spyware, Anti-Malware Software
- Backup software
- Legitimate software installed on partitions other than "C:\"
- Searching software such as "everything.exe"
level: medium
