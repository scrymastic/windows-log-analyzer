title: HackTool - winPEAS Execution
id: 98b53e78-ebaf-46f8-be06-421aafd176d9
status: test
description: WinPEAS is a script that search for possible paths to escalate privileges
  on Windows hosts. The checks are explained on book.hacktricks.xyz
references:
- https://github.com/carlospolop/PEASS-ng
- https://book.hacktricks.xyz/windows-hardening/windows-local-privilege-escalation
author: Georg Lauenstein (sure[secure])
date: 2022/09/19
modified: 2023/03/23
tags:
- attack.privilege_escalation
- attack.t1082
- attack.t1087
- attack.t1046
logsource:
  category: process_creation
  product: windows
detection:
- and:
  - or:
    - or:
      - OriginalFileName|==: winPEAS.exe
      - or:
        - Image|endswith: \winPEASany_ofs.exe
        - Image|endswith: \winPEASany.exe
        - Image|endswith: \winPEASx64_ofs.exe
        - Image|endswith: \winPEASx64.exe
        - Image|endswith: \winPEASx86_ofs.exe
        - Image|endswith: \winPEASx86.exe
  - or:
    - or:
      - CommandLine|contains: ' applicationsinfo'
      - CommandLine|contains: ' browserinfo'
      - CommandLine|contains: ' eventsinfo'
      - CommandLine|contains: ' fileanalysis'
      - CommandLine|contains: ' filesinfo'
      - CommandLine|contains: ' processinfo'
      - CommandLine|contains: ' servicesinfo'
      - CommandLine|contains: ' windowscreds'
  - or:
    - CommandLine|contains: https://github.com/carlospolop/PEASS-ng/releases/latest/download/
  - or:
    - or:
      - ParentCommandLine|endswith: ' -linpeas'
      - CommandLine|endswith: ' -linpeas'
falsepositives:
- Unlikely
level: high
