title: Suspicious Schtasks Schedule Types
id: 24c8392b-aa3c-46b7-a545-43f71657fe98
related:
- id: 7a02e22e-b885-4404-b38b-1ddc7e65258a
  type: similar
status: test
description: Detects scheduled task creations or modification on a suspicious schedule
  type
references:
- https://docs.microsoft.com/en-us/windows-server/administration/windows-commands/schtasks-change
- https://docs.microsoft.com/en-us/windows-server/administration/windows-commands/schtasks-create
- http://blog.talosintelligence.com/2022/09/lazarus-three-rats.html
author: Nasreddine Bencherchali (Nextron Systems)
date: 2022/09/09
tags:
- attack.execution
- attack.t1053.005
logsource:
  product: windows
  category: process_creation
detection:
- and:
  - or:
    - Image|endswith: \schtasks.exe
    - OriginalFileName|==: schtasks.exe
  - or:
    - CommandLine|contains: ' ONLOGON '
    - CommandLine|contains: ' ONSTART '
    - CommandLine|contains: ' ONCE '
    - CommandLine|contains: ' ONIDLE '
  - CommandLine|not contains: NT AUT
  - CommandLine|not contains: ' SYSTEM'
  - CommandLine|not contains: HIGHEST
falsepositives:
- Legitimate processes that run at logon. Filter according to your environment
level: high
