title: Cmd.EXE Missing Space Characters Execution Anomaly
id: a16980c2-0c56-4de0-9a79-17971979efdd
status: test
description: 'Detects Windows command lines that miss a space before or after the
  /c flag when running a command using the cmd.exe.

  This could be a sign of obfuscation of a fat finger problem (typo by the developer).

  '
references:
- https://twitter.com/cyb3rops/status/1562072617552678912
- https://ss64.com/nt/cmd.html
author: Florian Roth (Nextron Systems)
date: 2022/08/23
modified: 2023/03/06
tags:
- attack.execution
- attack.t1059.001
logsource:
  category: process_creation
  product: windows
detection:
- and:
  - or:
    - or:
      - CommandLine|contains: cmd.exe/c
      - CommandLine|contains: \cmd/c
      - CommandLine|contains: '"cmd/c'
      - CommandLine|contains: cmd.exe/k
      - CommandLine|contains: \cmd/k
      - CommandLine|contains: '"cmd/k'
      - CommandLine|contains: cmd.exe/r
      - CommandLine|contains: \cmd/r
      - CommandLine|contains: '"cmd/r'
  - or:
    - or:
      - CommandLine|contains: /cwhoami
      - CommandLine|contains: /cpowershell
      - CommandLine|contains: /cschtasks
      - CommandLine|contains: /cbitsadmin
      - CommandLine|contains: /ccertutil
      - CommandLine|contains: /kwhoami
      - CommandLine|contains: /kpowershell
      - CommandLine|contains: /kschtasks
      - CommandLine|contains: /kbitsadmin
      - CommandLine|contains: /kcertutil
  - or:
    - or:
      - CommandLine|contains: cmd.exe /c
      - CommandLine|contains: cmd /c
      - CommandLine|contains: cmd.exe /k
      - CommandLine|contains: cmd /k
      - CommandLine|contains: cmd.exe /r
      - CommandLine|contains: cmd /r
  - or:
    - CommandLine|contains: 'cmd.exe /c '
    - CommandLine|contains: 'cmd /c '
    - CommandLine|contains: 'cmd.exe /k '
    - CommandLine|contains: 'cmd /k '
    - CommandLine|contains: 'cmd.exe /r '
    - CommandLine|contains: 'cmd /r '
  - or:
    - CommandLine|contains: AppData\Local\Programs\Microsoft VS Code\resources\app\node_modules
    - CommandLine|endswith: cmd.exe/c .
    - CommandLine|==: cmd.exe /c
falsepositives:
- Unknown
level: high
