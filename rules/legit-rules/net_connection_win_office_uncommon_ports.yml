title: Office Application Initiated Network Connection Over Uncommon Ports
id: 3b5ba899-9842-4bc2-acc2-12308498bf42
status: experimental
description: Detects an office suit application (Word, Excel, PowerPoint, Outlook)
  communicating to target systems over uncommon ports.
references:
- https://blogs.blackberry.com/en/2023/07/romcom-targets-ukraine-nato-membership-talks-at-nato-summit
author: X__Junior (Nextron Systems)
date: 2023/07/12
modified: 2024/01/31
tags:
- attack.defense_evasion
- attack.command_and_control
logsource:
  category: network_connection
  product: windows
detection:
- selection:
  - and:
    - Initiated|==: 'true'
    - or:
      - Image|endswith: \excel.exe
      - Image|endswith: \outlook.exe
      - Image|endswith: \powerpnt.exe
      - Image|endswith: \winword.exe
      - Image|endswith: \wordview.exe
- filter_main_common_ports:
  - and:
    - or:
      - DestinationPort|==: 53
      - DestinationPort|==: 80
      - DestinationPort|==: 139
      - DestinationPort|==: 443
      - DestinationPort|==: 445
- filter_main_outlook_ports:
  - and:
    - Image|contains: :\Program Files\Microsoft Office\
    - Image|endswith: \OUTLOOK.EXE
    - or:
      - DestinationPort|==: 465
      - DestinationPort|==: 587
      - DestinationPort|==: 993
      - DestinationPort|==: 995
- condition: selection and not 1 of filter_main_*
falsepositives:
- Other ports can be used, apply additional filters accordingly
level: medium
