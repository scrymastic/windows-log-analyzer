title: Rundll32 Internet Connection
id: cdc8da7d-c303-42f8-b08c-b4ab47230263
status: test
description: Detects a rundll32 that communicates with public IP addresses
references:
- https://www.hybrid-analysis.com/sample/759fb4c0091a78c5ee035715afe3084686a8493f39014aea72dae36869de9ff6?environmentId=100
author: Florian Roth (Nextron Systems)
date: 2017/11/04
modified: 2024/03/13
tags:
- attack.defense_evasion
- attack.t1218.011
- attack.execution
logsource:
  category: network_connection
  product: windows
detection:
- selection:
  - and:
    - Image|endswith: \rundll32.exe
    - Initiated|==: 'true'
- filter_main_local_ranges:
  - and:
    - or:
      - DestinationIp|cidr: 127.0.0.0/8
      - DestinationIp|cidr: 10.0.0.0/8
      - DestinationIp|cidr: 172.16.0.0/12
      - DestinationIp|cidr: 192.168.0.0/16
      - DestinationIp|cidr: 169.254.0.0/16
      - DestinationIp|cidr: ::1/128
      - DestinationIp|cidr: fe80::/10
      - DestinationIp|cidr: fc00::/7
- filter_main_ms_ranges:
  - and:
    - or:
      - DestinationIp|cidr: 20.0.0.0/8
      - DestinationIp|cidr: 51.103.0.0/16
      - DestinationIp|cidr: 51.104.0.0/16
      - DestinationIp|cidr: 51.105.0.0/16
- filter_main_app_sdb:
  - and:
    - CommandLine|endswith: \system32\PcaSvc.dll,PcaPatchSdbTask
- filter_main_azure_managed:
  - and:
    - SourceHostname|endswith: .internal.cloudapp.net
- filter_main_svchost_update_processes:
  - and:
    - ParentImage|==: C:\Windows\System32\svchost.exe
    - DestinationPort|==: 443
- condition: selection and not 1 of filter_main_*
falsepositives:
- Communication to other corporate systems that use IP addresses from public address
  spaces
level: medium
