title: LSASS Memory Access by Tool With Dump Keyword In Name
id: 9bd012ee-0dff-44d7-84a0-aa698cfd87a3
status: test
description: Detects LSASS process access requests from a source process with the
  "dump" keyword in its image name.
references:
- https://twitter.com/_xpn_/status/1491557187168178176
- https://www.ired.team/offensive-security/credential-access-and-credential-dumping/dump-credentials-from-lsass-process-without-mimikatz
author: Florian Roth (Nextron Systems)
date: 2022/02/10
modified: 2023/11/29
tags:
- attack.credential_access
- attack.t1003.001
- attack.s0002
logsource:
  category: process_access
  product: windows
detection:
- and:
  - TargetImage|endswith: \lsass.exe
  - SourceImage|contains: dump
  - or:
    - GrantedAccess|endswith: '10'
    - GrantedAccess|endswith: '30'
    - GrantedAccess|endswith: '50'
    - GrantedAccess|endswith: '70'
    - GrantedAccess|endswith: '90'
    - GrantedAccess|endswith: B0
    - GrantedAccess|endswith: D0
    - GrantedAccess|endswith: F0
    - GrantedAccess|endswith: '18'
    - GrantedAccess|endswith: '38'
    - GrantedAccess|endswith: '58'
    - GrantedAccess|endswith: '78'
    - GrantedAccess|endswith: '98'
    - GrantedAccess|endswith: B8
    - GrantedAccess|endswith: D8
    - GrantedAccess|endswith: F8
    - GrantedAccess|endswith: 1A
    - GrantedAccess|endswith: 3A
    - GrantedAccess|endswith: 5A
    - GrantedAccess|endswith: 7A
    - GrantedAccess|endswith: 9A
    - GrantedAccess|endswith: BA
    - GrantedAccess|endswith: DA
    - GrantedAccess|endswith: FA
    - GrantedAccess|endswith: '0x14C2'
    - GrantedAccess|endswith: FF
falsepositives:
- Rare programs that contain the word dump in their name and access lsass
level: high
