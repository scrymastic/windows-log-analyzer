title: Sticky Key Like Backdoor Execution
id: 2fdefcb3-dbda-401e-ae23-f0db027628bc
related:
- id: baca5663-583c-45f9-b5dc-ea96a22ce542
  type: derived
status: test
description: Detects the usage and installation of a backdoor that uses an option
  to register a malicious debugger for built-in tools that are accessible in the login
  screen
references:
- https://learn.microsoft.com/en-us/archive/blogs/jonathantrull/detecting-sticky-key-backdoors
author: Florian Roth (Nextron Systems), @twjackomo, Jonhnathan Ribeiro, oscd.community
date: 2018/03/15
modified: 2023/03/07
tags:
- attack.privilege_escalation
- attack.persistence
- attack.t1546.008
- car.2014-11-003
- car.2014-11-008
logsource:
  category: process_creation
  product: windows
detection:
- and:
  - ParentImage|endswith: \winlogon.exe
  - or:
    - Image|endswith: \cmd.exe
    - Image|endswith: \cscript.exe
    - Image|endswith: \mshta.exe
    - Image|endswith: \powershell.exe
    - Image|endswith: \pwsh.exe
    - Image|endswith: \regsvr32.exe
    - Image|endswith: \rundll32.exe
    - Image|endswith: \wscript.exe
    - Image|endswith: \wt.exe
  - or:
    - CommandLine|contains: sethc.exe
    - CommandLine|contains: utilman.exe
    - CommandLine|contains: osk.exe
    - CommandLine|contains: Magnify.exe
    - CommandLine|contains: Narrator.exe
    - CommandLine|contains: DisplaySwitch.exe
falsepositives:
- Unlikely
level: critical
