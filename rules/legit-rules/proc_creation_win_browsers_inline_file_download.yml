title: File Download From Browser Process Via Inline URL
id: 94771a71-ba41-4b6e-a757-b531372eaab6
status: test
description: Detects execution of a browser process with a URL argument pointing to
  a file with a potentially interesting extension. This can be abused to download
  arbitrary files or to hide from the user for example by launching the browser in
  a minimized state.
references:
- https://twitter.com/mrd0x/status/1478116126005641220
- https://lolbas-project.github.io/lolbas/Binaries/Msedge/
author: Florian Roth (Nextron Systems), Nasreddine Bencherchali (Nextron Systems)
date: 2022/01/11
modified: 2023/11/09
tags:
- attack.command_and_control
- attack.t1105
logsource:
  category: process_creation
  product: windows
detection:
- selection_img:
  - and:
    - or:
      - Image|endswith: \brave.exe
      - Image|endswith: \chrome.exe
      - Image|endswith: \msedge.exe
      - Image|endswith: \opera.exe
      - Image|endswith: \vivaldi.exe
- selection_http:
  - and:
    - CommandLine|contains: http
- selection_extensions:
  - and:
    - or:
      - CommandLine|endswith: .7z
      - CommandLine|endswith: .dat
      - CommandLine|endswith: .dll
      - CommandLine|endswith: .exe
      - CommandLine|endswith: .hta
      - CommandLine|endswith: .ps1
      - CommandLine|endswith: .psm1
      - CommandLine|endswith: .txt
      - CommandLine|endswith: .vbe
      - CommandLine|endswith: .vbs
      - CommandLine|endswith: .zip
- condition: all of selection_*
falsepositives:
- Unknown
level: medium
