title: Suspicious Double Extension File Execution
id: 1cdd9a09-06c9-4769-99ff-626e2b3991b8
related:
- id: 5e6a80c8-2d45-4633-9ef4-fa2671a39c5c
  type: similar
status: stable
description: Detects suspicious use of an .exe extension after a non-executable file
  extension like .pdf.exe, a set of spaces or underlines to cloak the executable file
  in spear phishing campaigns
references:
- https://blu3-team.blogspot.com/2019/06/misleading-extensions-xlsexe-docexe.html
- https://twitter.com/blackorbird/status/1140519090961825792
author: Florian Roth (Nextron Systems), @blu3_team (idea), Nasreddine Bencherchali
  (Nextron Systems)
date: 2019/06/26
modified: 2023/02/28
tags:
- attack.initial_access
- attack.t1566.001
logsource:
  category: process_creation
  product: windows
detection:
- and:
  - or:
    - Image|endswith: .doc.exe
    - Image|endswith: .docx.exe
    - Image|endswith: .xls.exe
    - Image|endswith: .xlsx.exe
    - Image|endswith: .ppt.exe
    - Image|endswith: .pptx.exe
    - Image|endswith: .rtf.exe
    - Image|endswith: .pdf.exe
    - Image|endswith: .txt.exe
    - Image|endswith: '      .exe'
    - Image|endswith: ______.exe
    - Image|endswith: .doc.js
    - Image|endswith: .docx.js
    - Image|endswith: .xls.js
    - Image|endswith: .xlsx.js
    - Image|endswith: .ppt.js
    - Image|endswith: .pptx.js
    - Image|endswith: .rtf.js
    - Image|endswith: .pdf.js
    - Image|endswith: .txt.js
  - or:
    - CommandLine|contains: .doc.exe
    - CommandLine|contains: .docx.exe
    - CommandLine|contains: .xls.exe
    - CommandLine|contains: .xlsx.exe
    - CommandLine|contains: .ppt.exe
    - CommandLine|contains: .pptx.exe
    - CommandLine|contains: .rtf.exe
    - CommandLine|contains: .pdf.exe
    - CommandLine|contains: .txt.exe
    - CommandLine|contains: '      .exe'
    - CommandLine|contains: ______.exe
    - CommandLine|contains: .doc.js
    - CommandLine|contains: .docx.js
    - CommandLine|contains: .xls.js
    - CommandLine|contains: .xlsx.js
    - CommandLine|contains: .ppt.js
    - CommandLine|contains: .pptx.js
    - CommandLine|contains: .rtf.js
    - CommandLine|contains: .pdf.js
    - CommandLine|contains: .txt.js
falsepositives:
- Unknown
level: critical
