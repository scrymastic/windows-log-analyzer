title: HackTool - Bloodhound/Sharphound Execution
id: f376c8a7-a2d0-4ddc-aa0c-16c17236d962
status: test
description: Detects command line parameters used by Bloodhound and Sharphound hack
  tools
references:
- https://github.com/BloodHoundAD/BloodHound
- https://github.com/BloodHoundAD/SharpHound
author: Florian Roth (Nextron Systems)
date: 2019/12/20
modified: 2023/02/04
tags:
- attack.discovery
- attack.t1087.001
- attack.t1087.002
- attack.t1482
- attack.t1069.001
- attack.t1069.002
- attack.execution
- attack.t1059.001
logsource:
  category: process_creation
  product: windows
detection:
- selection_img:
  - and:
    - or:
      - Product|contains: SharpHound
      - Description|contains: SharpHound
      - or:
        - Company|contains: SpecterOps
        - Company|contains: evil corp
      - or:
        - Image|contains: \Bloodhound.exe
        - Image|contains: \SharpHound.exe
- selection_cli_1:
  - and:
    - or:
      - CommandLine|contains: ' -CollectionMethod All '
      - CommandLine|contains: ' --CollectionMethods Session '
      - CommandLine|contains: ' --Loop --Loopduration '
      - CommandLine|contains: ' --PortScanTimeout '
      - CommandLine|contains: '.exe -c All -d '
      - CommandLine|contains: Invoke-Bloodhound
      - CommandLine|contains: Get-BloodHoundData
- selection_cli_2:
  - and:
    - CommandLine|contains: ' -JsonFolder '
    - CommandLine|contains: ' -ZipFileName '
- selection_cli_3:
  - and:
    - CommandLine|contains: ' DCOnly '
    - CommandLine|contains: ' --NoSaveCache '
- condition: 1 of selection_*
falsepositives:
- Other programs that use these command line option and accepts an 'All' parameter
level: high
