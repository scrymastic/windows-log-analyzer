title: File Encryption/Decryption Via Gpg4win From Suspicious Locations
id: e1e0b7d7-e10b-4ee4-ac49-a4bda05d320d
status: experimental
description: Detects usage of Gpg4win to encrypt/decrypt files located in potentially
  suspicious locations.
references:
- https://blogs.vmware.com/security/2022/11/batloader-the-evasive-downloader-malware.html
- https://news.sophos.com/en-us/2022/01/19/zloader-installs-remote-access-backdoors-and-delivers-cobalt-strike/
author: Nasreddine Bencherchali (Nextron Systems), X__Junior (Nextron Systems)
date: 2022/11/30
modified: 2023/08/09
tags:
- attack.execution
logsource:
  category: process_creation
  product: windows
detection:
- and:
  - or:
    - or:
      - Image|endswith: \gpg.exe
      - Image|endswith: \gpg2.exe
    - Product|==: GNU Privacy Guard (GnuPG)
    - Description|==: "GnuPG\u2019s OpenPGP tool"
  - CommandLine|contains: -passphrase
  - or:
    - CommandLine|contains: :\PerfLogs\
    - CommandLine|contains: :\Temp\
    - CommandLine|contains: :\Users\Public\
    - CommandLine|contains: :\Windows\Temp\
    - CommandLine|contains: \AppData\Local\Temp\
    - CommandLine|contains: \AppData\Roaming\
falsepositives:
- Unknown
level: high
