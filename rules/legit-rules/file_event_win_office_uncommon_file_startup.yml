title: Uncommon File Created In Office Startup Folder
id: a10a2c40-2c4d-49f8-b557-1a946bc55d9d
status: experimental
description: Detects the creation of a file with an uncommon extension in an Office
  application startup folder
references:
- https://app.any.run/tasks/d6fe6624-6ef8-485d-aa75-3d1bdda2a08c/
- http://addbalance.com/word/startup.htm
- https://answers.microsoft.com/en-us/msoffice/forum/all/document-in-word-startup-folder-doesnt-open-when/44ab0932-2917-4150-8cdc-2f2cf39e86f3
- https://en.wikipedia.org/wiki/List_of_Microsoft_Office_filename_extensions
author: frack113, Nasreddine Bencherchali (Nextron Systems)
date: 2022/06/05
modified: 2023/12/13
tags:
- attack.resource_development
- attack.t1587.001
logsource:
  product: windows
  category: file_event
detection:
- selection_word_paths:
  - and:
    - or:
      - TargetFilename|contains: \Microsoft\Word\STARTUP
      - and:
        - TargetFilename|contains: \Office
        - TargetFilename|contains: \Program Files
        - TargetFilename|contains: \STARTUP
- filter_exclude_word_ext:
  - and:
    - or:
      - TargetFilename|endswith: .docb
      - TargetFilename|endswith: .docm
      - TargetFilename|endswith: .docx
      - TargetFilename|endswith: .dotm
      - TargetFilename|endswith: .mdb
      - TargetFilename|endswith: .mdw
      - TargetFilename|endswith: .pdf
      - TargetFilename|endswith: .wll
      - TargetFilename|endswith: .wwl
- selection_excel_paths:
  - and:
    - or:
      - TargetFilename|contains: \Microsoft\Excel\XLSTART
      - and:
        - TargetFilename|contains: \Office
        - TargetFilename|contains: \Program Files
        - TargetFilename|contains: \XLSTART
- filter_exclude_excel_ext:
  - and:
    - or:
      - TargetFilename|endswith: .xll
      - TargetFilename|endswith: .xls
      - TargetFilename|endswith: .xlsm
      - TargetFilename|endswith: .xlsx
      - TargetFilename|endswith: .xlt
      - TargetFilename|endswith: .xltm
      - TargetFilename|endswith: .xlw
- filter_main_office_click_to_run:
  - and:
    - Image|contains: :\Program Files\Common Files\Microsoft Shared\ClickToRun\
    - Image|endswith: \OfficeClickToRun.exe
- filter_main_office_apps:
  - and:
    - or:
      - Image|contains: :\Program Files\Microsoft Office\
      - Image|contains: :\Program Files (x86)\Microsoft Office\
    - or:
      - Image|endswith: \winword.exe
      - Image|endswith: \excel.exe
- condition: ((selection_word_paths and not filter_exclude_word_ext) or (selection_excel_paths
    and not filter_exclude_excel_ext)) and not 1 of filter_main_*
falsepositives:
- False positive might stem from rare extensions used by other Office utilities.
level: high
