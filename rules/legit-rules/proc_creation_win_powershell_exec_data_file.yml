title: Powershell Inline Execution From A File
id: ee218c12-627a-4d27-9e30-d6fb2fe22ed2
status: test
description: Detects inline execution of PowerShell code from a file
references:
- https://speakerdeck.com/heirhabarov/hunting-for-powershell-abuse?slide=50
author: frack113
date: 2022/12/25
tags:
- attack.execution
- attack.t1059.001
logsource:
  product: windows
  category: process_creation
detection:
- and:
  - or:
    - CommandLine|contains: 'iex '
    - CommandLine|contains: 'Invoke-Expression '
    - CommandLine|contains: 'Invoke-Command '
    - CommandLine|contains: 'icm '
  - or:
    - CommandLine|contains: 'cat '
    - CommandLine|contains: 'get-content '
    - CommandLine|contains: 'type '
  - CommandLine|contains: ' -raw'
falsepositives:
- Unknown
level: medium
