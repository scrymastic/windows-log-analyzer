title: Potential System DLL Sideloading From Non System Locations
id: 4fc0deee-0057-4998-ab31-d24e46e0aba4
status: experimental
description: Detects DLL sideloading of DLLs usually located in system locations (System32,
  SysWOW64, etc.).
references:
- https://hijacklibs.net/
- https://blog.cyble.com/2022/07/21/qakbot-resurfaces-with-new-playbook/
- https://blog.cyble.com/2022/07/27/targeted-attacks-being-carried-out-via-dll-sideloading/
- https://github.com/XForceIR/SideLoadHunter/blob/cc7ef2e5d8908279b0c4cee4e8b6f85f7b8eed52/SideLoads/README.md
- https://www.hexacorn.com/blog/2023/12/26/1-little-known-secret-of-runonce-exe-32-bit/
author: Nasreddine Bencherchali (Nextron Systems)
date: 2022/08/14
modified: 2024/03/11
tags:
- attack.defense_evasion
- attack.persistence
- attack.privilege_escalation
- attack.t1574.001
- attack.t1574.002
logsource:
  category: image_load
  product: windows
detection:
- selection:
  - and:
    - or:
      - ImageLoaded|endswith: \shfolder.dll
      - ImageLoaded|endswith: \activeds.dll
      - ImageLoaded|endswith: \adsldpc.dll
      - ImageLoaded|endswith: \aepic.dll
      - ImageLoaded|endswith: \apphelp.dll
      - ImageLoaded|endswith: \applicationframe.dll
      - ImageLoaded|endswith: \appxalluserstore.dll
      - ImageLoaded|endswith: \appxdeploymentclient.dll
      - ImageLoaded|endswith: \archiveint.dll
      - ImageLoaded|endswith: \atl.dll
      - ImageLoaded|endswith: \audioses.dll
      - ImageLoaded|endswith: \auditpolcore.dll
      - ImageLoaded|endswith: \authfwcfg.dll
      - ImageLoaded|endswith: \authz.dll
      - ImageLoaded|endswith: \avrt.dll
      - ImageLoaded|endswith: \bcd.dll
      - ImageLoaded|endswith: \bcp47langs.dll
      - ImageLoaded|endswith: \bcp47mrm.dll
      - ImageLoaded|endswith: \bcrypt.dll
      - ImageLoaded|endswith: \cabinet.dll
      - ImageLoaded|endswith: \cabview.dll
      - ImageLoaded|endswith: \certenroll.dll
      - ImageLoaded|endswith: \cldapi.dll
      - ImageLoaded|endswith: \clipc.dll
      - ImageLoaded|endswith: \clusapi.dll
      - ImageLoaded|endswith: \cmpbk32.dll
      - ImageLoaded|endswith: \coloradapterclient.dll
      - ImageLoaded|endswith: \colorui.dll
      - ImageLoaded|endswith: \comdlg32.dll
      - ImageLoaded|endswith: \connect.dll
      - ImageLoaded|endswith: \coremessaging.dll
      - ImageLoaded|endswith: \credui.dll
      - ImageLoaded|endswith: \cryptbase.dll
      - ImageLoaded|endswith: \cryptdll.dll
      - ImageLoaded|endswith: \cryptui.dll
      - ImageLoaded|endswith: \cryptxml.dll
      - ImageLoaded|endswith: \cscapi.dll
      - ImageLoaded|endswith: \cscobj.dll
      - ImageLoaded|endswith: \cscui.dll
      - ImageLoaded|endswith: \d2d1.dll
      - ImageLoaded|endswith: \d3d10.dll
      - ImageLoaded|endswith: \d3d10_1.dll
      - ImageLoaded|endswith: \d3d10_1core.dll
      - ImageLoaded|endswith: \d3d10core.dll
      - ImageLoaded|endswith: \d3d10warp.dll
      - ImageLoaded|endswith: \d3d11.dll
      - ImageLoaded|endswith: \d3d12.dll
      - ImageLoaded|endswith: \d3d9.dll
      - ImageLoaded|endswith: \dataexchange.dll
      - ImageLoaded|endswith: \davclnt.dll
      - ImageLoaded|endswith: \dcomp.dll
      - ImageLoaded|endswith: \defragproxy.dll
      - ImageLoaded|endswith: \desktopshellext.dll
      - ImageLoaded|endswith: \deviceassociation.dll
      - ImageLoaded|endswith: \devicecredential.dll
      - ImageLoaded|endswith: \devicepairing.dll
      - ImageLoaded|endswith: \devobj.dll
      - ImageLoaded|endswith: \devrtl.dll
      - ImageLoaded|endswith: \dhcpcmonitor.dll
      - ImageLoaded|endswith: \dhcpcsvc.dll
      - ImageLoaded|endswith: \dhcpcsvc6.dll
      - ImageLoaded|endswith: \directmanipulation.dll
      - ImageLoaded|endswith: \dismapi.dll
      - ImageLoaded|endswith: \dismcore.dll
      - ImageLoaded|endswith: \dmcfgutils.dll
      - ImageLoaded|endswith: \dmcmnutils.dll
      - ImageLoaded|endswith: \dmenrollengine.dll
      - ImageLoaded|endswith: \dmenterprisediagnostics.dll
      - ImageLoaded|endswith: \dmiso8601utils.dll
      - ImageLoaded|endswith: \dmoleaututils.dll
      - ImageLoaded|endswith: \dmprocessxmlfiltered.dll
      - ImageLoaded|endswith: \dmpushproxy.dll
      - ImageLoaded|endswith: \dmxmlhelputils.dll
      - ImageLoaded|endswith: \dnsapi.dll
      - ImageLoaded|endswith: \dot3api.dll
      - ImageLoaded|endswith: \dot3cfg.dll
      - ImageLoaded|endswith: \drprov.dll
      - ImageLoaded|endswith: \dsclient.dll
      - ImageLoaded|endswith: \dsparse.dll
      - ImageLoaded|endswith: \dsreg.dll
      - ImageLoaded|endswith: \dsrole.dll
      - ImageLoaded|endswith: \dui70.dll
      - ImageLoaded|endswith: \duser.dll
      - ImageLoaded|endswith: \dusmapi.dll
      - ImageLoaded|endswith: \dwmapi.dll
      - ImageLoaded|endswith: \dwrite.dll
      - ImageLoaded|endswith: \dxgi.dll
      - ImageLoaded|endswith: \dxva2.dll
      - ImageLoaded|endswith: \eappcfg.dll
      - ImageLoaded|endswith: \eappprxy.dll
      - ImageLoaded|endswith: \edputil.dll
      - ImageLoaded|endswith: \efsadu.dll
      - ImageLoaded|endswith: \efsutil.dll
      - ImageLoaded|endswith: \esent.dll
      - ImageLoaded|endswith: \execmodelproxy.dll
      - ImageLoaded|endswith: \explorerframe.dll
      - ImageLoaded|endswith: \fastprox.dll
      - ImageLoaded|endswith: \faultrep.dll
      - ImageLoaded|endswith: \fddevquery.dll
      - ImageLoaded|endswith: \feclient.dll
      - ImageLoaded|endswith: \fhcfg.dll
      - ImageLoaded|endswith: \firewallapi.dll
      - ImageLoaded|endswith: \flightsettings.dll
      - ImageLoaded|endswith: \fltlib.dll
      - ImageLoaded|endswith: \fveapi.dll
      - ImageLoaded|endswith: \fwbase.dll
      - ImageLoaded|endswith: \fwcfg.dll
      - ImageLoaded|endswith: \fwpolicyiomgr.dll
      - ImageLoaded|endswith: \fwpuclnt.dll
      - ImageLoaded|endswith: \getuname.dll
      - ImageLoaded|endswith: \hid.dll
      - ImageLoaded|endswith: \hnetmon.dll
      - ImageLoaded|endswith: \httpapi.dll
      - ImageLoaded|endswith: \idstore.dll
      - ImageLoaded|endswith: \ieadvpack.dll
      - ImageLoaded|endswith: \iedkcs32.dll
      - ImageLoaded|endswith: \iernonce.dll
      - ImageLoaded|endswith: \iertutil.dll
      - ImageLoaded|endswith: \ifmon.dll
      - ImageLoaded|endswith: \iphlpapi.dll
      - ImageLoaded|endswith: \iri.dll
      - ImageLoaded|endswith: \iscsidsc.dll
      - ImageLoaded|endswith: \iscsium.dll
      - ImageLoaded|endswith: \isv.exe_rsaenh.dll
      - ImageLoaded|endswith: \joinutil.dll
      - ImageLoaded|endswith: \ksuser.dll
      - ImageLoaded|endswith: \ktmw32.dll
      - ImageLoaded|endswith: \licensemanagerapi.dll
      - ImageLoaded|endswith: \licensingdiagspp.dll
      - ImageLoaded|endswith: \linkinfo.dll
      - ImageLoaded|endswith: \loadperf.dll
      - ImageLoaded|endswith: \logoncli.dll
      - ImageLoaded|endswith: \logoncontroller.dll
      - ImageLoaded|endswith: \lpksetupproxyserv.dll
      - ImageLoaded|endswith: \magnification.dll
      - ImageLoaded|endswith: \mapistub.dll
      - ImageLoaded|endswith: \mfcore.dll
      - ImageLoaded|endswith: \mfplat.dll
      - ImageLoaded|endswith: \mi.dll
      - ImageLoaded|endswith: \midimap.dll
      - ImageLoaded|endswith: \miutils.dll
      - ImageLoaded|endswith: \mlang.dll
      - ImageLoaded|endswith: \mmdevapi.dll
      - ImageLoaded|endswith: \mobilenetworking.dll
      - ImageLoaded|endswith: \mpr.dll
      - ImageLoaded|endswith: \mprapi.dll
      - ImageLoaded|endswith: \mrmcorer.dll
      - ImageLoaded|endswith: \msacm32.dll
      - ImageLoaded|endswith: \mscms.dll
      - ImageLoaded|endswith: \mscoree.dll
      - ImageLoaded|endswith: \msctf.dll
      - ImageLoaded|endswith: \msctfmonitor.dll
      - ImageLoaded|endswith: \msdrm.dll
      - ImageLoaded|endswith: \msftedit.dll
      - ImageLoaded|endswith: \msi.dll
      - ImageLoaded|endswith: \msutb.dll
      - ImageLoaded|endswith: \mswb7.dll
      - ImageLoaded|endswith: \mswsock.dll
      - ImageLoaded|endswith: \msxml3.dll
      - ImageLoaded|endswith: \mtxclu.dll
      - ImageLoaded|endswith: \napinsp.dll
      - ImageLoaded|endswith: \ncrypt.dll
      - ImageLoaded|endswith: \ndfapi.dll
      - ImageLoaded|endswith: \netid.dll
      - ImageLoaded|endswith: \netiohlp.dll
      - ImageLoaded|endswith: \netplwiz.dll
      - ImageLoaded|endswith: \netprofm.dll
      - ImageLoaded|endswith: \netsetupapi.dll
      - ImageLoaded|endswith: \netshell.dll
      - ImageLoaded|endswith: \netutils.dll
      - ImageLoaded|endswith: \networkexplorer.dll
      - ImageLoaded|endswith: \newdev.dll
      - ImageLoaded|endswith: \ninput.dll
      - ImageLoaded|endswith: \nlaapi.dll
      - ImageLoaded|endswith: \nlansp_c.dll
      - ImageLoaded|endswith: \npmproxy.dll
      - ImageLoaded|endswith: \nshhttp.dll
      - ImageLoaded|endswith: \nshipsec.dll
      - ImageLoaded|endswith: \nshwfp.dll
      - ImageLoaded|endswith: \ntdsapi.dll
      - ImageLoaded|endswith: \ntlanman.dll
      - ImageLoaded|endswith: \ntlmshared.dll
      - ImageLoaded|endswith: \ntmarta.dll
      - ImageLoaded|endswith: \ntshrui.dll
      - ImageLoaded|endswith: \oleacc.dll
      - ImageLoaded|endswith: \omadmapi.dll
      - ImageLoaded|endswith: \onex.dll
      - ImageLoaded|endswith: \osbaseln.dll
      - ImageLoaded|endswith: \osuninst.dll
      - ImageLoaded|endswith: \p2p.dll
      - ImageLoaded|endswith: \p2pnetsh.dll
      - ImageLoaded|endswith: \p9np.dll
      - ImageLoaded|endswith: \pcaui.dll
      - ImageLoaded|endswith: \pdh.dll
      - ImageLoaded|endswith: \peerdistsh.dll
      - ImageLoaded|endswith: \pla.dll
      - ImageLoaded|endswith: \pnrpnsp.dll
      - ImageLoaded|endswith: \policymanager.dll
      - ImageLoaded|endswith: \polstore.dll
      - ImageLoaded|endswith: \printui.dll
      - ImageLoaded|endswith: \propsys.dll
      - ImageLoaded|endswith: \prvdmofcomp.dll
      - ImageLoaded|endswith: \puiapi.dll
      - ImageLoaded|endswith: \radcui.dll
      - ImageLoaded|endswith: \rasapi32.dll
      - ImageLoaded|endswith: \rasgcw.dll
      - ImageLoaded|endswith: \rasman.dll
      - ImageLoaded|endswith: \rasmontr.dll
      - ImageLoaded|endswith: \reagent.dll
      - ImageLoaded|endswith: \regapi.dll
      - ImageLoaded|endswith: \resutils.dll
      - ImageLoaded|endswith: \rmclient.dll
      - ImageLoaded|endswith: \rpcnsh.dll
      - ImageLoaded|endswith: \rsaenh.dll
      - ImageLoaded|endswith: \rtutils.dll
      - ImageLoaded|endswith: \rtworkq.dll
      - ImageLoaded|endswith: \samcli.dll
      - ImageLoaded|endswith: \samlib.dll
      - ImageLoaded|endswith: \sapi_onecore.dll
      - ImageLoaded|endswith: \sas.dll
      - ImageLoaded|endswith: \scansetting.dll
      - ImageLoaded|endswith: \scecli.dll
      - ImageLoaded|endswith: \schedcli.dll
      - ImageLoaded|endswith: \secur32.dll
      - ImageLoaded|endswith: \shell32.dll
      - ImageLoaded|endswith: \slc.dll
      - ImageLoaded|endswith: \snmpapi.dll
      - ImageLoaded|endswith: \spp.dll
      - ImageLoaded|endswith: \sppc.dll
      - ImageLoaded|endswith: \srclient.dll
      - ImageLoaded|endswith: \srpapi.dll
      - ImageLoaded|endswith: \srvcli.dll
      - ImageLoaded|endswith: \ssp.exe_rsaenh.dll
      - ImageLoaded|endswith: \ssp_isv.exe_rsaenh.dll
      - ImageLoaded|endswith: \sspicli.dll
      - ImageLoaded|endswith: \ssshim.dll
      - ImageLoaded|endswith: \staterepository.core.dll
      - ImageLoaded|endswith: \structuredquery.dll
      - ImageLoaded|endswith: \sxshared.dll
      - ImageLoaded|endswith: \tapi32.dll
      - ImageLoaded|endswith: \tbs.dll
      - ImageLoaded|endswith: \tdh.dll
      - ImageLoaded|endswith: \tquery.dll
      - ImageLoaded|endswith: \tsworkspace.dll
      - ImageLoaded|endswith: \ttdrecord.dll
      - ImageLoaded|endswith: \twext.dll
      - ImageLoaded|endswith: \twinapi.dll
      - ImageLoaded|endswith: \twinui.appcore.dll
      - ImageLoaded|endswith: \uianimation.dll
      - ImageLoaded|endswith: \uiautomationcore.dll
      - ImageLoaded|endswith: \uireng.dll
      - ImageLoaded|endswith: \uiribbon.dll
      - ImageLoaded|endswith: \updatepolicy.dll
      - ImageLoaded|endswith: \userenv.dll
      - ImageLoaded|endswith: \utildll.dll
      - ImageLoaded|endswith: \uxinit.dll
      - ImageLoaded|endswith: \uxtheme.dll
      - ImageLoaded|endswith: \vaultcli.dll
      - ImageLoaded|endswith: \virtdisk.dll
      - ImageLoaded|endswith: \vssapi.dll
      - ImageLoaded|endswith: \vsstrace.dll
      - ImageLoaded|endswith: \wbemprox.dll
      - ImageLoaded|endswith: \wbemsvc.dll
      - ImageLoaded|endswith: \wcmapi.dll
      - ImageLoaded|endswith: \wcnnetsh.dll
      - ImageLoaded|endswith: \wdi.dll
      - ImageLoaded|endswith: \wdscore.dll
      - ImageLoaded|endswith: \webservices.dll
      - ImageLoaded|endswith: \wecapi.dll
      - ImageLoaded|endswith: \wer.dll
      - ImageLoaded|endswith: \wevtapi.dll
      - ImageLoaded|endswith: \whhelper.dll
      - ImageLoaded|endswith: \wimgapi.dll
      - ImageLoaded|endswith: \winbrand.dll
      - ImageLoaded|endswith: \windows.storage.dll
      - ImageLoaded|endswith: \windows.storage.search.dll
      - ImageLoaded|endswith: \windowscodecs.dll
      - ImageLoaded|endswith: \windowscodecsext.dll
      - ImageLoaded|endswith: \windowsudk.shellcommon.dll
      - ImageLoaded|endswith: \winhttp.dll
      - ImageLoaded|endswith: \wininet.dll
      - ImageLoaded|endswith: \winipsec.dll
      - ImageLoaded|endswith: \winmde.dll
      - ImageLoaded|endswith: \winmm.dll
      - ImageLoaded|endswith: \winnsi.dll
      - ImageLoaded|endswith: \winrnr.dll
      - ImageLoaded|endswith: \winsqlite3.dll
      - ImageLoaded|endswith: \winsta.dll
      - ImageLoaded|endswith: \wkscli.dll
      - ImageLoaded|endswith: \wlanapi.dll
      - ImageLoaded|endswith: \wlancfg.dll
      - ImageLoaded|endswith: \wldp.dll
      - ImageLoaded|endswith: \wlidprov.dll
      - ImageLoaded|endswith: \wmiclnt.dll
      - ImageLoaded|endswith: \wmidcom.dll
      - ImageLoaded|endswith: \wmiutils.dll
      - ImageLoaded|endswith: \wmsgapi.dll
      - ImageLoaded|endswith: \wofutil.dll
      - ImageLoaded|endswith: \wpdshext.dll
      - ImageLoaded|endswith: \wshbth.dll
      - ImageLoaded|endswith: \wshelper.dll
      - ImageLoaded|endswith: \wtsapi32.dll
      - ImageLoaded|endswith: \wwapi.dll
      - ImageLoaded|endswith: \xmllite.dll
      - ImageLoaded|endswith: \xolehlp.dll
      - ImageLoaded|endswith: \xwizards.dll
      - ImageLoaded|endswith: \xwtpw32.dll
      - ImageLoaded|endswith: \aclui.dll
      - ImageLoaded|endswith: \bderepair.dll
      - ImageLoaded|endswith: \bootmenuux.dll
      - ImageLoaded|endswith: \dcntel.dll
      - ImageLoaded|endswith: \dwmcore.dll
      - ImageLoaded|endswith: \dynamoapi.dll
      - ImageLoaded|endswith: \fhsvcctl.dll
      - ImageLoaded|endswith: \fxsst.dll
      - ImageLoaded|endswith: \inproclogger.dll
      - ImageLoaded|endswith: \iumbase.dll
      - ImageLoaded|endswith: \kdstub.dll
      - ImageLoaded|endswith: \maintenanceui.dll
      - ImageLoaded|endswith: \mdmdiagnostics.dll
      - ImageLoaded|endswith: \mintdh.dll
      - ImageLoaded|endswith: \msdtctm.dll
      - ImageLoaded|endswith: \nettrace.dll
      - ImageLoaded|endswith: \osksupport.dll
      - ImageLoaded|endswith: \reseteng.dll
      - ImageLoaded|endswith: \resetengine.dll
      - ImageLoaded|endswith: \spectrumsyncclient.dll
      - ImageLoaded|endswith: \srcore.dll
      - ImageLoaded|endswith: \systemsettingsthresholdadminflowui.dll
      - ImageLoaded|endswith: \timesync.dll
      - ImageLoaded|endswith: \upshared.dll
      - ImageLoaded|endswith: \wmpdui.dll
      - ImageLoaded|endswith: \wwancfg.dll
      - ImageLoaded|endswith: \dpx.dll
      - ImageLoaded|endswith: \fxsapi.dll
      - ImageLoaded|endswith: \fxstiff.dll
      - ImageLoaded|endswith: \xpsservices.dll
      - ImageLoaded|endswith: \appvpolicy.dll
      - ImageLoaded|endswith: \batmeter.dll
      - ImageLoaded|endswith: \bootux.dll
      - ImageLoaded|endswith: \cmutil.dll
      - ImageLoaded|endswith: \configmanager2.dll
      - ImageLoaded|endswith: \coredplus.dll
      - ImageLoaded|endswith: \coreuicomponents.dll
      - ImageLoaded|endswith: \cryptsp.dll
      - ImageLoaded|endswith: \dmcommandlineutils.dll
      - ImageLoaded|endswith: \drvstore.dll
      - ImageLoaded|endswith: \dsprop.dll
      - ImageLoaded|endswith: \dxcore.dll
      - ImageLoaded|endswith: \edgeiso.dll
      - ImageLoaded|endswith: \framedynos.dll
      - ImageLoaded|endswith: \fveskybackup.dll
      - ImageLoaded|endswith: \fvewiz.dll
      - ImageLoaded|endswith: \gpapi.dll
      - ImageLoaded|endswith: \icmp.dll
      - ImageLoaded|endswith: \ifsutil.dll
      - ImageLoaded|endswith: \iumsdk.dll
      - ImageLoaded|endswith: \lockhostingframework.dll
      - ImageLoaded|endswith: \lrwizdll.dll
      - ImageLoaded|endswith: \mbaexmlparser.dll
      - ImageLoaded|endswith: \mfc42u.dll
      - ImageLoaded|endswith: \msiso.dll
      - ImageLoaded|endswith: \msvcp110_win.dll
      - ImageLoaded|endswith: \netapi32.dll
      - ImageLoaded|endswith: \netjoin.dll
      - ImageLoaded|endswith: \netprovfw.dll
      - ImageLoaded|endswith: \opcservices.dll
      - ImageLoaded|endswith: \pkeyhelper.dll
      - ImageLoaded|endswith: \playsndsrv.dll
      - ImageLoaded|endswith: \powrprof.dll
      - ImageLoaded|endswith: \prntvpt.dll
      - ImageLoaded|endswith: \profapi.dll
      - ImageLoaded|endswith: \proximitycommon.dll
      - ImageLoaded|endswith: \proximityservicepal.dll
      - ImageLoaded|endswith: \rasdlg.dll
      - ImageLoaded|endswith: \security.dll
      - ImageLoaded|endswith: \sppcext.dll
      - ImageLoaded|endswith: \srmtrace.dll
      - ImageLoaded|endswith: \tpmcoreprovisioning.dll
      - ImageLoaded|endswith: \umpdc.dll
      - ImageLoaded|endswith: \unattend.dll
      - ImageLoaded|endswith: \urlmon.dll
      - ImageLoaded|endswith: \vdsutil.dll
      - ImageLoaded|endswith: \version.dll
      - ImageLoaded|endswith: \winbio.dll
      - ImageLoaded|endswith: \windows.ui.immersive.dll
      - ImageLoaded|endswith: \winscard.dll
      - ImageLoaded|endswith: \winsync.dll
      - ImageLoaded|endswith: \wscapi.dll
      - ImageLoaded|endswith: \wsmsvc.dll
      - ImageLoaded|endswith: \FxsCompose.dll
      - ImageLoaded|endswith: \WfsR.dll
      - ImageLoaded|endswith: \rpchttp.dll
      - ImageLoaded|endswith: \storageusage.dll
      - ImageLoaded|endswith: \amsi.dll
      - ImageLoaded|endswith: \PrintIsolationProxy.dll
      - ImageLoaded|endswith: \msdtcVSp1res.dll
      - ImageLoaded|endswith: \rdpendp.dll
      - ImageLoaded|endswith: \dxilconv.dll
      - ImageLoaded|endswith: \utcutil.dll
      - ImageLoaded|endswith: \appraiser.dll
      - ImageLoaded|endswith: \dsound.dll
      - ImageLoaded|endswith: \DispBroker.dll
      - ImageLoaded|endswith: \FXSRESM.DLL
      - ImageLoaded|endswith: \cryptnet.dll
      - ImageLoaded|endswith: \COMRES.DLL
      - ImageLoaded|endswith: \igdumdim64.dll
      - ImageLoaded|endswith: \igd10iumd64.dll
      - ImageLoaded|endswith: \igd12umd64.dll
      - ImageLoaded|endswith: \igdusc64.dll
      - ImageLoaded|endswith: \WLBSCTRL.dll
      - ImageLoaded|endswith: \TSMSISrv.dll
      - ImageLoaded|endswith: \TSVIPSrv.dll
      - ImageLoaded|endswith: \wow64log.dll
      - ImageLoaded|endswith: \WptsExtensions.dll
      - ImageLoaded|endswith: \wbemcomn.dll
- filter_main_generic:
  - and:
    - or:
      - ImageLoaded|contains: C:\$WINDOWS.~BT\
      - ImageLoaded|contains: C:\$WinREAgent\
      - ImageLoaded|contains: C:\Windows\SoftwareDistribution\
      - ImageLoaded|contains: C:\Windows\System32\
      - ImageLoaded|contains: C:\Windows\SystemTemp\
      - ImageLoaded|contains: C:\Windows\SysWOW64\
      - ImageLoaded|contains: C:\Windows\WinSxS\
- filter_main_dot_net:
  - and:
    - ImageLoaded|startswith: C:\Windows\Microsoft.NET\
    - ImageLoaded|endswith: \cscui.dll
- filter_main_defender:
  - and:
    - ImageLoaded|contains: C:\ProgramData\Microsoft\Windows Defender\Platform\
    - ImageLoaded|endswith: \version.dll
- filter_optional_exchange:
  - and:
    - ImageLoaded|contains: C:\Program Files\Microsoft\Exchange Server\
    - ImageLoaded|endswith: \mswb7.dll
- filter_optional_arsenal_image_mounter:
  - and:
    - ImageLoaded|contains: C:\Program Files\Arsenal-Image-Mounter-
    - or:
      - ImageLoaded|endswith: \mi.dll
      - ImageLoaded|endswith: \miutils.dl
- filter_optional_office_appvpolicy:
  - and:
    - Image|endswith: C:\Program Files\Common Files\microsoft shared\ClickToRun\OfficeClickToRun.exe
    - ImageLoaded|endswith: C:\Program Files\Common Files\microsoft shared\ClickToRun\AppVPolicy.dll
- filter_optional_azure:
  - and:
    - ImageLoaded|contains: C:\Packages\Plugins\Microsoft.GuestConfiguration.ConfigurationforWindows\
- filter_optional_dell:
  - and:
    - or:
      - Image|contains: C:\Program Files\WindowsApps\DellInc.DellSupportAssistforPCs
      - Image|contains: C:\Windows\System32\backgroundTaskHost.exe
    - ImageLoaded|contains: :\Program Files\WindowsApps\DellInc.DellSupportAssistforPCs
- filter_optional_dell_wldp:
  - and:
    - Image|contains: C:\Program Files\WindowsApps\DellInc.DellSupportAssistforPCs
    - Image|endswith: \wldp.dll
- filter_optional_checkpoint:
  - and:
    - or:
      - Image|contains: C:\Program Files\CheckPoint\
      - Image|contains: C:\Program Files (x86)\CheckPoint\
    - Image|endswith: \SmartConsole.exe
    - or:
      - ImageLoaded|contains: C:\Program Files\CheckPoint\
      - ImageLoaded|contains: C:\Program Files (x86)\CheckPoint\
    - ImageLoaded|endswith: \PolicyManager.dll
- condition: selection and not 1 of filter_main_* and not 1 of filter_optional_*
falsepositives:
- Legitimate applications loading their own versions of the DLLs mentioned in this
  rule
level: high
