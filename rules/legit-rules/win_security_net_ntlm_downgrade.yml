title: NetNTLM Downgrade Attack
id: d3abac66-f11c-4ed0-8acb-50cc29c97eed
related:
- id: d67572a0-e2ec-45d6-b8db-c100d14b8ef2
  type: derived
status: test
description: Detects NetNTLM downgrade attack
references:
- https://www.optiv.com/blog/post-exploitation-using-netntlm-downgrade-attacks
author: Florian Roth (Nextron Systems), wagga
date: 2018/03/20
modified: 2022/10/09
tags:
- attack.defense_evasion
- attack.t1562.001
- attack.t1112
logsource:
  product: windows
  service: security
  definition: 'Requirements: Audit Policy : Object Access > Audit Registry (Success)'
detection:
- selection:
  - and:
    - EventID|==: 4657
    - ObjectName|contains: \REGISTRY\MACHINE\SYSTEM
    - ObjectName|contains: ControlSet
    - ObjectName|contains: \Control\Lsa
    - or:
      - ObjectValueName|==: LmCompatibilityLevel
      - ObjectValueName|==: NtlmMinClientSec
      - ObjectValueName|==: RestrictSendingNTLMTraffic
- condition: selection
falsepositives:
- Unknown
level: high
