title: HackTool - Rubeus Execution - ScriptBlock
id: 3245cd30-e015-40ff-a31d-5cadd5f377ec
related:
- id: 7ec2c172-dceb-4c10-92c9-87c1881b7e18
  type: similar
status: test
description: Detects the execution of the hacktool Rubeus using specific command line
  flags
references:
- https://blog.harmj0y.net/redteaming/from-kekeo-to-rubeus
- https://m0chan.github.io/2019/07/31/How-To-Attack-Kerberos-101.html
- https://github.com/GhostPack/Rubeus
author: Christian Burkard (Nextron Systems), Florian Roth (Nextron Systems)
date: 2023/04/27
tags:
- attack.credential_access
- attack.t1003
- attack.t1558.003
- attack.lateral_movement
- attack.t1550.003
logsource:
  product: windows
  category: ps_script
  definition: 'Requirements: Script Block Logging must be enabled'
detection:
- selection:
  - and:
    - or:
      - ScriptBlockText|contains: 'asreproast '
      - ScriptBlockText|contains: 'dump /service:krbtgt '
      - ScriptBlockText|contains: dump /luid:0x
      - ScriptBlockText|contains: 'kerberoast '
      - ScriptBlockText|contains: 'createnetonly /program:'
      - ScriptBlockText|contains: 'ptt /ticket:'
      - ScriptBlockText|contains: '/impersonateuser:'
      - ScriptBlockText|contains: 'renew /ticket:'
      - ScriptBlockText|contains: 'asktgt /user:'
      - ScriptBlockText|contains: 'harvest /interval:'
      - ScriptBlockText|contains: 's4u /user:'
      - ScriptBlockText|contains: 's4u /ticket:'
      - ScriptBlockText|contains: 'hash /password:'
      - ScriptBlockText|contains: 'golden /aes256:'
      - ScriptBlockText|contains: 'silver /user:'
- condition: selection
falsepositives:
- Unlikely
level: high
