title: Regsvr32 DLL Execution With Suspicious File Extension
id: 089fc3d2-71e8-4763-a8a5-c97fbb0a403e
related:
- id: 8e2b24c9-4add-46a0-b4bb-0057b4e6187d
  type: obsoletes
status: test
description: Detects the execution of REGSVR32.exe with DLL files masquerading as
  other files
references:
- https://thedfirreport.com/2021/11/29/continuing-the-bazar-ransomware-story/
- https://blog.talosintelligence.com/2021/10/threat-hunting-in-large-datasets-by.html
- https://guides.lib.umich.edu/c.php?g=282942&p=1885348
author: Florian Roth (Nextron Systems), frack113
date: 2021/11/29
modified: 2023/05/24
tags:
- attack.defense_evasion
- attack.t1218.010
logsource:
  category: process_creation
  product: windows
detection:
- and:
  - or:
    - Image|endswith: \regsvr32.exe
    - OriginalFileName|==: REGSVR32.EXE
  - or:
    - CommandLine|endswith: .bin
    - CommandLine|endswith: .bmp
    - CommandLine|endswith: .cr2
    - CommandLine|endswith: .dat
    - CommandLine|endswith: .eps
    - CommandLine|endswith: .gif
    - CommandLine|endswith: .ico
    - CommandLine|endswith: .jpeg
    - CommandLine|endswith: .jpg
    - CommandLine|endswith: .nef
    - CommandLine|endswith: .orf
    - CommandLine|endswith: .png
    - CommandLine|endswith: .raw
    - CommandLine|endswith: .sr2
    - CommandLine|endswith: .temp
    - CommandLine|endswith: .tif
    - CommandLine|endswith: .tiff
    - CommandLine|endswith: .tmp
    - CommandLine|endswith: .rtf
    - CommandLine|endswith: .txt
falsepositives:
- Unlikely
level: high
