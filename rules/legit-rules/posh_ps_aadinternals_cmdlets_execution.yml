title: AADInternals PowerShell Cmdlets Execution - PsScript
id: 91e69562-2426-42ce-a647-711b8152ced6
related:
- id: c86500e9-a645-4680-98d7-f882c70c1ea3
  type: similar
status: test
description: Detects ADDInternals Cmdlet execution. A tool for administering Azure
  AD and Office 365. Which can be abused by threat actors to attack Azure AD or Office
  365.
references:
- https://o365blog.com/aadinternals/
- https://github.com/Gerenios/AADInternals
author: Austin Songer (@austinsonger), Nasreddine Bencherchali (Nextron Systems)
date: 2022/12/23
tags:
- attack.execution
- attack.reconnaissance
- attack.discovery
- attack.credential_access
- attack.impact
logsource:
  product: windows
  category: ps_script
  definition: Script Block Logging must be enable
detection:
- and:
  - or:
    - ScriptBlockText|contains: Add-AADInt
    - ScriptBlockText|contains: ConvertTo-AADInt
    - ScriptBlockText|contains: Disable-AADInt
    - ScriptBlockText|contains: Enable-AADInt
    - ScriptBlockText|contains: Export-AADInt
    - ScriptBlockText|contains: Get-AADInt
    - ScriptBlockText|contains: Grant-AADInt
    - ScriptBlockText|contains: Install-AADInt
    - ScriptBlockText|contains: Invoke-AADInt
    - ScriptBlockText|contains: Join-AADInt
    - ScriptBlockText|contains: New-AADInt
    - ScriptBlockText|contains: Open-AADInt
    - ScriptBlockText|contains: Read-AADInt
    - ScriptBlockText|contains: Register-AADInt
    - ScriptBlockText|contains: Remove-AADInt
    - ScriptBlockText|contains: Restore-AADInt
    - ScriptBlockText|contains: Search-AADInt
    - ScriptBlockText|contains: Send-AADInt
    - ScriptBlockText|contains: Set-AADInt
    - ScriptBlockText|contains: Start-AADInt
    - ScriptBlockText|contains: Update-AADInt
falsepositives:
- Legitimate use of the library for administrative activity
level: high
