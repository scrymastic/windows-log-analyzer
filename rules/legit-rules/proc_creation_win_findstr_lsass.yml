title: LSASS Process Reconnaissance Via Findstr.EXE
id: fe63010f-8823-4864-a96b-a7b4a0f7b929
status: experimental
description: Detects findstring commands that include the keyword lsass, which indicates
  recon actviity for the LSASS process PID
references:
- https://blog.talosintelligence.com/2022/08/recent-cyber-attack.html?m=1
author: Florian Roth (Nextron Systems)
date: 2022/08/12
modified: 2023/11/11
tags:
- attack.credential_access
- attack.t1552.006
logsource:
  category: process_creation
  product: windows
detection:
- selection_findstr_img:
  - and:
    - or:
      - or:
        - Image|endswith: \find.exe
        - Image|endswith: \findstr.exe
      - or:
        - OriginalFileName|==: FIND.EXE
        - OriginalFileName|==: FINDSTR.EXE
- selection_findstr_cli:
  - and:
    - CommandLine|contains: lsass
- selection_special:
  - and:
    - or:
      - CommandLine|contains: ' /i "lsass'
      - CommandLine|contains: ' /i lsass.exe'
      - CommandLine|contains: findstr "lsass
      - CommandLine|contains: findstr lsass
      - CommandLine|contains: findstr.exe "lsass
      - CommandLine|contains: findstr.exe lsass
- condition: all of selection_findstr_* or selection_special
falsepositives:
- Unknown
level: high
