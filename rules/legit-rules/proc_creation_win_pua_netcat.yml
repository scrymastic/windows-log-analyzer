title: PUA - Netcat Suspicious Execution
id: e31033fc-33f0-4020-9a16-faf9b31cbf08
status: test
description: Detects execution of Netcat. Adversaries may use a non-application layer
  protocol for communication between host and C2 server or among infected hosts within
  a network
references:
- https://nmap.org/ncat/
- https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1095/T1095.md
- https://www.revshells.com/
author: frack113, Florian Roth (Nextron Systems)
date: 2021/07/21
modified: 2023/02/08
tags:
- attack.command_and_control
- attack.t1095
logsource:
  category: process_creation
  product: windows
detection:
- selection_img:
  - and:
    - or:
      - Image|endswith: \nc.exe
      - Image|endswith: \ncat.exe
      - Image|endswith: \netcat.exe
- selection_cmdline:
  - and:
    - or:
      - CommandLine|contains: ' -lvp '
      - CommandLine|contains: ' -lvnp'
      - CommandLine|contains: ' -l -v -p '
      - CommandLine|contains: ' -lv -p '
      - CommandLine|contains: ' -l --proxy-type http '
      - CommandLine|contains: ' -vnl --exec '
      - CommandLine|contains: ' -vnl -e '
      - CommandLine|contains: ' --lua-exec '
      - CommandLine|contains: ' --sh-exec '
- condition: 1 of selection_*
falsepositives:
- Legitimate ncat use
level: high
