title: Suspicious Reconnaissance Activity Using Get-LocalGroupMember Cmdlet
id: c8a180d6-47a3-4345-a609-53f9c3d834fc
related:
- id: cef24b90-dddc-4ae1-a09a-8764872f69fc
  type: similar
status: test
description: Detects suspicious reconnaissance command line activity on Windows systems
  using the PowerShell Get-LocalGroupMember Cmdlet
references:
- https://www.absolomb.com/2018-01-26-Windows-Privilege-Escalation-Guide/
author: Nasreddine Bencherchali (Nextron Systems)
date: 2022/10/10
tags:
- attack.discovery
- attack.t1087.001
logsource:
  category: process_creation
  product: windows
detection:
- selection_cmdlet:
  - and:
    - CommandLine|contains: 'Get-LocalGroupMember '
- selection_group:
  - and:
    - or:
      - CommandLine|contains: domain admins
      - CommandLine|contains: ' administrator'
      - CommandLine|contains: ' administrateur'
      - CommandLine|contains: enterprise admins
      - CommandLine|contains: Exchange Trusted Subsystem
      - CommandLine|contains: Remote Desktop Users
      - CommandLine|contains: "Utilisateurs du Bureau \xE0 distance"
      - CommandLine|contains: Usuarios de escritorio remoto
- condition: all of selection_*
fields:
- CommandLine
- ParentCommandLine
falsepositives:
- Administrative activity
level: medium
