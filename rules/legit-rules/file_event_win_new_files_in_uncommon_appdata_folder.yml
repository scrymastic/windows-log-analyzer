title: Suspicious File Creation In Uncommon AppData Folder
id: d7b50671-d1ad-4871-aa60-5aa5b331fe04
status: test
description: Detects the creation of suspicious files and folders inside the user's
  AppData folder but not inside any of the common and well known directories (Local,
  Romaing, LocalLow). This method could be used as a method to bypass detection who
  exclude the AppData folder in fear of FPs
references:
- Internal Research
author: Nasreddine Bencherchali (Nextron Systems)
date: 2022/08/05
modified: 2023/02/23
tags:
- attack.defense_evasion
- attack.execution
logsource:
  product: windows
  category: file_event
detection:
- selection:
  - and:
    - TargetFilename|startswith: C:\Users\
    - TargetFilename|contains: \AppData\
    - or:
      - TargetFilename|endswith: .bat
      - TargetFilename|endswith: .cmd
      - TargetFilename|endswith: .cpl
      - TargetFilename|endswith: .dll
      - TargetFilename|endswith: .exe
      - TargetFilename|endswith: .hta
      - TargetFilename|endswith: .iso
      - TargetFilename|endswith: .lnk
      - TargetFilename|endswith: .msi
      - TargetFilename|endswith: .ps1
      - TargetFilename|endswith: .psm1
      - TargetFilename|endswith: .scr
      - TargetFilename|endswith: .vbe
      - TargetFilename|endswith: .vbs
- filter_main:
  - and:
    - TargetFilename|startswith: C:\Users\
    - or:
      - TargetFilename|contains: \AppData\Local\
      - TargetFilename|contains: \AppData\LocalLow\
      - TargetFilename|contains: \AppData\Roaming\
- condition: selection and not filter_main
falsepositives:
- Unlikely
level: high
