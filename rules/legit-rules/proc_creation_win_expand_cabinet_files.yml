title: Potentially Suspicious Cabinet File Expansion
id: 9f107a84-532c-41af-b005-8d12a607639f
status: test
description: Detects the expansion or decompression of cabinet files from potentially
  suspicious or uncommon locations, e.g. seen in Iranian MeteorExpress related attacks
references:
- https://labs.sentinelone.com/meteorexpress-mysterious-wiper-paralyzes-iranian-trains-with-epic-troll
- https://blog.malwarebytes.com/threat-intelligence/2021/08/new-variant-of-konni-malware-used-in-campaign-targetting-russia/
author: Bhabesh Raj, X__Junior (Nextron Systems)
date: 2021/07/30
modified: 2024/03/05
tags:
- attack.defense_evasion
- attack.t1218
logsource:
  category: process_creation
  product: windows
detection:
- and:
  - Image|endswith: \expand.exe
  - CommandLine|None: '-F:'
  - or:
    - CommandLine|contains: :\Perflogs\
    - CommandLine|contains: :\Users\Public\
    - CommandLine|contains: \Temporary Internet
    - CommandLine|contains: :\ProgramData
    - CommandLine|contains: \AppData\Local\Temp
    - CommandLine|contains: \AppData\Roaming\Temp
    - CommandLine|contains: :\Windows\Temp
  - or:
    - CommandLine|contains: :\Users\
    - CommandLine|contains: \Favorites\
    - CommandLine|contains: :\Users\
    - CommandLine|contains: \Favourites\
    - CommandLine|contains: :\Users\
    - CommandLine|contains: \Contacts\
  - or:
    - ParentImage|!==: C:\Program Files (x86)\Dell\UpdateService\ServiceShell.exe
    - CommandLine|not contains: C:\ProgramData\Dell\UpdateService\Temp\
falsepositives:
- System administrator Usage
level: medium
