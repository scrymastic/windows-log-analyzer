title: Aruba Network Service Potential DLL Sideloading
id: 90ae0469-0cee-4509-b67f-e5efcef040f7
status: test
description: Detects potential DLL sideloading activity via the Aruba Networks Virtual
  Intranet Access "arubanetsvc.exe" process using DLL Search Order Hijacking
references:
- https://twitter.com/wdormann/status/1616581559892545537?t=XLCBO9BziGzD7Bmbt8oMEQ&s=09
author: Nasreddine Bencherchali (Nextron Systems)
date: 2023/01/22
modified: 2023/03/15
tags:
- attack.privilege_escalation
- attack.persistence
- attack.t1574.001
- attack.t1574.002
logsource:
  category: image_load
  product: windows
detection:
- selection:
  - and:
    - Image|endswith: \arubanetsvc.exe
    - or:
      - ImageLoaded|endswith: \wtsapi32.dll
      - ImageLoaded|endswith: \msvcr100.dll
      - ImageLoaded|endswith: \msvcp100.dll
      - ImageLoaded|endswith: \dbghelp.dll
      - ImageLoaded|endswith: \dbgcore.dll
      - ImageLoaded|endswith: \wininet.dll
      - ImageLoaded|endswith: \iphlpapi.dll
      - ImageLoaded|endswith: \version.dll
      - ImageLoaded|endswith: \cryptsp.dll
      - ImageLoaded|endswith: \cryptbase.dll
      - ImageLoaded|endswith: \wldp.dll
      - ImageLoaded|endswith: \profapi.dll
      - ImageLoaded|endswith: \sspicli.dll
      - ImageLoaded|endswith: \winsta.dll
      - ImageLoaded|endswith: \dpapi.dll
- filter:
  - and:
    - or:
      - ImageLoaded|startswith: C:\Windows\System32\
      - ImageLoaded|startswith: C:\Windows\SysWOW64\
      - ImageLoaded|startswith: C:\Windows\WinSxS\
- condition: selection and not filter
falsepositives:
- Unknown
level: high
