title: Potential Goopdate.DLL Sideloading
id: b6188d2f-b3c4-4d2c-a17d-9706e0851af0
status: test
description: Detects potential DLL sideloading of "goopdate.dll", a DLL used by googleupdate.exe
references:
- https://www.ncsc.gov.uk/static-assets/documents/malware-analysis-reports/goofy-guineapig/NCSC-MAR-Goofy-Guineapig.pdf
author: X__Junior (Nextron Systems), Nasreddine Bencherchali (Nextron Systems)
date: 2023/05/15
modified: 2023/05/20
tags:
- attack.defense_evasion
- attack.privilege_escalation
- attack.t1574.001
- attack.t1574.002
logsource:
  category: image_load
  product: windows
detection:
- selection:
  - and:
    - ImageLoaded|endswith: \goopdate.dll
- filter_main_generic:
  - and:
    - or:
      - ImageLoaded|startswith: C:\Program Files (x86)\
      - ImageLoaded|startswith: C:\Program Files\
- filter_optional_dropbox_installer_temp:
  - and:
    - Image|contains: \AppData\Local\Temp\GUM
    - Image|contains: .tmp\Dropbox
    - ImageLoaded|contains: \AppData\Local\Temp\GUM
    - ImageLoaded|contains: .tmp\\goopdate.dll
- condition: selection and not 1 of filter_main_* and not 1 of filter_optional_*
falsepositives:
- False positives are expected from Google Chrome installations running from user
  locations (AppData) and other custom locations. Apply additional filters accordingly.
- Other third party chromium browsers located in AppData
level: medium
