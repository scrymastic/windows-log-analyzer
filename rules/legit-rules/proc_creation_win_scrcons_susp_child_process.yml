title: Script Event Consumer Spawning Process
id: f6d1dd2f-b8ce-40ca-bc23-062efb686b34
status: test
description: Detects a suspicious child process of Script Event Consumer (scrcons.exe).
references:
- https://redcanary.com/blog/child-processes/
- https://docs.paloaltonetworks.com/cortex/cortex-xdr/cortex-xdr-analytics-alert-reference/cortex-xdr-analytics-alert-reference/scrcons-exe-rare-child-process.html
author: Sittikorn S
date: 2021/06/21
modified: 2022/07/14
tags:
- attack.execution
- attack.t1047
logsource:
  category: process_creation
  product: windows
detection:
- and:
  - ParentImage|endswith: \scrcons.exe
  - or:
    - Image|endswith: \svchost.exe
    - Image|endswith: \dllhost.exe
    - Image|endswith: \powershell.exe
    - Image|endswith: \pwsh.exe
    - Image|endswith: \wscript.exe
    - Image|endswith: \cscript.exe
    - Image|endswith: \schtasks.exe
    - Image|endswith: \regsvr32.exe
    - Image|endswith: \mshta.exe
    - Image|endswith: \rundll32.exe
    - Image|endswith: \msiexec.exe
    - Image|endswith: \msbuild.exe
fields:
- CommandLine
- ParentCommandLine
falsepositives:
- Unknown
level: high
