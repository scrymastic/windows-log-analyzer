title: Suspicious Ping/Del Command Combination
id: 54786ddc-5b8a-11ed-9b6a-0242ac120002
status: test
description: Detects a method often used by ransomware. Which combines the "ping"
  to wait a couple of seconds and then "del" to delete the file in question. Its used
  to hide the file responsible for the initial infection for example
references:
- https://blog.sygnia.co/kaseya-ransomware-supply-chain-attack
- https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2022/06/23093553/Common-TTPs-of-the-modern-ransomware_low-res.pdf
- https://www.acronis.com/en-us/blog/posts/lockbit-ransomware/
- https://symantec-enterprise-blogs.security.com/blogs/threat-intelligence/blackbyte-exbyte-ransomware
author: Ilya Krestinichev
date: 2022/11/03
modified: 2024/03/05
tags:
- attack.defense_evasion
- attack.t1070.004
logsource:
  category: process_creation
  product: windows
detection:
- and:
  - CommandLine|None: ' -n '
  - CommandLine|contains: Nul
  - or:
    - CommandLine|None: ' -f '
    - CommandLine|None: ' -q '
  - CommandLine|contains: ping
  - CommandLine|contains: 'del '
falsepositives:
- Unknown
level: high
