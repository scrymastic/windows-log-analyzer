title: BITS Transfer Job Downloading File Potential Suspicious Extension
id: b85e5894-9b19-4d86-8c87-a2f3b81f0521
status: test
description: Detects new BITS transfer job saving local files with potential suspicious
  extensions
references:
- https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1197/T1197.md
author: frack113
date: 2022/03/01
modified: 2023/03/27
tags:
- attack.defense_evasion
- attack.persistence
- attack.t1197
logsource:
  product: windows
  service: bits-client
detection:
- and:
  - EventID|==: 16403
  - or:
    - LocalName|endswith: .bat
    - LocalName|endswith: .dll
    - LocalName|endswith: .exe
    - LocalName|endswith: .hta
    - LocalName|endswith: .ps1
    - LocalName|endswith: .psd1
    - LocalName|endswith: .sh
    - LocalName|endswith: .vbe
    - LocalName|endswith: .vbs
  - or:
    - LocalName|not contains: \AppData\
    - RemoteName|not contains: .com
falsepositives:
- While the file extensions in question can be suspicious at times. It's best to add
  filters according to your environment to avoid large amount false positives
level: medium
