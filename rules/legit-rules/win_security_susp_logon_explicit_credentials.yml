title: Suspicious Remote Logon with Explicit Credentials
id: 941e5c45-cda7-4864-8cea-bbb7458d194a
status: test
description: Detects suspicious processes logging on with explicit credentials
references:
- https://drive.google.com/file/d/1lKya3_mLnR3UQuCoiYruO3qgu052_iS_/view
author: oscd.community, Teymur Kheirkhabarov @HeirhabarovT, Zach Stanford @svch0st,
  Tim Shelton
date: 2020/10/05
modified: 2022/08/03
tags:
- attack.t1078
- attack.lateral_movement
logsource:
  product: windows
  service: security
detection:
- selection:
  - and:
    - EventID|==: 4648
    - or:
      - ProcessName|endswith: \cmd.exe
      - ProcessName|endswith: \powershell.exe
      - ProcessName|endswith: \pwsh.exe
      - ProcessName|endswith: \winrs.exe
      - ProcessName|endswith: \wmic.exe
      - ProcessName|endswith: \net.exe
      - ProcessName|endswith: \net1.exe
      - ProcessName|endswith: \reg.exe
- filter1:
  - and:
    - TargetServerName|==: localhost
- filter2:
  - and:
    - SubjectUserName|endswith: $
    - TargetUserName|endswith: $
- condition: selection and not 1 of filter*
falsepositives:
- Administrators that use the RunAS command or scheduled tasks
level: medium
