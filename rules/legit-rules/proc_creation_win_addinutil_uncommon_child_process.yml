title: Uncommon Child Process Of AddinUtil.EXE
id: b5746143-59d6-4603-8d06-acbd60e166ee
status: experimental
description: 'Detects uncommon child processes of the Add-In deployment cache updating
  utility (AddInutil.exe) which could be a sign of potential abuse of the binary to
  proxy execution via a custom Addins.Store payload.

  '
references:
- https://www.blue-prints.blog/content/blog/posts/lolbin/addinutil-lolbas.html
author: Michael McKinley (@McKinleyMike), Tony Latteri (@TheLatteri)
date: 2023/09/18
tags:
- attack.defense_evasion
- attack.t1218
logsource:
  category: process_creation
  product: windows
detection:
- and:
  - ParentImage|endswith: \addinutil.exe
  - Image|not endswith: :\Windows\System32\conhost.exe
  - Image|not endswith: :\Windows\System32\werfault.exe
  - Image|not endswith: :\Windows\SysWOW64\werfault.exe
falsepositives:
- Unknown
level: medium
