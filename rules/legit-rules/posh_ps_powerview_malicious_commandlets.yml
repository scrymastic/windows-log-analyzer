title: PowerView PowerShell Cmdlets - ScriptBlock
id: dcd74b95-3f36-4ed9-9598-0490951643aa
related:
- id: b2317cfa-4a47-4ead-b3ff-297438c0bc2d
  type: similar
status: test
description: Detects Cmdlet names from PowerView of the PowerSploit exploitation framework.
references:
- https://powersploit.readthedocs.io/en/stable/Recon/README
- https://github.com/PowerShellMafia/PowerSploit/tree/master/Recon
- https://thedfirreport.com/2020/10/08/ryuks-return
- https://adsecurity.org/?p=2277
author: Bhabesh Raj
date: 2021/05/18
modified: 2023/11/22
tags:
- attack.execution
- attack.t1059.001
logsource:
  product: windows
  category: ps_script
  definition: 'Requirements: Script Block Logging must be enabled'
detection:
- selection:
  - and:
    - or:
      - ScriptBlockText|contains: Export-PowerViewCSV
      - ScriptBlockText|contains: Find-DomainLocalGroupMember
      - ScriptBlockText|contains: Find-DomainObjectPropertyOutlier
      - ScriptBlockText|contains: Find-DomainProcess
      - ScriptBlockText|contains: Find-DomainShare
      - ScriptBlockText|contains: Find-DomainUserEvent
      - ScriptBlockText|contains: Find-DomainUserLocation
      - ScriptBlockText|contains: Find-ForeignGroup
      - ScriptBlockText|contains: Find-ForeignUser
      - ScriptBlockText|contains: Find-GPOComputerAdmin
      - ScriptBlockText|contains: Find-GPOLocation
      - ScriptBlockText|contains: Find-InterestingDomain
      - ScriptBlockText|contains: Find-InterestingFile
      - ScriptBlockText|contains: Find-LocalAdminAccess
      - ScriptBlockText|contains: Find-ManagedSecurityGroups
      - ScriptBlockText|contains: Get-CachedRDPConnection
      - ScriptBlockText|contains: Get-DFSshare
      - ScriptBlockText|contains: Get-DomainDFSShare
      - ScriptBlockText|contains: Get-DomainDNSRecord
      - ScriptBlockText|contains: Get-DomainDNSZone
      - ScriptBlockText|contains: Get-DomainFileServer
      - ScriptBlockText|contains: Get-DomainGPOComputerLocalGroupMapping
      - ScriptBlockText|contains: Get-DomainGPOLocalGroup
      - ScriptBlockText|contains: Get-DomainGPOUserLocalGroupMapping
      - ScriptBlockText|contains: Get-LastLoggedOn
      - ScriptBlockText|contains: Get-LoggedOnLocal
      - ScriptBlockText|contains: Get-NetFileServer
      - ScriptBlockText|contains: Get-NetForest
      - ScriptBlockText|contains: Get-NetGPOGroup
      - ScriptBlockText|contains: Get-NetProcess
      - ScriptBlockText|contains: Get-NetRDPSession
      - ScriptBlockText|contains: Get-RegistryMountedDrive
      - ScriptBlockText|contains: Get-RegLoggedOn
      - ScriptBlockText|contains: Get-WMIRegCachedRDPConnection
      - ScriptBlockText|contains: Get-WMIRegLastLoggedOn
      - ScriptBlockText|contains: Get-WMIRegMountedDrive
      - ScriptBlockText|contains: Get-WMIRegProxy
      - ScriptBlockText|contains: Invoke-ACLScanner
      - ScriptBlockText|contains: Invoke-CheckLocalAdminAccess
      - ScriptBlockText|contains: Invoke-EnumerateLocalAdmin
      - ScriptBlockText|contains: Invoke-EventHunter
      - ScriptBlockText|contains: Invoke-FileFinder
      - ScriptBlockText|contains: Invoke-Kerberoast
      - ScriptBlockText|contains: Invoke-MapDomainTrust
      - ScriptBlockText|contains: Invoke-ProcessHunter
      - ScriptBlockText|contains: Invoke-RevertToSelf
      - ScriptBlockText|contains: Invoke-ShareFinder
      - ScriptBlockText|contains: Invoke-UserHunter
      - ScriptBlockText|contains: Invoke-UserImpersonation
      - ScriptBlockText|contains: Remove-RemoteConnection
      - ScriptBlockText|contains: Request-SPNTicket
      - ScriptBlockText|contains: Resolve-IPAddress
- condition: selection
falsepositives:
- Unknown
level: high
