title: Suspicious Process Created Via Wmic.EXE
id: 3c89a1e8-0fba-449e-8f1b-8409d6267ec8
related:
- id: 526be59f-a573-4eea-b5f7-f0973207634d
  type: derived
status: test
description: Detects WMIC executing "process call create" with suspicious calls to
  processes such as "rundll32", "regsrv32", etc.
references:
- https://thedfirreport.com/2020/10/08/ryuks-return/
- https://symantec-enterprise-blogs.security.com/blogs/threat-intelligence/ransomware-hive-conti-avoslocker
author: Florian Roth (Nextron Systems), Nasreddine Bencherchali (Nextron Systems)
date: 2020/10/12
modified: 2023/02/14
tags:
- attack.execution
- attack.t1047
logsource:
  category: process_creation
  product: windows
detection:
- selection:
  - and:
    - CommandLine|contains: 'process '
    - CommandLine|contains: 'call '
    - CommandLine|contains: 'create '
    - or:
      - CommandLine|contains: rundll32
      - CommandLine|contains: bitsadmin
      - CommandLine|contains: regsvr32
      - CommandLine|contains: 'cmd.exe /c '
      - CommandLine|contains: 'cmd.exe /k '
      - CommandLine|contains: 'cmd.exe /r '
      - CommandLine|contains: 'cmd /c '
      - CommandLine|contains: 'cmd /k '
      - CommandLine|contains: 'cmd /r '
      - CommandLine|contains: powershell
      - CommandLine|contains: pwsh
      - CommandLine|contains: certutil
      - CommandLine|contains: cscript
      - CommandLine|contains: wscript
      - CommandLine|contains: mshta
      - CommandLine|contains: \Users\Public\
      - CommandLine|contains: \Windows\Temp\
      - CommandLine|contains: \AppData\Local\
      - CommandLine|contains: '%temp%'
      - CommandLine|contains: '%tmp%'
      - CommandLine|contains: '%ProgramData%'
      - CommandLine|contains: '%appdata%'
      - CommandLine|contains: '%comspec%'
      - CommandLine|contains: '%localappdata%'
- condition: selection
falsepositives:
- Unknown
level: high
