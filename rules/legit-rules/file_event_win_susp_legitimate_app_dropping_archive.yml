title: Legitimate Application Dropped Archive
id: 654fcc6d-840d-4844-9b07-2c3300e54a26
status: test
description: Detects programs on a Windows system that should not write an archive
  to disk
references:
- https://github.com/Neo23x0/sysmon-config/blob/3f808d9c022c507aae21a9346afba4a59dd533b9/sysmonconfig-export-block.xml#L1326
author: frack113, Florian Roth
date: 2022/08/21
tags:
- attack.defense_evasion
- attack.t1218
logsource:
  product: windows
  category: file_event
detection:
- selection:
  - and:
    - or:
      - Image|endswith: \winword.exe
      - Image|endswith: \excel.exe
      - Image|endswith: \powerpnt.exe
      - Image|endswith: \msaccess.exe
      - Image|endswith: \mspub.exe
      - Image|endswith: \eqnedt32.exe
      - Image|endswith: \visio.exe
      - Image|endswith: \wordpad.exe
      - Image|endswith: \wordview.exe
      - Image|endswith: \certutil.exe
      - Image|endswith: \certoc.exe
      - Image|endswith: \CertReq.exe
      - Image|endswith: \Desktopimgdownldr.exe
      - Image|endswith: \esentutl.exe
      - Image|endswith: \finger.exe
      - Image|endswith: \notepad.exe
      - Image|endswith: \AcroRd32.exe
      - Image|endswith: \RdrCEF.exe
      - Image|endswith: \mshta.exe
      - Image|endswith: \hh.exe
    - or:
      - TargetFilename|endswith: .zip
      - TargetFilename|endswith: .rar
      - TargetFilename|endswith: .7z
      - TargetFilename|endswith: .diagcab
      - TargetFilename|endswith: .appx
- condition: selection
falsepositives:
- Unknown
level: high
