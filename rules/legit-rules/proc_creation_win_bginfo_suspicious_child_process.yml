title: Suspicious Child Process Of BgInfo.EXE
id: 811f459f-9231-45d4-959a-0266c6311987
related:
- id: aaf46cdc-934e-4284-b329-34aa701e3771
  type: similar
status: experimental
description: Detects suspicious child processes of "BgInfo.exe" which could be a sign
  of potential abuse of the binary to proxy execution via external VBScript
references:
- https://lolbas-project.github.io/lolbas/OtherMSBinaries/Bginfo/
- https://oddvar.moe/2017/05/18/bypassing-application-whitelisting-with-bginfo/
author: Nasreddine Bencherchali (Nextron Systems)
date: 2023/08/16
tags:
- attack.execution
- attack.t1059.005
- attack.defense_evasion
- attack.t1218
- attack.t1202
logsource:
  category: process_creation
  product: windows
detection:
- selection_parent:
  - and:
    - or:
      - ParentImage|endswith: \bginfo.exe
      - ParentImage|endswith: \bginfo64.exe
- selection_child:
  - and:
    - or:
      - or:
        - Image|endswith: \calc.exe
        - Image|endswith: \cmd.exe
        - Image|endswith: \cscript.exe
        - Image|endswith: \mshta.exe
        - Image|endswith: \notepad.exe
        - Image|endswith: \powershell.exe
        - Image|endswith: \pwsh.exe
        - Image|endswith: \wscript.exe
      - or:
        - Image|contains: \AppData\Local\
        - Image|contains: \AppData\Roaming\
        - Image|contains: :\Users\Public\
        - Image|contains: :\Temp\
        - Image|contains: :\Windows\Temp\
        - Image|contains: :\PerfLogs\
- condition: all of selection_*
falsepositives:
- Unknown
level: high
