title: Potential Webshell Creation On Static Website
id: 39f1f9f2-9636-45de-98f6-a4046aa8e4b9
status: test
description: Detects the creation of files with certain extensions on a static web
  site. This can be indicative of potential uploads of a web shell.
references:
- PT ESC rule and personal experience
- https://github.com/swisskyrepo/PayloadsAllTheThings/blob/c95a0a1a2855dc0cd7f7327614545fe30482a636/Upload%20Insecure%20Files/README.md
author: Beyu Denis, oscd.community, Tim Shelton, Thurein Oo
date: 2019/10/22
modified: 2023/10/15
tags:
- attack.persistence
- attack.t1505.003
logsource:
  product: windows
  category: file_event
detection:
- selection_wwwroot_path:
  - and:
    - TargetFilename|contains: \inetpub\wwwroot\
- selection_wwwroot_ext:
  - and:
    - or:
      - TargetFilename|contains: .ashx
      - TargetFilename|contains: .asp
      - TargetFilename|contains: .ph
      - TargetFilename|contains: .soap
- selection_htdocs_path:
  - and:
    - or:
      - TargetFilename|contains: \www\
      - TargetFilename|contains: \htdocs\
      - TargetFilename|contains: \html\
- selection_htdocs_ext:
  - and:
    - TargetFilename|contains: .ph
- filter_main_temp:
  - and:
    - or:
      - TargetFilename|contains: \AppData\Local\Temp\
      - TargetFilename|contains: \Windows\Temp\
- filter_main_system:
  - and:
    - Image|==: System
- filter_main_legitimate:
  - and:
    - TargetFilename|contains: \xampp
- condition: (all of selection_wwwroot_* or all of selection_htdocs_*) and not 1 of
    filter_main_*
falsepositives:
- Legitimate administrator or developer creating legitimate executable files in a
  web application folder
level: medium
