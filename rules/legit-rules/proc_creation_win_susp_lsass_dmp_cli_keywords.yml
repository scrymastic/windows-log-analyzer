title: LSASS Dump Keyword In CommandLine
id: ffa6861c-4461-4f59-8a41-578c39f3f23e
related:
- id: a5a2d357-1ab8-4675-a967-ef9990a59391
  type: derived
status: test
description: 'Detects the presence of the keywords "lsass" and ".dmp" in the commandline,
  which could indicate a potential attempt to dump or create a dump of the lsass process.

  '
references:
- https://github.com/Hackndo/lsassy
- https://medium.com/@markmotig/some-ways-to-dump-lsass-exe-c4a75fdc49bf
- https://github.com/elastic/detection-rules/blob/c76a39796972ecde44cb1da6df47f1b6562c9770/rules/windows/credential_access_lsass_memdump_file_created.toml
- https://www.whiteoaksecurity.com/blog/attacks-defenses-dumping-lsass-no-mimikatz/
- https://github.com/helpsystems/nanodump
- https://github.com/CCob/MirrorDump
author: E.M. Anhaus, Tony Lambert, oscd.community, Nasreddine Bencherchali (Nextron
  Systems)
date: 2019/10/24
modified: 2023/08/29
tags:
- attack.credential_access
- attack.t1003.001
logsource:
  category: process_creation
  product: windows
detection:
- selection:
  - and:
    - or:
      - or:
        - CommandLine|contains: lsass.dmp
        - CommandLine|contains: lsass.zip
        - CommandLine|contains: lsass.rar
        - CommandLine|contains: Andrew.dmp
        - CommandLine|contains: Coredump.dmp
        - CommandLine|contains: NotLSASS.zip
        - CommandLine|contains: lsass_2
        - CommandLine|contains: lsassdump
        - CommandLine|contains: lsassdmp
      - and:
        - CommandLine|contains: lsass
        - CommandLine|contains: .dmp
      - and:
        - CommandLine|contains: SQLDmpr
        - CommandLine|contains: .mdmp
      - and:
        - CommandLine|contains: nanodump
        - CommandLine|contains: .dmp
- condition: selection
falsepositives:
- Unlikely
level: high
