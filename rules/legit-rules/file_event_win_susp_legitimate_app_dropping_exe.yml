title: Legitimate Application Dropped Executable
id: f0540f7e-2db3-4432-b9e0-3965486744bc
status: experimental
description: Detects programs on a Windows system that should not write executables
  to disk
references:
- https://github.com/Neo23x0/sysmon-config/blob/3f808d9c022c507aae21a9346afba4a59dd533b9/sysmonconfig-export-block.xml#L1326
author: frack113, Florian Roth (Nextron Systems)
date: 2022/08/21
modified: 2023/06/22
tags:
- attack.defense_evasion
- attack.t1218
logsource:
  product: windows
  category: file_event
detection:
- selection:
  - and:
    - or:
      - Image|endswith: \eqnedt32.exe
      - Image|endswith: \wordpad.exe
      - Image|endswith: \wordview.exe
      - Image|endswith: \certutil.exe
      - Image|endswith: \certoc.exe
      - Image|endswith: \CertReq.exe
      - Image|endswith: \Desktopimgdownldr.exe
      - Image|endswith: \esentutl.exe
      - Image|endswith: \mshta.exe
      - Image|endswith: \AcroRd32.exe
      - Image|endswith: \RdrCEF.exe
      - Image|endswith: \hh.exe
      - Image|endswith: \finger.exe
    - or:
      - TargetFilename|endswith: .exe
      - TargetFilename|endswith: .dll
      - TargetFilename|endswith: .ocx
- condition: selection
falsepositives:
- Unknown
level: high
